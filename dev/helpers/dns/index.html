
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="OSINT automation for hackers" name="description"/>
<meta content="TheTechromancer" name="author"/>
<link href="https://blacklanternsecurity.github.io/bbot/dev/helpers/dns/" rel="canonical"/>
<link href="../command/" rel="prev"/>
<link href="../interactsh/" rel="next"/>
<link href="../../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.5.3, mkdocs-material-9.3.2" name="generator"/>
<title>DNS - BBOT Docs</title>
<link href="../../../assets/stylesheets/main.30068a00.min.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/palette.85d0ee34.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../../../assets/_mkdocstrings.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<link href="../../../assets/stylesheets/extra-style.l__wbna5.min.css" rel="stylesheet"/></head>
<body data-md-color-accent="deep-orange" data-md-color-primary="black" data-md-color-scheme="slate" dir="ltr">
<script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#dns">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="BBOT Docs" class="md-header__button md-logo" data-md-component="logo" href="../../.." title="BBOT Docs">
<img alt="logo" src="../../../bbot.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            BBOT Docs
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              DNS
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-hidden="true" class="md-option" data-md-color-accent="deep-orange" data-md-color-media="" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/>
</form>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/blacklanternsecurity/bbot" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    blacklanternsecurity/bbot
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--integrated" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="BBOT Docs" class="md-nav__button md-logo" data-md-component="logo" href="../../.." title="BBOT Docs">
<img alt="logo" src="../../../bbot.png"/>
</a>
    BBOT Docs
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/blacklanternsecurity/bbot" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    blacklanternsecurity/bbot
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
<span class="md-ellipsis">
    Basics
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_1">
<span class="md-nav__icon md-icon"></span>
            Basics
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../..">
<span class="md-ellipsis">
    Getting Started
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../how_it_works/">
<span class="md-ellipsis">
    How it Works
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../comparison/">
<span class="md-ellipsis">
    Comparison to Other Tools
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
<span class="md-ellipsis">
    Scanning
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            Scanning
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../scanning/">
<span class="md-ellipsis">
    Scanning Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../scanning/events/">
<span class="md-ellipsis">
    Events
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../scanning/output/">
<span class="md-ellipsis">
    Output
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../scanning/tips_and_tricks/">
<span class="md-ellipsis">
    Tips and Tricks
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../scanning/advanced/">
<span class="md-ellipsis">
    Advanced Usage
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../scanning/configuration/">
<span class="md-ellipsis">
    Configuration
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
<span class="md-ellipsis">
    Modules
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            Modules
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../modules/list_of_modules/">
<span class="md-ellipsis">
    List of Modules
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../modules/nuclei/">
<span class="md-ellipsis">
    Nuclei
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
<span class="md-ellipsis">
    Contribution
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            Contribution
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../contribution/">
<span class="md-ellipsis">
    How to Write a Module
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_4_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
<span class="md-ellipsis">
    Developer Reference
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_4_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_2">
<span class="md-nav__icon md-icon"></span>
            Developer Reference
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../scanner/">
<span class="md-ellipsis">
    Scanner
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../event/">
<span class="md-ellipsis">
    Event
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../target/">
<span class="md-ellipsis">
    Target
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../basemodule/">
<span class="md-ellipsis">
    BaseModule
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_4_2_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_2_6" id="__nav_4_2_6_label" tabindex="0">
<span class="md-ellipsis">
    Helpers
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_4_2_6_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_4_2_6">
<span class="md-nav__icon md-icon"></span>
            Helpers
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../command/">
<span class="md-ellipsis">
    Command
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    DNS
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../interactsh/">
<span class="md-ellipsis">
    Interactsh
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../misc/">
<span class="md-ellipsis">
    Miscellaneous
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../web/">
<span class="md-ellipsis">
    Web
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../wordcloud/">
<span class="md-ellipsis">
    Word Cloud
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
<span class="md-ellipsis">
    Misc
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            Misc
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../release_history/">
<span class="md-ellipsis">
    Release History
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../troubleshooting/">
<span class="md-ellipsis">
    Troubleshooting
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="dns">DNS</h1>
<p>These are helpers related to DNS resolution. They are used throughout BBOT and its modules for performing DNS lookups and detecting DNS wildcards, etc.</p>
<p>Note that these helpers can be invoked directly from <code>self.helpers</code>, e.g.:</p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolve(</span><span style="color: #a5d6ff">"evilcorp.com"</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<div class="doc doc-object doc-class">
<h1 class="doc doc-heading" id="bbot.core.helpers.dns.DNSHelper">
<span class="doc doc-object-name doc-class-name">DNSHelper</span>
</h1>
<div class="doc doc-contents first">
<p>Helper class for DNS-related operations within BBOT.</p>
<p>This class provides mechanisms for host resolution, wildcard domain detection, event tagging, and more.
It centralizes all DNS-related activities in BBOT, offering both synchronous and asynchronous methods
for DNS resolution, as well as various utilities for batch resolution and DNS query filtering.</p>
<p>Attributes:</p>
<ul>
<li class="field-body">
<b><code>parent_helper</code></b>
        –
        <div class="doc-md-description">
<p>A reference to the instantiated <code>ConfigAwareHelper</code> (typically <code>scan.helpers</code>).</p>
</div>
</li>
<li class="field-body">
<b><code>resolver</code></b>
            (<code><span title="bbot.core.helpers.dns.BBOTAsyncResolver">BBOTAsyncResolver</span></code>)
        –
        <div class="doc-md-description">
<p>An asynchronous DNS resolver tailored for BBOT with rate-limiting capabilities.</p>
</div>
</li>
<li class="field-body">
<b><code>timeout</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a></code>)
        –
        <div class="doc-md-description">
<p>The timeout value for DNS queries. Defaults to 5 seconds.</p>
</div>
</li>
<li class="field-body">
<b><code>retries</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a></code>)
        –
        <div class="doc-md-description">
<p>The number of retries for failed DNS queries. Defaults to 1.</p>
</div>
</li>
<li class="field-body">
<b><code>abort_threshold</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a></code>)
        –
        <div class="doc-md-description">
<p>The threshold for aborting after consecutive failed queries. Defaults to 50.</p>
</div>
</li>
<li class="field-body">
<b><code>max_dns_resolve_distance</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a></code>)
        –
        <div class="doc-md-description">
<p>Maximum allowed distance for DNS resolution. Defaults to 4.</p>
</div>
</li>
<li class="field-body">
<b><code>all_rdtypes</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#list">list</a></code>)
        –
        <div class="doc-md-description">
<p>A list of DNS record types to be considered during operations.</p>
</div>
</li>
<li class="field-body">
<b><code>wildcard_ignore</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#tuple">tuple</a></code>)
        –
        <div class="doc-md-description">
<p>Domains to be ignored during wildcard detection.</p>
</div>
</li>
<li class="field-body">
<b><code>wildcard_tests</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a></code>)
        –
        <div class="doc-md-description">
<p>Number of tests to be run for wildcard detection. Defaults to 5.</p>
</div>
</li>
<li class="field-body">
<b><code>_wildcard_cache</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#dict">dict</a></code>)
        –
        <div class="doc-md-description">
<p>Cache for wildcard detection results.</p>
</div>
</li>
<li class="field-body">
<b><code>_dns_cache</code></b>
            (<code>CacheDict</code>)
        –
        <div class="doc-md-description">
<p>Cache for DNS resolution results, limited in size.</p>
</div>
</li>
<li class="field-body">
<b><code>_event_cache</code></b>
            (<code>CacheDict</code>)
        –
        <div class="doc-md-description">
<p>Cache for event resolution results, tags. Limited in size.</p>
</div>
</li>
<li class="field-body">
<b><code>resolver_file</code></b>
            (<code><span title="bbot.core.helpers.misc.Path">Path</span></code>)
        –
        <div class="doc-md-description">
<p>File containing system's current resolver nameservers.</p>
</div>
</li>
<li class="field-body">
<b><code>filter_bad_ptrs</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#bool">bool</a></code>)
        –
        <div class="doc-md-description">
<p>Whether to filter out DNS names that appear to be auto-generated PTR records. Defaults to True.</p>
</div>
</li>
</ul>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>parent_helper</code></b>
        –
        <div class="doc-md-description">
<p>The parent helper object with configuration details and utilities.</p>
</div>
</li>
</ul>
<p>Raises:</p>
<ul>
<li class="field-body">
<code><span title="bbot.core.errors.DNSError">DNSError</span></code>
          –
        <div class="doc-md-description">
<p>If an issue arises when creating the BBOTAsyncResolver instance.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">dns_helper</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">DNSHelper(parent_config)</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">resolved_host</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">dns_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolver</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolve(</span><span style="color: #a5d6ff">"example.com"</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/dns.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  48</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  49</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  50</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  51</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  52</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  53</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  54</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  55</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  56</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  57</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  58</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  59</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  60</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  61</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  62</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  63</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  64</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  65</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  66</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  67</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  68</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  69</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  70</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  71</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  72</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  73</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  74</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  75</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  76</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  77</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  78</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  79</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  80</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  81</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  82</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  83</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  84</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  85</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  86</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  87</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  88</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  89</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  90</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  91</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  92</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  93</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  94</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  95</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  96</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  97</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  98</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  99</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 100</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 101</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 102</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 103</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 104</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 105</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 106</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 107</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 108</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 109</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 110</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 111</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 112</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 113</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 114</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 115</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 116</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 117</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 118</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 119</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 120</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 121</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 122</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 123</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 124</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 125</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 126</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 127</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 128</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 129</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 130</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 131</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 132</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 133</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 134</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 135</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 136</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 137</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 138</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 139</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 140</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 141</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 142</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 143</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 144</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 145</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 146</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 147</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 148</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 149</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 150</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 151</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 152</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 153</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 154</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 155</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 156</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 157</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 158</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 159</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 160</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 161</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 162</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 163</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 164</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 165</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 166</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 167</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 168</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 169</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 170</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 171</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 172</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 173</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 174</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 175</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 176</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 177</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 178</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 179</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 180</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 181</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 182</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 183</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 184</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 185</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 186</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 187</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 188</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 189</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 190</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 191</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 192</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 193</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 194</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 195</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 196</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 197</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 198</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 199</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 200</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 201</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 202</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 203</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 204</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 205</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 206</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 207</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 208</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 209</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 210</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 211</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 212</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 213</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 214</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 215</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 216</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 217</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 218</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 219</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 220</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 221</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 222</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 223</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 224</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 225</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 226</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 227</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 228</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 229</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 230</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 231</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 232</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 233</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 234</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 235</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 236</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 237</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 238</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 239</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 240</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 241</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 242</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 243</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 244</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 245</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 246</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 247</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 248</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 249</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 250</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 251</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 252</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 253</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 254</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 255</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 256</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 257</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 258</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 259</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 260</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 261</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 262</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 263</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 264</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 265</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 266</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 267</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 268</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 269</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 270</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 271</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 272</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 273</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 274</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 275</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 276</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 277</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 278</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 279</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 280</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 281</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 282</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 283</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 284</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 285</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 286</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 287</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 288</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 289</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 290</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 291</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 292</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 293</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 294</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 295</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 296</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 297</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 298</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 299</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 300</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 301</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 302</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 303</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 304</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 305</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 306</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 307</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 308</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 309</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 310</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 311</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 312</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 313</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 314</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 315</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 316</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 317</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 318</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 319</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 320</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 321</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 322</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 323</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 324</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 325</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 326</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 327</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 328</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 329</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 330</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 331</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 332</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 333</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 334</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 335</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 336</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 337</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 338</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 339</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 340</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 341</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 342</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 343</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 344</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 345</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 346</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 347</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 348</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 349</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 350</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 351</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 352</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 353</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 354</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 355</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 356</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 357</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 358</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 359</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 360</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 361</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 362</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 363</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 364</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 365</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 366</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 367</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 368</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 369</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 370</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 371</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 372</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 373</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 374</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 375</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 376</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 377</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 378</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 379</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 380</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 381</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 382</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 383</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 384</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 385</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 386</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 387</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 388</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 389</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 390</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 391</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 392</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 393</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 394</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 395</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 396</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 397</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 398</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 399</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 400</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 401</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 402</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 403</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 404</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 405</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 406</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 407</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 408</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 409</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 410</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 411</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 412</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 413</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 414</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 415</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 416</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 417</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 418</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 419</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 420</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 421</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 422</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 423</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 424</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 425</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 426</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 427</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 428</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 429</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 430</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 431</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 432</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 433</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 434</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 435</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 436</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 437</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 438</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 439</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 440</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 441</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 442</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 443</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 444</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 445</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 446</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 447</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 448</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 449</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 450</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 451</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 452</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 453</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 454</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 455</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 456</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 457</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 458</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 459</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 460</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 461</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 462</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 463</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 464</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 465</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 466</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 467</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 468</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 469</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 470</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 471</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 472</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 473</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 474</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 475</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 476</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 477</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 478</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 479</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 480</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 481</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 482</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 483</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 484</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 485</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 486</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 487</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 488</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 489</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 490</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 491</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 492</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 493</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 494</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 495</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 496</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 497</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 498</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 499</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 500</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 501</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 502</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 503</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 504</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 505</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 506</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 507</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 508</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 509</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 510</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 511</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 512</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 513</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 514</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 515</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 516</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 517</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 518</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 519</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 520</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 521</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 522</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 523</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 524</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 525</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 526</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 527</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 528</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 529</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 530</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 531</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 532</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 533</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 534</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 535</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 536</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 537</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 538</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 539</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 540</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 541</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 542</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 543</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 544</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 545</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 546</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 547</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 548</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 549</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 550</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 551</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 552</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 553</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 554</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 555</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 556</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 557</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 558</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 559</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 560</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 561</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 562</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 563</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 564</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 565</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 566</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 567</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 568</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 569</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 570</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 571</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 572</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 573</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 574</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 575</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 576</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 577</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 578</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 579</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 580</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 581</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 582</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 583</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 584</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 585</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 586</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 587</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 588</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 589</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 590</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 591</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 592</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 593</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 594</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 595</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 596</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 597</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 598</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 599</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 600</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 601</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 602</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 603</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 604</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 605</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 606</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 607</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 608</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 609</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 610</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 611</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 612</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 613</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 614</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 615</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 616</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 617</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 618</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 619</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 620</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 621</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 622</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 623</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 624</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 625</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 626</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 627</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 628</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 629</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 630</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 631</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 632</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 633</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 634</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 635</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 636</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 637</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 638</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 639</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 640</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 641</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 642</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 643</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 644</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 645</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 646</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 647</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 648</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 649</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 650</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 651</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 652</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 653</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 654</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 655</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 656</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 657</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 658</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 659</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 660</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 661</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 662</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 663</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 664</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 665</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 666</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 667</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 668</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 669</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 670</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 671</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 672</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 673</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 674</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 675</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 676</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 677</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 678</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 679</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 680</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 681</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 682</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 683</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 684</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 685</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 686</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 687</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 688</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 689</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 690</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 691</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 692</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 693</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 694</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 695</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 696</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 697</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 698</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 699</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 700</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 701</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 702</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 703</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 704</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 705</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 706</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 707</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 708</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 709</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 710</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 711</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 712</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 713</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 714</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 715</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 716</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 717</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 718</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 719</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 720</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 721</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 722</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 723</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 724</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 725</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 726</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 727</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 728</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 729</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 730</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 731</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 732</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 733</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 734</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 735</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 736</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 737</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 738</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 739</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 740</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 741</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 742</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 743</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 744</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 745</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 746</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 747</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 748</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 749</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 750</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 751</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 752</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 753</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 754</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 755</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 756</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 757</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 758</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 759</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 760</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 761</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 762</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 763</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 764</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 765</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 766</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 767</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 768</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 769</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 770</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 771</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 772</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 773</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 774</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 775</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 776</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 777</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 778</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 779</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 780</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 781</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 782</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 783</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 784</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 785</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 786</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 787</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 788</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 789</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 790</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 791</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 792</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 793</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 794</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 795</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 796</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 797</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 798</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 799</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 800</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 801</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 802</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 803</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 804</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 805</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 806</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 807</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 808</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 809</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 810</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 811</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 812</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 813</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 814</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 815</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 816</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 817</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 818</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 819</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 820</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 821</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 822</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 823</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 824</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 825</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 826</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 827</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 828</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 829</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 830</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 831</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 832</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 833</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 834</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 835</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 836</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 837</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 838</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 839</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 840</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 841</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 842</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 843</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 844</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 845</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 846</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 847</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 848</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 849</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 850</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 851</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 852</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 853</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 854</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 855</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 856</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 857</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 858</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 859</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 860</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 861</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 862</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 863</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 864</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 865</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 866</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 867</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 868</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 869</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 870</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 871</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 872</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 873</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 874</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 875</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 876</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 877</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 878</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 879</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 880</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 881</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 882</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 883</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 884</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 885</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 886</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 887</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 888</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 889</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 890</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 891</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 892</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 893</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 894</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 895</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 896</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 897</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 898</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 899</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 900</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 901</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 902</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 903</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 904</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 905</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 906</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 907</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 908</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 909</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 910</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 911</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 912</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 913</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 914</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 915</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 916</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 917</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 918</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 919</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 920</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 921</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 922</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 923</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 924</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 925</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 926</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 927</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 928</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 929</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 930</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 931</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 932</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 933</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 934</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 935</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 936</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 937</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 938</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 939</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 940</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 941</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 942</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 943</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 944</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 945</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 946</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 947</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 948</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 949</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 950</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 951</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 952</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 953</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 954</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 955</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 956</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 957</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 958</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 959</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 960</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 961</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 962</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 963</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 964</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 965</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 966</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 967</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 968</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 969</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 970</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 971</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 972</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 973</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 974</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 975</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 976</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 977</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 978</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 979</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 980</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 981</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 982</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 983</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 984</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 985</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 986</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 987</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 988</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 989</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 990</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 991</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 992</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 993</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 994</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 995</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 996</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 997</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 998</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 999</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1000</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1001</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1002</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1003</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1004</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1005</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1006</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1007</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1008</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1009</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1010</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1011</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1012</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1013</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1014</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1015</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1016</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1017</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1018</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1019</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1020</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1021</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1022</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1023</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1024</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1025</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1026</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1027</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1028</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1029</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1030</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1031</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1032</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1033</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1034</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1035</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1036</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1037</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1038</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1039</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1040</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1041</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1042</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1043</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1044</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1045</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1046</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1047</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1048</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1049</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1050</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1051</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1052</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1053</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1054</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1055</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1056</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1057</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1058</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1059</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1060</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1061</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1062</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1063</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">class</span> <span style="color: #f0883e; font-weight: bold">DNSHelper</span><span style="color: #e6edf3">:</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Helper class for DNS-related operations within BBOT.</span>

<span style="color: #a5d6ff">    This class provides mechanisms for host resolution, wildcard domain detection, event tagging, and more.</span>
<span style="color: #a5d6ff">    It centralizes all DNS-related activities in BBOT, offering both synchronous and asynchronous methods</span>
<span style="color: #a5d6ff">    for DNS resolution, as well as various utilities for batch resolution and DNS query filtering.</span>

<span style="color: #a5d6ff">    Attributes:</span>
<span style="color: #a5d6ff">        parent_helper: A reference to the instantiated `ConfigAwareHelper` (typically `scan.helpers`).</span>
<span style="color: #a5d6ff">        resolver (BBOTAsyncResolver): An asynchronous DNS resolver tailored for BBOT with rate-limiting capabilities.</span>
<span style="color: #a5d6ff">        timeout (int): The timeout value for DNS queries. Defaults to 5 seconds.</span>
<span style="color: #a5d6ff">        retries (int): The number of retries for failed DNS queries. Defaults to 1.</span>
<span style="color: #a5d6ff">        abort_threshold (int): The threshold for aborting after consecutive failed queries. Defaults to 50.</span>
<span style="color: #a5d6ff">        max_dns_resolve_distance (int): Maximum allowed distance for DNS resolution. Defaults to 4.</span>
<span style="color: #a5d6ff">        all_rdtypes (list): A list of DNS record types to be considered during operations.</span>
<span style="color: #a5d6ff">        wildcard_ignore (tuple): Domains to be ignored during wildcard detection.</span>
<span style="color: #a5d6ff">        wildcard_tests (int): Number of tests to be run for wildcard detection. Defaults to 5.</span>
<span style="color: #a5d6ff">        _wildcard_cache (dict): Cache for wildcard detection results.</span>
<span style="color: #a5d6ff">        _dns_cache (CacheDict): Cache for DNS resolution results, limited in size.</span>
<span style="color: #a5d6ff">        _event_cache (CacheDict): Cache for event resolution results, tags. Limited in size.</span>
<span style="color: #a5d6ff">        resolver_file (Path): File containing system's current resolver nameservers.</span>
<span style="color: #a5d6ff">        filter_bad_ptrs (bool): Whether to filter out DNS names that appear to be auto-generated PTR records. Defaults to True.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        parent_helper: The parent helper object with configuration details and utilities.</span>

<span style="color: #a5d6ff">    Raises:</span>
<span style="color: #a5d6ff">        DNSError: If an issue arises when creating the BBOTAsyncResolver instance.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; dns_helper = DNSHelper(parent_config)</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; resolved_host = dns_helper.resolver.resolve("example.com")</span>
<span style="color: #a5d6ff">    """</span>

    <span style="color: #e6edf3">all_rdtypes</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[</span><span style="color: #a5d6ff">"A"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"AAAA"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"SRV"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"MX"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"NS"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"SOA"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"CNAME"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"TXT"</span><span style="color: #e6edf3">]</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">__init__</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">parent_helper):</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">parent_helper</span>
        <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolver</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">BBOTAsyncResolver(_parent_helper</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper)</span>
        <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">Exception</span> <span style="color: #ff7b72">as</span> <span style="color: #e6edf3">e:</span>
            <span style="color: #ff7b72">raise</span> <span style="color: #e6edf3">DNSError(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Failed to create BBOT DNS resolver: {</span><span style="color: #e6edf3">e</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">timeout</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"dns_timeout"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">5</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">retries</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"dns_retries"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">abort_threshold</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"dns_abort_threshold"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">50</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">max_dns_resolve_distance</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"max_dns_resolve_distance"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">5</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolver</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">timeout</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">timeout</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolver</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">lifetime</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">timeout</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_resolver_list</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span>

        <span style="color: #8b949e; font-style: italic"># skip certain queries</span>
        <span style="color: #e6edf3">dns_omit_queries</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"dns_omit_queries"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">dns_omit_queries:</span>
            <span style="color: #e6edf3">dns_omit_queries</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">dns_omit_queries</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">dict()</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">d</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">dns_omit_queries:</span>
            <span style="color: #e6edf3">d</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">d</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">split(</span><span style="color: #a5d6ff">":"</span><span style="color: #e6edf3">)</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">len(d)</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #a5d6ff">2</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">rdtype,</span> <span style="color: #e6edf3">query</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">d</span>
                <span style="color: #e6edf3">rdtype</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">rdtype</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">upper()</span>
                <span style="color: #e6edf3">query</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">query</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">lower()</span>
                <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
                    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">dns_omit_queries[rdtype]</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">add(query)</span>
                <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">KeyError</span><span style="color: #e6edf3">:</span>
                    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">dns_omit_queries[rdtype]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{query}</span>

        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">wildcard_ignore</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"dns_wildcard_ignore"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">wildcard_ignore:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">wildcard_ignore</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">wildcard_ignore</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">tuple([str(d)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">strip()</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">lower()</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">d</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">wildcard_ignore])</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">wildcard_tests</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"dns_wildcard_tests"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">5</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_wildcard_cache</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">dict()</span>
        <span style="color: #8b949e; font-style: italic"># since wildcard detection takes some time, This is to prevent multiple</span>
        <span style="color: #8b949e; font-style: italic"># modules from kicking off wildcard detection for the same domain at the same time</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_wildcard_lock</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">NamedLock()</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_dns_connectivity_lock</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">Lock()</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_last_dns_success</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_last_connectivity_warning</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">time</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">time()</span>
        <span style="color: #8b949e; font-style: italic"># keeps track of warnings issued for wildcard detection to prevent duplicate warnings</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_dns_warnings</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">set()</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_errors</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">dict()</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">fallback_nameservers_file</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">wordlist_dir</span> <span style="color: #ff7b72; font-weight: bold">/</span> <span style="color: #a5d6ff">"nameservers.txt"</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_debug</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"dns_debug"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">False</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_dummy_modules</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">dict()</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_dns_cache</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">CacheDict(max_size</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">100000</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_event_cache</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">CacheDict(max_size</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">10000</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_event_cache_locks</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">NamedLock()</span>

        <span style="color: #8b949e; font-style: italic"># for mocking DNS queries</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_orig_resolve_raw</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_mock_table</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{}</span>

        <span style="color: #8b949e; font-style: italic"># copy the system's current resolvers to a text file for tool use</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">system_resolvers</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">dns</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolver</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">Resolver()</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">nameservers</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolver_file</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">tempfile(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">system_resolvers,</span> <span style="color: #e6edf3">pipe</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">)</span>

        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">filter_bad_ptrs</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"dns_filter_ptrs"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">True</span><span style="color: #e6edf3">)</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">resolve</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">query,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""Resolve DNS names and IP addresses to their corresponding results.</span>

<span style="color: #a5d6ff">        This is a high-level function that can translate a given domain name to its associated IP addresses</span>
<span style="color: #a5d6ff">        or an IP address to its corresponding domain names. It's structured for ease of use within modules</span>
<span style="color: #a5d6ff">        and will abstract away most of the complexity of DNS resolution, returning a simple set of results.</span>

<span style="color: #a5d6ff">        Args:</span>
<span style="color: #a5d6ff">            query (str): The domain name or IP address to resolve.</span>
<span style="color: #a5d6ff">            **kwargs: Additional arguments to be passed to the resolution process.</span>

<span style="color: #a5d6ff">        Returns:</span>
<span style="color: #a5d6ff">            set: A set containing resolved domain names or IP addresses.</span>

<span style="color: #a5d6ff">        Examples:</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; results = await resolve("1.2.3.4")</span>
<span style="color: #a5d6ff">            {"evilcorp.com"}</span>

<span style="color: #a5d6ff">            &gt;&gt;&gt; results = await resolve("evilcorp.com")</span>
<span style="color: #a5d6ff">            {"1.2.3.4", "dead::beef"}</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #e6edf3">results</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">set()</span>
        <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">r</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolve_raw(query,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">r:</span>
                <span style="color: #e6edf3">raw_results,</span> <span style="color: #e6edf3">errors</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">r</span>
                <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">rdtype,</span> <span style="color: #e6edf3">answers</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">raw_results:</span>
                    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">answer</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">answers:</span>
                        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">_,</span> <span style="color: #e6edf3">t</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">extract_targets(answer):</span>
                            <span style="color: #e6edf3">results</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">add(t)</span>
        <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">BaseException</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">trace(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Caught exception in resolve({</span><span style="color: #e6edf3">query</span><span style="color: #a5d6ff">}, {</span><span style="color: #e6edf3">kwargs</span><span style="color: #a5d6ff">}):"</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">trace(traceback</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">format_exc())</span>
            <span style="color: #ff7b72">raise</span>

        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Results for {</span><span style="color: #e6edf3">query</span><span style="color: #a5d6ff">} with kwargs={</span><span style="color: #e6edf3">kwargs</span><span style="color: #a5d6ff">}: {</span><span style="color: #e6edf3">results</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">results</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">resolve_raw</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">query,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""Resolves the given query to its associated DNS records.</span>

<span style="color: #a5d6ff">        This function is a foundational method for DNS resolution in this class. It understands both IP addresses and</span>
<span style="color: #a5d6ff">        hostnames and returns their associated records in a raw format provided by the dnspython library.</span>

<span style="color: #a5d6ff">        Args:</span>
<span style="color: #a5d6ff">            query (str): The IP address or hostname to resolve.</span>
<span style="color: #a5d6ff">            type (str or list[str], optional): Specifies the DNS record type(s) to fetch. Can be a single type like 'A'</span>
<span style="color: #a5d6ff">                or a list like ['A', 'AAAA']. If set to 'any', 'all', or '*', it fetches all supported types. If not</span>
<span style="color: #a5d6ff">                specified, the function defaults to fetching 'A' and 'AAAA' records.</span>
<span style="color: #a5d6ff">            **kwargs: Additional arguments that might be passed to the resolver.</span>

<span style="color: #a5d6ff">        Returns:</span>
<span style="color: #a5d6ff">            tuple: A tuple containing two lists:</span>
<span style="color: #a5d6ff">                - list: A list of tuples where each tuple consists of a record type string (like 'A') and the associated</span>
<span style="color: #a5d6ff">                  raw dnspython answer.</span>
<span style="color: #a5d6ff">                - list: A list of tuples where each tuple consists of a record type string and the associated error if</span>
<span style="color: #a5d6ff">                  there was an issue fetching the record.</span>

<span style="color: #a5d6ff">        Examples:</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; await resolve_raw("8.8.8.8")</span>
<span style="color: #a5d6ff">            ([('PTR', &lt;dns.resolver.Answer object at 0x7f4a47cdb1d0&gt;)], [])</span>

<span style="color: #a5d6ff">            &gt;&gt;&gt; await resolve_raw("dns.google")</span>
<span style="color: #a5d6ff">            ([('A', &lt;dns.resolver.Answer object at 0x7f4a47ce46d0&gt;), ('AAAA', &lt;dns.resolver.Answer object at 0x7f4a47ce4710&gt;)], [])</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #8b949e; font-style: italic"># DNS over TCP is more reliable</span>
        <span style="color: #8b949e; font-style: italic"># But setting this breaks DNS resolution on Ubuntu because systemd-resolve doesn't support TCP</span>
        <span style="color: #8b949e; font-style: italic"># kwargs["tcp"] = True</span>
        <span style="color: #e6edf3">results</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>
        <span style="color: #e6edf3">errors</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>
        <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">query</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">str(query)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">strip()</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">is_ip(query):</span>
                <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">pop(</span><span style="color: #a5d6ff">"type"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
                <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">pop(</span><span style="color: #a5d6ff">"rdtype"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
                <span style="color: #e6edf3">results,</span> <span style="color: #e6edf3">errors</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_resolve_ip(query,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
                <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">[(</span><span style="color: #a5d6ff">"PTR"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">results)],</span> <span style="color: #e6edf3">[(</span><span style="color: #a5d6ff">"PTR"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">e)</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">e</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">errors]</span>
            <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">types</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[</span><span style="color: #a5d6ff">"A"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"AAAA"</span><span style="color: #e6edf3">]</span>
                <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">pop(</span><span style="color: #a5d6ff">"rdtype"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
                <span style="color: #ff7b72">if</span> <span style="color: #a5d6ff">"type"</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">kwargs:</span>
                    <span style="color: #e6edf3">t</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">pop(</span><span style="color: #a5d6ff">"type"</span><span style="color: #e6edf3">)</span>
                    <span style="color: #e6edf3">types</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_parse_rdtype(t,</span> <span style="color: #e6edf3">default</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">types)</span>
                <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">t</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">types:</span>
                    <span style="color: #e6edf3">r,</span> <span style="color: #e6edf3">e</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_resolve_hostname(query,</span> <span style="color: #e6edf3">rdtype</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">t,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
                    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">r:</span>
                        <span style="color: #e6edf3">results</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append((t,</span> <span style="color: #e6edf3">r))</span>
                    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">error</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">e:</span>
                        <span style="color: #e6edf3">errors</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append((t,</span> <span style="color: #e6edf3">error))</span>
        <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">BaseException</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">trace(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Caught exception in resolve_raw({</span><span style="color: #e6edf3">query</span><span style="color: #a5d6ff">}, {</span><span style="color: #e6edf3">kwargs</span><span style="color: #a5d6ff">}):"</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">trace(traceback</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">format_exc())</span>
            <span style="color: #ff7b72">raise</span>

        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">(results,</span> <span style="color: #e6edf3">errors)</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">_resolve_hostname</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">query,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""Translate a hostname into its corresponding IP addresses.</span>

<span style="color: #a5d6ff">        This is the foundational function for converting a domain name into its associated IP addresses. It's designed</span>
<span style="color: #a5d6ff">        for internal use within the class and handles retries, caching, and a variety of error/timeout scenarios.</span>
<span style="color: #a5d6ff">        It also respects certain configurations that might ask to skip certain types of queries. Results are returned</span>
<span style="color: #a5d6ff">        in the default dnspython answer object format.</span>

<span style="color: #a5d6ff">        Args:</span>
<span style="color: #a5d6ff">            query (str): The hostname to resolve.</span>
<span style="color: #a5d6ff">            rdtype (str, optional): The type of DNS record to query (e.g., 'A', 'AAAA'). Defaults to 'A'.</span>
<span style="color: #a5d6ff">            retries (int, optional): The number of times to retry on failure. Defaults to class-wide `retries`.</span>
<span style="color: #a5d6ff">            use_cache (bool, optional): Whether to check the cache before trying a fresh resolution. Defaults to True.</span>
<span style="color: #a5d6ff">            **kwargs: Additional arguments that might be passed to the resolver.</span>

<span style="color: #a5d6ff">        Returns:</span>
<span style="color: #a5d6ff">            tuple: A tuple containing:</span>
<span style="color: #a5d6ff">                - list: A list of resolved IP addresses.</span>
<span style="color: #a5d6ff">                - list: A list of errors encountered during the resolution process.</span>

<span style="color: #a5d6ff">        Examples:</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; results, errors = await _resolve_hostname("google.com")</span>
<span style="color: #a5d6ff">            (&lt;dns.resolver.Answer object at 0x7f4a4b2caf50&gt;, [])</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Resolving {</span><span style="color: #e6edf3">query</span><span style="color: #a5d6ff">} with kwargs={</span><span style="color: #e6edf3">kwargs</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">results</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>
        <span style="color: #e6edf3">errors</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>
        <span style="color: #e6edf3">rdtype</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"rdtype"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"A"</span><span style="color: #e6edf3">)</span>

        <span style="color: #8b949e; font-style: italic"># skip certain queries if requested</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">rdtype</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">dns_omit_queries:</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">any(h</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #e6edf3">query</span> <span style="color: #ff7b72; font-weight: bold">or</span> <span style="color: #e6edf3">query</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">endswith(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">".{</span><span style="color: #e6edf3">h</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">h</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">dns_omit_queries[rdtype]):</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Skipping {</span><span style="color: #e6edf3">rdtype</span><span style="color: #a5d6ff">}:{</span><span style="color: #e6edf3">query</span><span style="color: #a5d6ff">} because it's omitted in the config"</span><span style="color: #e6edf3">)</span>
                <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">results,</span> <span style="color: #e6edf3">errors</span>

        <span style="color: #e6edf3">parent</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_domain(query)</span>
        <span style="color: #e6edf3">retries</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">pop(</span><span style="color: #a5d6ff">"retries"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">retries)</span>
        <span style="color: #e6edf3">use_cache</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">pop(</span><span style="color: #a5d6ff">"use_cache"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">True</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">tries_left</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">int(retries)</span> <span style="color: #ff7b72; font-weight: bold">+</span> <span style="color: #a5d6ff">1</span>
        <span style="color: #e6edf3">parent_hash</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">hash(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">parent</span><span style="color: #a5d6ff">}:{</span><span style="color: #e6edf3">rdtype</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">dns_cache_hash</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">hash(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">query</span><span style="color: #a5d6ff">}:{</span><span style="color: #e6edf3">rdtype</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">while</span> <span style="color: #e6edf3">tries_left</span> <span style="color: #ff7b72; font-weight: bold">&gt;</span> <span style="color: #a5d6ff">0</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">use_cache:</span>
                    <span style="color: #e6edf3">results</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_dns_cache</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(dns_cache_hash,</span> <span style="color: #e6edf3">[])</span>
                <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">results:</span>
                    <span style="color: #e6edf3">error_count</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_errors</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(parent_hash,</span> <span style="color: #a5d6ff">0</span><span style="color: #e6edf3">)</span>
                    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">error_count</span> <span style="color: #ff7b72; font-weight: bold">&gt;=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">abort_threshold:</span>
                        <span style="color: #e6edf3">connectivity</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_connectivity_check()</span>
                        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">connectivity:</span>
                            <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">verbose(</span>
                                <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">'Aborting query "{</span><span style="color: #e6edf3">query</span><span style="color: #a5d6ff">}" because failed {</span><span style="color: #e6edf3">rdtype</span><span style="color: #a5d6ff">} queries for "{</span><span style="color: #e6edf3">parent</span><span style="color: #a5d6ff">}" ({</span><span style="color: #e6edf3">error_count</span><span style="color: #a5d6ff">:,}) exceeded abort threshold ({</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">abort_threshold</span><span style="color: #a5d6ff">:,})'</span>
                            <span style="color: #e6edf3">)</span>
                            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">parent_hash</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_dns_warnings:</span>
                                <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">verbose(</span>
                                    <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">'Aborting future {</span><span style="color: #e6edf3">rdtype</span><span style="color: #a5d6ff">} queries to "{</span><span style="color: #e6edf3">parent</span><span style="color: #a5d6ff">}" because error count ({</span><span style="color: #e6edf3">error_count</span><span style="color: #a5d6ff">:,}) exceeded abort threshold ({</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">abort_threshold</span><span style="color: #a5d6ff">:,})'</span>
                                <span style="color: #e6edf3">)</span>
                            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_dns_warnings</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">add(parent_hash)</span>
                            <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">results,</span> <span style="color: #e6edf3">errors</span>
                    <span style="color: #e6edf3">results</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_catch(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolver</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolve,</span> <span style="color: #e6edf3">query,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
                    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">use_cache:</span>
                        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_dns_cache[dns_cache_hash]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">results</span>
                    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">parent_hash</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_errors:</span>
                        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_errors[parent_hash]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">0</span>
                <span style="color: #ff7b72">break</span>
            <span style="color: #ff7b72">except</span> <span style="color: #e6edf3">(</span>
                <span style="color: #e6edf3">dns</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolver</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">NoNameservers,</span>
                <span style="color: #e6edf3">dns</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">exception</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">Timeout,</span>
                <span style="color: #e6edf3">dns</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolver</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">LifetimeTimeout,</span>
                <span style="color: #f0883e; font-weight: bold">TimeoutError</span><span style="color: #e6edf3">,</span>
            <span style="color: #e6edf3">)</span> <span style="color: #ff7b72">as</span> <span style="color: #e6edf3">e:</span>
                <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
                    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_errors[parent_hash]</span> <span style="color: #ff7b72; font-weight: bold">+=</span> <span style="color: #a5d6ff">1</span>
                <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">KeyError</span><span style="color: #e6edf3">:</span>
                    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_errors[parent_hash]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">1</span>
                <span style="color: #e6edf3">errors</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(e)</span>
                <span style="color: #8b949e; font-style: italic"># don't retry if we get a SERVFAIL</span>
                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">isinstance(e,</span> <span style="color: #e6edf3">dns</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolver</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">NoNameservers):</span>
                    <span style="color: #ff7b72">break</span>
                <span style="color: #e6edf3">tries_left</span> <span style="color: #ff7b72; font-weight: bold">-=</span> <span style="color: #a5d6ff">1</span>
                <span style="color: #e6edf3">err_msg</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">(</span>
                    <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">'DNS error or timeout for {</span><span style="color: #e6edf3">rdtype</span><span style="color: #a5d6ff">} query "{</span><span style="color: #e6edf3">query</span><span style="color: #a5d6ff">}" ({</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_errors[parent_hash]</span><span style="color: #a5d6ff">:,} so far): {</span><span style="color: #e6edf3">e</span><span style="color: #a5d6ff">}'</span>
                <span style="color: #e6edf3">)</span>
                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">tries_left</span> <span style="color: #ff7b72; font-weight: bold">&gt;</span> <span style="color: #a5d6ff">0</span><span style="color: #e6edf3">:</span>
                    <span style="color: #e6edf3">retry_num</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">(retries</span> <span style="color: #ff7b72; font-weight: bold">+</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">)</span> <span style="color: #ff7b72; font-weight: bold">-</span> <span style="color: #e6edf3">tries_left</span>
                    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(err_msg)</span>
                    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Retry (#{</span><span style="color: #e6edf3">retry_num</span><span style="color: #a5d6ff">}) resolving {</span><span style="color: #e6edf3">query</span><span style="color: #a5d6ff">} with kwargs={</span><span style="color: #e6edf3">kwargs</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
                <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
                    <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">verbose(err_msg)</span>

        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">results:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_last_dns_success</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">time</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">time()</span>

        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">results,</span> <span style="color: #e6edf3">errors</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">_resolve_ip</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">query,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""Translate an IP address into a corresponding DNS name.</span>

<span style="color: #a5d6ff">        This is the most basic function that will convert an IP address into its associated domain name. It handles</span>
<span style="color: #a5d6ff">        retries, caching, and multiple types of timeout/error scenarios internally. The function is intended for</span>
<span style="color: #a5d6ff">        internal use and should not be directly called by modules without understanding its intricacies.</span>

<span style="color: #a5d6ff">        Args:</span>
<span style="color: #a5d6ff">            query (str): The IP address to be reverse-resolved.</span>
<span style="color: #a5d6ff">            retries (int, optional): The number of times to retry on failure. Defaults to 0.</span>
<span style="color: #a5d6ff">            use_cache (bool, optional): Whether to check the cache for the result before attempting resolution. Defaults to True.</span>
<span style="color: #a5d6ff">            **kwargs: Additional arguments to be passed to the resolution process.</span>

<span style="color: #a5d6ff">        Returns:</span>
<span style="color: #a5d6ff">            tuple: A tuple containing:</span>
<span style="color: #a5d6ff">                - list: A list of resolved domain names (in default dnspython answer format).</span>
<span style="color: #a5d6ff">                - list: A list of errors encountered during resolution.</span>

<span style="color: #a5d6ff">        Examples:</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; results, errors = await _resolve_ip("8.8.8.8")</span>
<span style="color: #a5d6ff">            (&lt;dns.resolver.Answer object at 0x7f4a47cdb1d0&gt;, [])</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Reverse-resolving {</span><span style="color: #e6edf3">query</span><span style="color: #a5d6ff">} with kwargs={</span><span style="color: #e6edf3">kwargs</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">retries</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">pop(</span><span style="color: #a5d6ff">"retries"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">0</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">use_cache</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">pop(</span><span style="color: #a5d6ff">"use_cache"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">True</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">tries_left</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">int(retries)</span> <span style="color: #ff7b72; font-weight: bold">+</span> <span style="color: #a5d6ff">1</span>
        <span style="color: #e6edf3">results</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>
        <span style="color: #e6edf3">errors</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>
        <span style="color: #e6edf3">dns_cache_hash</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">hash(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">query</span><span style="color: #a5d6ff">}:PTR"</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">while</span> <span style="color: #e6edf3">tries_left</span> <span style="color: #ff7b72; font-weight: bold">&gt;</span> <span style="color: #a5d6ff">0</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">use_cache:</span>
                    <span style="color: #e6edf3">results</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_dns_cache</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(dns_cache_hash,</span> <span style="color: #e6edf3">[])</span>
                <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">results:</span>
                    <span style="color: #e6edf3">results</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_catch(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolver</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolve_address,</span> <span style="color: #e6edf3">query,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
                    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">use_cache:</span>
                        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_dns_cache[dns_cache_hash]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">results</span>
                <span style="color: #ff7b72">break</span>
            <span style="color: #ff7b72">except</span> <span style="color: #e6edf3">(</span>
                <span style="color: #e6edf3">dns</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">exception</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">Timeout,</span>
                <span style="color: #e6edf3">dns</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolver</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">LifetimeTimeout,</span>
                <span style="color: #e6edf3">dns</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolver</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">NoNameservers,</span>
                <span style="color: #f0883e; font-weight: bold">TimeoutError</span><span style="color: #e6edf3">,</span>
            <span style="color: #e6edf3">)</span> <span style="color: #ff7b72">as</span> <span style="color: #e6edf3">e:</span>
                <span style="color: #e6edf3">errors</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(e)</span>
                <span style="color: #8b949e; font-style: italic"># don't retry if we get a SERVFAIL</span>
                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">isinstance(e,</span> <span style="color: #e6edf3">dns</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolver</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">NoNameservers):</span>
                    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">e</span><span style="color: #a5d6ff">} (query={</span><span style="color: #e6edf3">query</span><span style="color: #a5d6ff">}, kwargs={</span><span style="color: #e6edf3">kwargs</span><span style="color: #a5d6ff">})"</span><span style="color: #e6edf3">)</span>
                    <span style="color: #ff7b72">break</span>
                <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
                    <span style="color: #e6edf3">tries_left</span> <span style="color: #ff7b72; font-weight: bold">-=</span> <span style="color: #a5d6ff">1</span>
                    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">tries_left</span> <span style="color: #ff7b72; font-weight: bold">&gt;</span> <span style="color: #a5d6ff">0</span><span style="color: #e6edf3">:</span>
                        <span style="color: #e6edf3">retry_num</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">(retries</span> <span style="color: #ff7b72; font-weight: bold">+</span> <span style="color: #a5d6ff">2</span><span style="color: #e6edf3">)</span> <span style="color: #ff7b72; font-weight: bold">-</span> <span style="color: #e6edf3">tries_left</span>
                        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Retrying (#{</span><span style="color: #e6edf3">retry_num</span><span style="color: #a5d6ff">}) {</span><span style="color: #e6edf3">query</span><span style="color: #a5d6ff">} with kwargs={</span><span style="color: #e6edf3">kwargs</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>

        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">results:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_last_dns_success</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">time</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">time()</span>

        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">results,</span> <span style="color: #e6edf3">errors</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">handle_wildcard_event</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">event,</span> <span style="color: #e6edf3">children):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        Used within BBOT's scan manager to detect and tag DNS wildcard events.</span>

<span style="color: #a5d6ff">        Wildcards are detected for every major record type. If a wildcard is detected, its data</span>
<span style="color: #a5d6ff">        is overwritten, for example: `_wildcard.evilcorp.com`.</span>

<span style="color: #a5d6ff">        Args:</span>
<span style="color: #a5d6ff">            event (object): The event to check for wildcards.</span>
<span style="color: #a5d6ff">            children (list): A list of the event's resulting DNS children after resolution.</span>

<span style="color: #a5d6ff">        Returns:</span>
<span style="color: #a5d6ff">            None: This method modifies the `event` in place and does not return a value.</span>

<span style="color: #a5d6ff">        Examples:</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; handle_wildcard_event(event, children)</span>
<span style="color: #a5d6ff">            # The `event` might now have tags like ["wildcard", "a-wildcard", "aaaa-wildcard"] and</span>
<span style="color: #a5d6ff">            # its `data` attribute might be modified to "_wildcard.evilcorp.com" if it was detected</span>
<span style="color: #a5d6ff">            # as a wildcard.</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Entering handle_wildcard_event({</span><span style="color: #e6edf3">event</span><span style="color: #a5d6ff">}, children={</span><span style="color: #e6edf3">children</span><span style="color: #a5d6ff">})"</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">event_host</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">str(event</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">host)</span>
            <span style="color: #8b949e; font-style: italic"># wildcard checks</span>
            <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">is_ip(event</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">host):</span>
                <span style="color: #8b949e; font-style: italic"># check if the dns name itself is a wildcard entry</span>
                <span style="color: #e6edf3">wildcard_rdtypes</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">is_wildcard(event_host)</span>
                <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">rdtype,</span> <span style="color: #e6edf3">(is_wildcard,</span> <span style="color: #e6edf3">wildcard_host)</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">wildcard_rdtypes</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items():</span>
                    <span style="color: #e6edf3">wildcard_tag</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">"error"</span>
                    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">is_wildcard</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #79c0ff">True</span><span style="color: #e6edf3">:</span>
                        <span style="color: #e6edf3">event</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">add_tag(</span><span style="color: #a5d6ff">"wildcard"</span><span style="color: #e6edf3">)</span>
                        <span style="color: #e6edf3">wildcard_tag</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">"wildcard"</span>
                    <span style="color: #e6edf3">event</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">add_tag(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">rdtype</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">lower()</span><span style="color: #a5d6ff">}-{</span><span style="color: #e6edf3">wildcard_tag</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>

            <span style="color: #8b949e; font-style: italic"># wildcard event modification (www.evilcorp.com --&gt; _wildcard.evilcorp.com)</span>
            <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">is_ip(event</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">host)</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #e6edf3">children:</span>
                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">wildcard_rdtypes:</span>
                    <span style="color: #8b949e; font-style: italic"># these are the rdtypes that successfully resolve</span>
                    <span style="color: #e6edf3">resolved_rdtypes</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">set([c</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">upper()</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">c</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">children])</span>
                    <span style="color: #8b949e; font-style: italic"># these are the rdtypes that have wildcards</span>
                    <span style="color: #e6edf3">wildcard_rdtypes_set</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">set(wildcard_rdtypes)</span>
                    <span style="color: #8b949e; font-style: italic"># consider the event a full wildcard if all its records are wildcards</span>
                    <span style="color: #e6edf3">event_is_wildcard</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">False</span>
                    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">resolved_rdtypes:</span>
                        <span style="color: #e6edf3">event_is_wildcard</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">all(r</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">wildcard_rdtypes_set</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">r</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">resolved_rdtypes)</span>

                    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">event_is_wildcard:</span>
                        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">event</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">type</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">(</span><span style="color: #a5d6ff">"DNS_NAME"</span><span style="color: #e6edf3">,)</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #a5d6ff">"_wildcard"</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">event</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">data</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">split(</span><span style="color: #a5d6ff">"."</span><span style="color: #e6edf3">):</span>
                            <span style="color: #e6edf3">wildcard_parent</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_domain(event_host)</span>
                            <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">rdtype,</span> <span style="color: #e6edf3">(_is_wildcard,</span> <span style="color: #e6edf3">_parent_domain)</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">wildcard_rdtypes</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items():</span>
                                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">_is_wildcard:</span>
                                    <span style="color: #e6edf3">wildcard_parent</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">_parent_domain</span>
                                    <span style="color: #ff7b72">break</span>
                            <span style="color: #e6edf3">wildcard_data</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"_wildcard.{</span><span style="color: #e6edf3">wildcard_parent</span><span style="color: #a5d6ff">}"</span>
                            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">wildcard_data</span> <span style="color: #ff7b72; font-weight: bold">!=</span> <span style="color: #e6edf3">event</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">data:</span>
                                <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span>
                                    <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">'Wildcard detected, changing event.data "{</span><span style="color: #e6edf3">event</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">data</span><span style="color: #a5d6ff">}" --&gt; "{</span><span style="color: #e6edf3">wildcard_data</span><span style="color: #a5d6ff">}"'</span>
                                <span style="color: #e6edf3">)</span>
                                <span style="color: #e6edf3">event</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">data</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">wildcard_data</span>
                <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
                    <span style="color: #8b949e; font-style: italic"># check if this domain is using wildcard dns</span>
                    <span style="color: #e6edf3">event_target</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">"target"</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">event</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">tags</span>
                    <span style="color: #e6edf3">wildcard_domain_results</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">is_wildcard_domain(event_host,</span> <span style="color: #e6edf3">log_info</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">event_target)</span>
                    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">hostname,</span> <span style="color: #e6edf3">wildcard_domain_rdtypes</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">wildcard_domain_results</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items():</span>
                        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">wildcard_domain_rdtypes:</span>
                            <span style="color: #e6edf3">event</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">add_tag(</span><span style="color: #a5d6ff">"wildcard-domain"</span><span style="color: #e6edf3">)</span>
                            <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">rdtype,</span> <span style="color: #e6edf3">ips</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">wildcard_domain_rdtypes</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items():</span>
                                <span style="color: #e6edf3">event</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">add_tag(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">rdtype</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">lower()</span><span style="color: #a5d6ff">}-wildcard-domain"</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">finally</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Finished handle_wildcard_event({</span><span style="color: #e6edf3">event</span><span style="color: #a5d6ff">}, children={</span><span style="color: #e6edf3">children</span><span style="color: #a5d6ff">})"</span><span style="color: #e6edf3">)</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">resolve_event</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">event,</span> <span style="color: #e6edf3">minimal</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        Tag the given event with the appropriate DNS record types and optionally create child</span>
<span style="color: #a5d6ff">        events based on DNS resolutions.</span>

<span style="color: #a5d6ff">        Args:</span>
<span style="color: #a5d6ff">            event (object): The event to be resolved and tagged.</span>
<span style="color: #a5d6ff">            minimal (bool, optional): If set to True, the function will perform minimal DNS</span>
<span style="color: #a5d6ff">                resolution. Defaults to False.</span>

<span style="color: #a5d6ff">        Returns:</span>
<span style="color: #a5d6ff">            tuple: A 4-tuple containing the following items:</span>
<span style="color: #a5d6ff">                - event_tags (set): Set of tags for the event.</span>
<span style="color: #a5d6ff">                - event_whitelisted (bool): Whether the event is whitelisted.</span>
<span style="color: #a5d6ff">                - event_blacklisted (bool): Whether the event is blacklisted.</span>
<span style="color: #a5d6ff">                - dns_children (dict): Dictionary containing child events from DNS resolutions.</span>

<span style="color: #a5d6ff">        Examples:</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; event = make_event("evilcorp.com")</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; resolve_event(event)</span>
<span style="color: #a5d6ff">            ({'resolved', 'ns-record', 'a-record',}, False, False, {'A': {IPv4Address('1.2.3.4'), IPv4Address('1.2.3.5')}, 'NS': {'ns1.evilcorp.com'}})</span>

<span style="color: #a5d6ff">        Note:</span>
<span style="color: #a5d6ff">            This method does not modify the passed in `event`. Instead, it returns data</span>
<span style="color: #a5d6ff">            that can be used to modify or act upon the `event`.</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Resolving {</span><span style="color: #e6edf3">event</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">event_host</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">str(event</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">host)</span>
        <span style="color: #e6edf3">event_tags</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">set()</span>
        <span style="color: #e6edf3">dns_children</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">dict()</span>
        <span style="color: #e6edf3">event_whitelisted</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">False</span>
        <span style="color: #e6edf3">event_blacklisted</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">False</span>

        <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">(</span><span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">event</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">host)</span> <span style="color: #ff7b72; font-weight: bold">or</span> <span style="color: #e6edf3">(event</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">type</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">(</span><span style="color: #a5d6ff">"IP_RANGE"</span><span style="color: #e6edf3">,)):</span>
                <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">event_tags,</span> <span style="color: #e6edf3">event_whitelisted,</span> <span style="color: #e6edf3">event_blacklisted,</span> <span style="color: #e6edf3">dns_children</span>

            <span style="color: #8b949e; font-style: italic"># lock to ensure resolution of the same host doesn't start while we're working here</span>
            <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_event_cache_locks</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">lock(event_host):</span>
                <span style="color: #8b949e; font-style: italic"># try to get data from cache</span>
                <span style="color: #e6edf3">_event_tags,</span> <span style="color: #e6edf3">_event_whitelisted,</span> <span style="color: #e6edf3">_event_blacklisted,</span> <span style="color: #e6edf3">_dns_children</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">event_cache_get(event_host)</span>
                <span style="color: #e6edf3">event_tags</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">update(_event_tags)</span>
                <span style="color: #8b949e; font-style: italic"># if we found it, return it</span>
                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">_event_whitelisted</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
                    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">event_tags,</span> <span style="color: #e6edf3">_event_whitelisted,</span> <span style="color: #e6edf3">_event_blacklisted,</span> <span style="color: #e6edf3">_dns_children</span>

                <span style="color: #8b949e; font-style: italic"># then resolve</span>
                <span style="color: #e6edf3">types</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">()</span>
                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">is_ip(event</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">host):</span>
                    <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">minimal:</span>
                        <span style="color: #e6edf3">types</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">(</span><span style="color: #a5d6ff">"PTR"</span><span style="color: #e6edf3">,)</span>
                <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
                    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">event</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">type</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #a5d6ff">"DNS_NAME"</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">minimal:</span>
                        <span style="color: #e6edf3">types</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">all_rdtypes</span>
                    <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
                        <span style="color: #e6edf3">types</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">(</span><span style="color: #a5d6ff">"A"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"AAAA"</span><span style="color: #e6edf3">)</span>

                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">types:</span>
                    <span style="color: #e6edf3">tasks</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolve_raw(event_host,</span> <span style="color: #e6edf3">type</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">t,</span> <span style="color: #e6edf3">use_cache</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">)</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">t</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">types]</span>
                    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">task</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">as_completed(tasks):</span>
                        <span style="color: #e6edf3">resolved_raw,</span> <span style="color: #e6edf3">errors</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">task</span>
                        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">rdtype,</span> <span style="color: #e6edf3">e</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">errors:</span>
                            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">rdtype</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">resolved_raw:</span>
                                <span style="color: #e6edf3">event_tags</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">add(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">rdtype</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">lower()</span><span style="color: #a5d6ff">}-error"</span><span style="color: #e6edf3">)</span>
                        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">rdtype,</span> <span style="color: #e6edf3">records</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">resolved_raw:</span>
                            <span style="color: #e6edf3">rdtype</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">str(rdtype)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">upper()</span>
                            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">records:</span>
                                <span style="color: #e6edf3">event_tags</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">add(</span><span style="color: #a5d6ff">"resolved"</span><span style="color: #e6edf3">)</span>
                                <span style="color: #e6edf3">event_tags</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">add(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">rdtype</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">lower()</span><span style="color: #a5d6ff">}-record"</span><span style="color: #e6edf3">)</span>

                            <span style="color: #8b949e; font-style: italic"># whitelisting and blacklisting of IPs</span>
                            <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">r</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">records:</span>
                                <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">_,</span> <span style="color: #e6edf3">t</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">extract_targets(r):</span>
                                    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">t:</span>
                                        <span style="color: #e6edf3">ip</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">make_ip_type(t)</span>

                                        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">rdtype</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">(</span><span style="color: #a5d6ff">"A"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"AAAA"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"CNAME"</span><span style="color: #e6edf3">):</span>
                                            <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">contextlib</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">suppress(ValidationError):</span>
                                                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">is_ip(ip):</span>
                                                    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">scan</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">whitelisted(ip):</span>
                                                        <span style="color: #e6edf3">event_whitelisted</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">True</span>
                                            <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">contextlib</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">suppress(ValidationError):</span>
                                                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">scan</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">blacklisted(ip):</span>
                                                    <span style="color: #e6edf3">event_blacklisted</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">True</span>

                                        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">filter_bad_ptrs</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #e6edf3">rdtype</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">(</span><span style="color: #a5d6ff">"PTR"</span><span style="color: #e6edf3">)</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">is_ptr(t):</span>
                                            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Filtering out bad PTR: {</span><span style="color: #e6edf3">t</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
                                            <span style="color: #ff7b72">continue</span>

                                        <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
                                            <span style="color: #e6edf3">dns_children[rdtype]</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">add(ip)</span>
                                        <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">KeyError</span><span style="color: #e6edf3">:</span>
                                            <span style="color: #e6edf3">dns_children[rdtype]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{ip}</span>

                    <span style="color: #8b949e; font-style: italic"># tag with cloud providers</span>
                    <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">in_tests:</span>
                        <span style="color: #e6edf3">to_check</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">set()</span>
                        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">event</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">type</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #a5d6ff">"IP_ADDRESS"</span><span style="color: #e6edf3">:</span>
                            <span style="color: #e6edf3">to_check</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">add(event</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">data)</span>
                        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">rdtype,</span> <span style="color: #e6edf3">ips</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">dns_children</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items():</span>
                            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">rdtype</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">(</span><span style="color: #a5d6ff">"A"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"AAAA"</span><span style="color: #e6edf3">):</span>
                                <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">ip</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">ips:</span>
                                    <span style="color: #e6edf3">to_check</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">add(ip)</span>
                        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">ip</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">to_check:</span>
                            <span style="color: #e6edf3">provider,</span> <span style="color: #e6edf3">provider_type,</span> <span style="color: #e6edf3">subnet</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">cloudcheck(ip)</span>
                            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">provider:</span>
                                <span style="color: #e6edf3">event_tags</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">add(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">provider_type</span><span style="color: #a5d6ff">}-{</span><span style="color: #e6edf3">provider</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>

                    <span style="color: #8b949e; font-style: italic"># if needed, mark as unresolved</span>
                    <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">is_ip(event_host)</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #a5d6ff">"resolved"</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">event_tags:</span>
                        <span style="color: #e6edf3">event_tags</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">add(</span><span style="color: #a5d6ff">"unresolved"</span><span style="color: #e6edf3">)</span>
                    <span style="color: #8b949e; font-style: italic"># check for private IPs</span>
                    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">rdtype,</span> <span style="color: #e6edf3">ips</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">dns_children</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items():</span>
                        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">ip</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">ips:</span>
                            <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
                                <span style="color: #e6edf3">ip</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">ipaddress</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">ip_address(ip)</span>
                                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">ip</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">is_private:</span>
                                    <span style="color: #e6edf3">event_tags</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">add(</span><span style="color: #a5d6ff">"private-ip"</span><span style="color: #e6edf3">)</span>
                            <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">ValueError</span><span style="color: #e6edf3">:</span>
                                <span style="color: #ff7b72">continue</span>

                    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_event_cache[event_host]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">(event_tags,</span> <span style="color: #e6edf3">event_whitelisted,</span> <span style="color: #e6edf3">event_blacklisted,</span> <span style="color: #e6edf3">dns_children)</span>

            <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">event_tags,</span> <span style="color: #e6edf3">event_whitelisted,</span> <span style="color: #e6edf3">event_blacklisted,</span> <span style="color: #e6edf3">dns_children</span>

        <span style="color: #ff7b72">finally</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Finished resolving {</span><span style="color: #e6edf3">event</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">event_cache_get</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">host):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        Retrieves cached event data based on the given host.</span>

<span style="color: #a5d6ff">        Args:</span>
<span style="color: #a5d6ff">            host (str): The host for which the event data is to be retrieved.</span>

<span style="color: #a5d6ff">        Returns:</span>
<span style="color: #a5d6ff">            tuple: A 4-tuple containing the following items:</span>
<span style="color: #a5d6ff">                - event_tags (set): Set of tags for the event.</span>
<span style="color: #a5d6ff">                - event_whitelisted (bool or None): Whether the event is whitelisted. Returns None if not found.</span>
<span style="color: #a5d6ff">                - event_blacklisted (bool or None): Whether the event is blacklisted. Returns None if not found.</span>
<span style="color: #a5d6ff">                - dns_children (set): Set containing child events from DNS resolutions.</span>

<span style="color: #a5d6ff">        Examples:</span>
<span style="color: #a5d6ff">            Assuming an event with host "www.evilcorp.com" has been cached:</span>

<span style="color: #a5d6ff">            &gt;&gt;&gt; event_cache_get("www.evilcorp.com")</span>
<span style="color: #a5d6ff">            ({"resolved", "a-record"}, False, False, {'1.2.3.4'})</span>

<span style="color: #a5d6ff">            Assuming no event with host "www.notincache.com" has been cached:</span>

<span style="color: #a5d6ff">            &gt;&gt;&gt; event_cache_get("www.notincache.com")</span>
<span style="color: #a5d6ff">            (set(), None, None, set())</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">event_tags,</span> <span style="color: #e6edf3">event_whitelisted,</span> <span style="color: #e6edf3">event_blacklisted,</span> <span style="color: #e6edf3">dns_children</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_event_cache[host]</span>
            <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">(event_tags,</span> <span style="color: #e6edf3">event_whitelisted,</span> <span style="color: #e6edf3">event_blacklisted,</span> <span style="color: #e6edf3">dns_children)</span>
        <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">KeyError</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">set(),</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">set()</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">_resolve_batch_coro_wrapper</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">q,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        Helps us correlate task results back to their original arguments</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #e6edf3">result</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolve(q,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">(q,</span> <span style="color: #e6edf3">result)</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">resolve_batch</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">queries,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        Asynchronously resolves a batch of queries in parallel and yields the results as they are completed.</span>

<span style="color: #a5d6ff">        This method wraps around `_resolve_batch_coro_wrapper` to resolve a list of queries in parallel.</span>
<span style="color: #a5d6ff">        It batches the queries to a manageable size and executes them asynchronously, respecting</span>
<span style="color: #a5d6ff">        global rate limits.</span>

<span style="color: #a5d6ff">        Args:</span>
<span style="color: #a5d6ff">            queries (list): List of queries to resolve.</span>
<span style="color: #a5d6ff">            **kwargs: Additional keyword arguments to pass to `_resolve_batch_coro_wrapper`.</span>

<span style="color: #a5d6ff">        Yields:</span>
<span style="color: #a5d6ff">            tuple: A tuple containing the original query and its resolved value.</span>

<span style="color: #a5d6ff">        Examples:</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; import asyncio</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; async def example_usage():</span>
<span style="color: #a5d6ff">            ...     async for result in resolve_batch(['www.evilcorp.com', 'evilcorp.com']):</span>
<span style="color: #a5d6ff">            ...         print(result)</span>
<span style="color: #a5d6ff">            ('www.evilcorp.com', {'1.1.1.1'})</span>
<span style="color: #a5d6ff">            ('evilcorp.com', {'2.2.2.2'})</span>

<span style="color: #a5d6ff">        """</span>
        <span style="color: #e6edf3">queries</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">list(queries)</span>
        <span style="color: #e6edf3">batch_size</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">250</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">i</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">range(</span><span style="color: #a5d6ff">0</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">len(queries),</span> <span style="color: #e6edf3">batch_size):</span>
            <span style="color: #e6edf3">batch</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">queries[i</span> <span style="color: #e6edf3">:</span> <span style="color: #e6edf3">i</span> <span style="color: #ff7b72; font-weight: bold">+</span> <span style="color: #e6edf3">batch_size]</span>
            <span style="color: #e6edf3">tasks</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_resolve_batch_coro_wrapper(q,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">q</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">batch]</span>
            <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">task</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">as_completed(tasks):</span>
                <span style="color: #ff7b72">yield</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">task</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">extract_targets</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">record):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        Extracts hostnames or IP addresses from a given DNS record.</span>

<span style="color: #a5d6ff">        This method reads the DNS record's type and based on that, extracts the target</span>
<span style="color: #a5d6ff">        hostnames or IP addresses it points to. The type of DNS record</span>
<span style="color: #a5d6ff">        (e.g., "A", "MX", "CNAME", etc.) determines which fields are used for extraction.</span>

<span style="color: #a5d6ff">        Args:</span>
<span style="color: #a5d6ff">            record (dns.rdata.Rdata): The DNS record to extract information from.</span>

<span style="color: #a5d6ff">        Returns:</span>
<span style="color: #a5d6ff">            set: A set of tuples, each containing the DNS record type and the extracted value.</span>

<span style="color: #a5d6ff">        Examples:</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; from dns.rrset import from_text</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; record = from_text('www.example.com', 3600, 'IN', 'A', '192.0.2.1')</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; extract_targets(record[0])</span>
<span style="color: #a5d6ff">            {('A', '192.0.2.1')}</span>

<span style="color: #a5d6ff">            &gt;&gt;&gt; record = from_text('example.com', 3600, 'IN', 'MX', '10 mail.example.com.')</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; extract_targets(record[0])</span>
<span style="color: #a5d6ff">            {('MX', 'mail.example.com')}</span>

<span style="color: #a5d6ff">        """</span>
        <span style="color: #e6edf3">results</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">set()</span>
        <span style="color: #e6edf3">rdtype</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">str(record</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">rdtype</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">upper()</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">rdtype</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">(</span><span style="color: #a5d6ff">"A"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"AAAA"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"NS"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"CNAME"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"PTR"</span><span style="color: #e6edf3">):</span>
            <span style="color: #e6edf3">results</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">add((rdtype,</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_clean_dns_record(record)))</span>
        <span style="color: #ff7b72">elif</span> <span style="color: #e6edf3">rdtype</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #a5d6ff">"SOA"</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">results</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">add((rdtype,</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_clean_dns_record(record</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">mname)))</span>
        <span style="color: #ff7b72">elif</span> <span style="color: #e6edf3">rdtype</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #a5d6ff">"MX"</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">results</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">add((rdtype,</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_clean_dns_record(record</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">exchange)))</span>
        <span style="color: #ff7b72">elif</span> <span style="color: #e6edf3">rdtype</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #a5d6ff">"SRV"</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">results</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">add((rdtype,</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_clean_dns_record(record</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">target)))</span>
        <span style="color: #ff7b72">elif</span> <span style="color: #e6edf3">rdtype</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #a5d6ff">"TXT"</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">s</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">record</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">strings:</span>
                <span style="color: #e6edf3">s</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">smart_decode(s)</span>
                <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">match</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">dns_name_regex</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">finditer(s):</span>
                    <span style="color: #e6edf3">start,</span> <span style="color: #e6edf3">end</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">match</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">span()</span>
                    <span style="color: #e6edf3">host</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">s[start:end]</span>
                    <span style="color: #e6edf3">results</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">add((rdtype,</span> <span style="color: #e6edf3">host))</span>
        <span style="color: #ff7b72">elif</span> <span style="color: #e6edf3">rdtype</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #a5d6ff">"NSEC"</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">results</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">add((rdtype,</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_clean_dns_record(record</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">next)))</span>
        <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">warning(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">'Unknown DNS record type "{</span><span style="color: #e6edf3">rdtype</span><span style="color: #a5d6ff">}"'</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">results</span>

    <span style="color: #d2a8ff; font-weight: bold">@staticmethod</span>
    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">_clean_dns_record</span><span style="color: #e6edf3">(record):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        Cleans and formats a given DNS record for further processing.</span>

<span style="color: #a5d6ff">        This static method converts the DNS record to text format if it's not already a string.</span>
<span style="color: #a5d6ff">        It also removes any trailing dots and converts the record to lowercase.</span>

<span style="color: #a5d6ff">        Args:</span>
<span style="color: #a5d6ff">            record (str or dns.rdata.Rdata): The DNS record to clean.</span>

<span style="color: #a5d6ff">        Returns:</span>
<span style="color: #a5d6ff">            str: The cleaned and formatted DNS record.</span>

<span style="color: #a5d6ff">        Examples:</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; _clean_dns_record('www.evilcorp.com.')</span>
<span style="color: #a5d6ff">            'www.evilcorp.com'</span>

<span style="color: #a5d6ff">            &gt;&gt;&gt; from dns.rrset import from_text</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; record = from_text('www.evilcorp.com', 3600, 'IN', 'A', '1.2.3.4')[0]</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; _clean_dns_record(record)</span>
<span style="color: #a5d6ff">            '1.2.3.4'</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">isinstance(record,</span> <span style="color: #e6edf3">str):</span>
            <span style="color: #e6edf3">record</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">str(record</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">to_text())</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">str(record)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">rstrip(</span><span style="color: #a5d6ff">"."</span><span style="color: #e6edf3">)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">lower()</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">_catch</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">callback,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        Asynchronously catches exceptions thrown during DNS resolution and logs them.</span>

<span style="color: #a5d6ff">        This method wraps around a given asynchronous callback function to handle different</span>
<span style="color: #a5d6ff">        types of DNS exceptions and general exceptions. It logs the exceptions for debugging</span>
<span style="color: #a5d6ff">        and, in some cases, re-raises them.</span>

<span style="color: #a5d6ff">        Args:</span>
<span style="color: #a5d6ff">            callback (callable): The asynchronous function to be executed.</span>
<span style="color: #a5d6ff">            *args: Positional arguments to pass to the callback.</span>
<span style="color: #a5d6ff">            **kwargs: Keyword arguments to pass to the callback.</span>

<span style="color: #a5d6ff">        Returns:</span>
<span style="color: #a5d6ff">            Any: The return value of the callback function, or an empty list if an exception is caught.</span>

<span style="color: #a5d6ff">        Raises:</span>
<span style="color: #a5d6ff">            dns.resolver.NoNameservers: When no nameservers could be reached.</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">return</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">callback(</span><span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
        <span style="color: #ff7b72">except</span> <span style="color: #e6edf3">dns</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolver</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">NoNameservers:</span>
            <span style="color: #ff7b72">raise</span>
        <span style="color: #ff7b72">except</span> <span style="color: #e6edf3">(dns</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">exception</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">Timeout,</span> <span style="color: #e6edf3">dns</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolver</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">LifetimeTimeout,</span> <span style="color: #f0883e; font-weight: bold">TimeoutError</span><span style="color: #e6edf3">):</span>
            <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"DNS query with args={</span><span style="color: #e6edf3">args</span><span style="color: #a5d6ff">}, kwargs={</span><span style="color: #e6edf3">kwargs</span><span style="color: #a5d6ff">} timed out after {</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">timeout</span><span style="color: #a5d6ff">} seconds"</span><span style="color: #e6edf3">)</span>
            <span style="color: #ff7b72">raise</span>
        <span style="color: #ff7b72">except</span> <span style="color: #e6edf3">dns</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">exception</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">DNSException</span> <span style="color: #ff7b72">as</span> <span style="color: #e6edf3">e:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">e</span><span style="color: #a5d6ff">} (args={</span><span style="color: #e6edf3">args</span><span style="color: #a5d6ff">}, kwargs={</span><span style="color: #e6edf3">kwargs</span><span style="color: #a5d6ff">})"</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">Exception</span> <span style="color: #ff7b72">as</span> <span style="color: #e6edf3">e:</span>
            <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">warning(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Error in {</span><span style="color: #e6edf3">callback</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #79c0ff">__qualname__</span><span style="color: #a5d6ff">}() with args={</span><span style="color: #e6edf3">args</span><span style="color: #a5d6ff">}, kwargs={</span><span style="color: #e6edf3">kwargs</span><span style="color: #a5d6ff">}: {</span><span style="color: #e6edf3">e</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">trace(traceback</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">format_exc())</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">[]</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">is_wildcard</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">query,</span> <span style="color: #e6edf3">ips</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">rdtype</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        Use this method to check whether a *host* is a wildcard entry</span>

<span style="color: #a5d6ff">        This can reliably tell the difference between a valid DNS record and a wildcard within a wildcard domain.</span>

<span style="color: #a5d6ff">        If you want to know whether a domain is using wildcard DNS, use `is_wildcard_domain()` instead.</span>

<span style="color: #a5d6ff">        Args:</span>
<span style="color: #a5d6ff">            query (str): The hostname to check for a wildcard entry.</span>
<span style="color: #a5d6ff">            ips (list, optional): List of IPs to compare against, typically obtained from a previous DNS resolution of the query.</span>
<span style="color: #a5d6ff">            rdtype (str, optional): The DNS record type (e.g., "A", "AAAA") to consider during the check.</span>

<span style="color: #a5d6ff">        Returns:</span>
<span style="color: #a5d6ff">            dict: A dictionary indicating if the query is a wildcard for each checked DNS record type.</span>
<span style="color: #a5d6ff">                Keys are DNS record types like "A", "AAAA", etc.</span>
<span style="color: #a5d6ff">                Values are tuples where the first element is a boolean indicating if the query is a wildcard,</span>
<span style="color: #a5d6ff">                and the second element is the wildcard parent if it's a wildcard.</span>

<span style="color: #a5d6ff">        Raises:</span>
<span style="color: #a5d6ff">            ValueError: If only one of `ips` or `rdtype` is specified or if no valid IPs are specified.</span>

<span style="color: #a5d6ff">        Examples:</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; is_wildcard("www.github.io")</span>
<span style="color: #a5d6ff">            {"A": (True, "github.io"), "AAAA": (True, "github.io")}</span>

<span style="color: #a5d6ff">            &gt;&gt;&gt; is_wildcard("www.evilcorp.com", ips=["93.184.216.34"], rdtype="A")</span>
<span style="color: #a5d6ff">            {"A": (False, "evilcorp.com")}</span>

<span style="color: #a5d6ff">        Note:</span>
<span style="color: #a5d6ff">            `is_wildcard` can be True, False, or None (indicating that wildcard detection was inconclusive)</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #e6edf3">result</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{}</span>

        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">[ips,</span> <span style="color: #e6edf3">rdtype]</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">count(</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">raise</span> <span style="color: #f0883e; font-weight: bold">ValueError</span><span style="color: #e6edf3">(</span><span style="color: #a5d6ff">"Both ips and rdtype must be specified"</span><span style="color: #e6edf3">)</span>

        <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">is_dns_name(query):</span>
            <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">{}</span>

        <span style="color: #8b949e; font-style: italic"># skip check if the query's parent domain is excluded in the config</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">d</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">wildcard_ignore:</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">host_in_host(query,</span> <span style="color: #e6edf3">d):</span>
                <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Skipping wildcard detection on {</span><span style="color: #e6edf3">query</span><span style="color: #a5d6ff">} because it is excluded in the config"</span><span style="color: #e6edf3">)</span>
                <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">{}</span>

        <span style="color: #e6edf3">query</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_clean_dns_record(query)</span>
        <span style="color: #8b949e; font-style: italic"># skip check if it's an IP</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">is_ip(query)</span> <span style="color: #ff7b72; font-weight: bold">or</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #a5d6ff">"."</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">query:</span>
            <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">{}</span>
        <span style="color: #8b949e; font-style: italic"># skip check if the query is a domain</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">is_domain(query):</span>
            <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">{}</span>

        <span style="color: #e6edf3">parent</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">parent_domain(query)</span>
        <span style="color: #e6edf3">parents</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">list(domain_parents(query))</span>

        <span style="color: #e6edf3">rdtypes_to_check</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[rdtype]</span> <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">rdtype</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #79c0ff">None</span> <span style="color: #ff7b72">else</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">all_rdtypes</span>

        <span style="color: #e6edf3">base_query_ips</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">dict()</span>
        <span style="color: #8b949e; font-style: italic"># if the caller hasn't already done the work of resolving the IPs</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">ips</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
            <span style="color: #8b949e; font-style: italic"># then resolve the query for all rdtypes</span>
            <span style="color: #e6edf3">base_query_tasks</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{</span>
                <span style="color: #e6edf3">t:</span> <span style="color: #e6edf3">asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">create_task(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolve_raw(query,</span> <span style="color: #e6edf3">type</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">t,</span> <span style="color: #e6edf3">use_cache</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">))</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">t</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">rdtypes_to_check</span>
            <span style="color: #e6edf3">}</span>
            <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">_rdtype,</span> <span style="color: #e6edf3">task</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">base_query_tasks</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items():</span>
                <span style="color: #e6edf3">raw_results,</span> <span style="color: #e6edf3">errors</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">task</span>
                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">errors</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">raw_results:</span>
                    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Failed to resolve {</span><span style="color: #e6edf3">query</span><span style="color: #a5d6ff">} ({</span><span style="color: #e6edf3">_rdtype</span><span style="color: #a5d6ff">}) during wildcard detection"</span><span style="color: #e6edf3">)</span>
                    <span style="color: #e6edf3">result[_rdtype]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">(</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">parent)</span>
                    <span style="color: #ff7b72">continue</span>
                <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">__rdtype,</span> <span style="color: #e6edf3">answers</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">raw_results:</span>
                    <span style="color: #e6edf3">base_query_results</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">set()</span>
                    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">answer</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">answers:</span>
                        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">_,</span> <span style="color: #e6edf3">t</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">extract_targets(answer):</span>
                            <span style="color: #e6edf3">base_query_results</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">add(t)</span>
                    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">base_query_results:</span>
                        <span style="color: #e6edf3">base_query_ips[__rdtype]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">base_query_results</span>
        <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
            <span style="color: #8b949e; font-style: italic"># otherwise, we can skip all that</span>
            <span style="color: #e6edf3">cleaned_ips</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">set([self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_clean_dns_record(ip)</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">ip</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">ips])</span>
            <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">cleaned_ips:</span>
                <span style="color: #ff7b72">raise</span> <span style="color: #f0883e; font-weight: bold">ValueError</span><span style="color: #e6edf3">(</span><span style="color: #a5d6ff">"Valid IPs must be specified"</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">base_query_ips[rdtype]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">cleaned_ips</span>
        <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">base_query_ips:</span>
            <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">result</span>

        <span style="color: #8b949e; font-style: italic"># once we've resolved the base query and have IP addresses to work with</span>
        <span style="color: #8b949e; font-style: italic"># we can compare the IPs to the ones we have on file for wildcards</span>

        <span style="color: #8b949e; font-style: italic"># for every parent domain, starting with the shortest</span>
        <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">host</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">parents[::</span><span style="color: #ff7b72; font-weight: bold">-</span><span style="color: #a5d6ff">1</span><span style="color: #e6edf3">]:</span>
                <span style="color: #8b949e; font-style: italic"># for every rdtype</span>
                <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">_rdtype</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">list(base_query_ips):</span>
                    <span style="color: #8b949e; font-style: italic"># get the IPs from above</span>
                    <span style="color: #e6edf3">query_ips</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">base_query_ips</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(_rdtype,</span> <span style="color: #e6edf3">set())</span>
                    <span style="color: #8b949e; font-style: italic"># make sure we've checked that domain for wildcards</span>
                    <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">is_wildcard_domain(host)</span>
                    <span style="color: #e6edf3">host_hash</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">hash(host)</span>

                    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">host_hash</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_wildcard_cache:</span>
                        <span style="color: #8b949e; font-style: italic"># then get its IPs from our wildcard cache</span>
                        <span style="color: #e6edf3">wildcard_rdtypes</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_wildcard_cache[host_hash]</span>

                        <span style="color: #8b949e; font-style: italic"># then check to see if our IPs match the wildcard ones</span>
                        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">_rdtype</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">wildcard_rdtypes:</span>
                            <span style="color: #e6edf3">wildcard_ips</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">wildcard_rdtypes[_rdtype]</span>
                            <span style="color: #8b949e; font-style: italic"># if our IPs match the wildcard ones, then ladies and gentlemen we have a wildcard</span>
                            <span style="color: #e6edf3">is_wildcard</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">any(r</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">wildcard_ips</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">r</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">query_ips)</span>

                            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">is_wildcard</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">result</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(_rdtype,</span> <span style="color: #e6edf3">(</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">))[</span><span style="color: #a5d6ff">0</span><span style="color: #e6edf3">]</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">True</span><span style="color: #e6edf3">:</span>
                                <span style="color: #e6edf3">result[_rdtype]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">(</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">host)</span>

                    <span style="color: #8b949e; font-style: italic"># if we've reached a point where the dns name is a complete wildcard, class can be dismissed early</span>
                    <span style="color: #e6edf3">base_query_rdtypes</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">set(base_query_ips)</span>
                    <span style="color: #e6edf3">wildcard_rdtypes_set</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">set([k</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">k,</span> <span style="color: #e6edf3">v</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">result</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items()</span> <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">v[</span><span style="color: #a5d6ff">0</span><span style="color: #e6edf3">]</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">True</span><span style="color: #e6edf3">])</span>
                    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">base_query_rdtypes</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #e6edf3">wildcard_rdtypes_set</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #e6edf3">base_query_rdtypes</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #e6edf3">wildcard_rdtypes_set:</span>
                        <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span>
                            <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Breaking from wildcard detection for {</span><span style="color: #e6edf3">query</span><span style="color: #a5d6ff">} at {</span><span style="color: #e6edf3">host</span><span style="color: #a5d6ff">} because base query rdtypes ({</span><span style="color: #e6edf3">base_query_rdtypes</span><span style="color: #a5d6ff">}) == wildcard rdtypes ({</span><span style="color: #e6edf3">wildcard_rdtypes_set</span><span style="color: #a5d6ff">})"</span>
                        <span style="color: #e6edf3">)</span>
                        <span style="color: #ff7b72">raise</span> <span style="color: #e6edf3">DNSWildcardBreak()</span>
        <span style="color: #ff7b72">except</span> <span style="color: #e6edf3">DNSWildcardBreak:</span>
            <span style="color: #ff7b72">pass</span>

        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">result</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">is_wildcard_domain</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">domain,</span> <span style="color: #e6edf3">log_info</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        Check whether a given host or its children make use of wildcard DNS entries. Wildcard DNS can have</span>
<span style="color: #a5d6ff">        various implications, particularly in subdomain enumeration and subdomain takeovers.</span>

<span style="color: #a5d6ff">        Args:</span>
<span style="color: #a5d6ff">            domain (str): The domain to check for wildcard DNS entries.</span>
<span style="color: #a5d6ff">            log_info (bool, optional): Whether to log the result of the check. Defaults to False.</span>

<span style="color: #a5d6ff">        Returns:</span>
<span style="color: #a5d6ff">            dict: A dictionary where the keys are the parent domains that have wildcard DNS entries,</span>
<span style="color: #a5d6ff">            and the values are another dictionary of DNS record types ("A", "AAAA", etc.) mapped to</span>
<span style="color: #a5d6ff">            sets of their resolved IP addresses.</span>

<span style="color: #a5d6ff">        Examples:</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; is_wildcard_domain("github.io")</span>
<span style="color: #a5d6ff">            {"github.io": {"A": {"1.2.3.4"}, "AAAA": {"dead::beef"}}}</span>

<span style="color: #a5d6ff">            &gt;&gt;&gt; is_wildcard_domain("example.com")</span>
<span style="color: #a5d6ff">            {}</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #e6edf3">wildcard_domain_results</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{}</span>
        <span style="color: #e6edf3">domain</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_clean_dns_record(domain)</span>

        <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">is_dns_name(domain):</span>
            <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">{}</span>

        <span style="color: #8b949e; font-style: italic"># skip check if the query's parent domain is excluded in the config</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">d</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">wildcard_ignore:</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">host_in_host(domain,</span> <span style="color: #e6edf3">d):</span>
                <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Skipping wildcard detection on {</span><span style="color: #e6edf3">domain</span><span style="color: #a5d6ff">} because it is excluded in the config"</span><span style="color: #e6edf3">)</span>
                <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">{}</span>

        <span style="color: #e6edf3">rdtypes_to_check</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">set(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">all_rdtypes)</span>

        <span style="color: #8b949e; font-style: italic"># make a list of its parents</span>
        <span style="color: #e6edf3">parents</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">list(domain_parents(domain,</span> <span style="color: #e6edf3">include_self</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">))</span>
        <span style="color: #8b949e; font-style: italic"># and check each of them, beginning with the highest parent (i.e. the root domain)</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">i,</span> <span style="color: #e6edf3">host</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">enumerate(parents[::</span><span style="color: #ff7b72; font-weight: bold">-</span><span style="color: #a5d6ff">1</span><span style="color: #e6edf3">]):</span>
            <span style="color: #8b949e; font-style: italic"># have we checked this host before?</span>
            <span style="color: #e6edf3">host_hash</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">hash(host)</span>
            <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_wildcard_lock</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">lock(host_hash):</span>
                <span style="color: #8b949e; font-style: italic"># if we've seen this host before</span>
                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">host_hash</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_wildcard_cache:</span>
                    <span style="color: #e6edf3">wildcard_domain_results[host]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_wildcard_cache[host_hash]</span>
                    <span style="color: #ff7b72">continue</span>

                <span style="color: #8b949e; font-style: italic"># determine if this is a wildcard domain</span>
                <span style="color: #e6edf3">wildcard_tasks</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{t:</span> <span style="color: #e6edf3">[]</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">t</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">rdtypes_to_check}</span>
                <span style="color: #8b949e; font-style: italic"># resolve a bunch of random subdomains of the same parent</span>
                <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">rdtype</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">rdtypes_to_check:</span>
                    <span style="color: #8b949e; font-style: italic"># continue if a wildcard was already found for this rdtype</span>
                    <span style="color: #8b949e; font-style: italic"># if rdtype in self._wildcard_cache[host_hash]:</span>
                    <span style="color: #8b949e; font-style: italic">#     continue</span>
                    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">_</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">range(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">wildcard_tests):</span>
                        <span style="color: #e6edf3">rand_query</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">rand_string(digits</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">,</span><span style="color: #6e7681"> </span><span style="color: #e6edf3">length</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">10</span><span style="color: #e6edf3">)</span><span style="color: #a5d6ff">}.{</span><span style="color: #e6edf3">host</span><span style="color: #a5d6ff">}"</span>
                        <span style="color: #e6edf3">wildcard_tasks[rdtype]</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolve(rand_query,</span> <span style="color: #e6edf3">type</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">rdtype,</span> <span style="color: #e6edf3">use_cache</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">))</span>

                <span style="color: #8b949e; font-style: italic"># combine the random results</span>
                <span style="color: #e6edf3">is_wildcard</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">False</span>
                <span style="color: #e6edf3">wildcard_results</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">dict()</span>
                <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">rdtype,</span> <span style="color: #e6edf3">tasks</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">wildcard_tasks</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items():</span>
                    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">task</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">as_completed(tasks):</span>
                        <span style="color: #e6edf3">results</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">task</span>
                        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">results:</span>
                            <span style="color: #e6edf3">is_wildcard</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">True</span>
                            <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">rdtype</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">wildcard_results:</span>
                                <span style="color: #e6edf3">wildcard_results[rdtype]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">set()</span>
                            <span style="color: #e6edf3">wildcard_results[rdtype]</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">update(results)</span>
                            <span style="color: #8b949e; font-style: italic"># we know this rdtype is a wildcard</span>
                            <span style="color: #8b949e; font-style: italic"># so we don't need to check it anymore</span>
                            <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">suppress(</span><span style="color: #f0883e; font-weight: bold">KeyError</span><span style="color: #e6edf3">):</span>
                                <span style="color: #e6edf3">rdtypes_to_check</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">remove(rdtype)</span>

                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_wildcard_cache</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">update({host_hash:</span> <span style="color: #e6edf3">wildcard_results})</span>
                <span style="color: #e6edf3">wildcard_domain_results</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">update({host:</span> <span style="color: #e6edf3">wildcard_results})</span>
                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">is_wildcard:</span>
                    <span style="color: #e6edf3">wildcard_rdtypes_str</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">","</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join(sorted([t</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">upper()</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">t,</span> <span style="color: #e6edf3">r</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">wildcard_results</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items()</span> <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">r]))</span>
                    <span style="color: #e6edf3">log_fn</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">verbose</span>
                    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">log_info:</span>
                        <span style="color: #e6edf3">log_fn</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">info</span>
                    <span style="color: #e6edf3">log_fn(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Encountered domain with wildcard DNS ({</span><span style="color: #e6edf3">wildcard_rdtypes_str</span><span style="color: #a5d6ff">}): {</span><span style="color: #e6edf3">host</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>

        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">wildcard_domain_results</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">_connectivity_check</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">interval</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">5</span><span style="color: #e6edf3">):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        Periodically checks for an active internet connection by attempting DNS resolution.</span>

<span style="color: #a5d6ff">        Args:</span>
<span style="color: #a5d6ff">            interval (int, optional): The time interval, in seconds, at which to perform the check.</span>
<span style="color: #a5d6ff">            Defaults to 5 seconds.</span>

<span style="color: #a5d6ff">        Returns:</span>
<span style="color: #a5d6ff">            bool: True if there is an active internet connection, False otherwise.</span>

<span style="color: #a5d6ff">        Examples:</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; await _connectivity_check()</span>
<span style="color: #a5d6ff">            True</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_last_dns_success</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">time</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">time()</span> <span style="color: #ff7b72; font-weight: bold">-</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_last_dns_success</span> <span style="color: #ff7b72; font-weight: bold">&lt;</span> <span style="color: #e6edf3">interval:</span>
                <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">True</span>
        <span style="color: #e6edf3">dns_server_working</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>
        <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_dns_connectivity_lock:</span>
            <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">suppress(</span><span style="color: #f0883e; font-weight: bold">Exception</span><span style="color: #e6edf3">):</span>
                <span style="color: #e6edf3">dns_server_working</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_catch(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolver</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolve,</span> <span style="color: #a5d6ff">"www.google.com"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">rdtype</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"A"</span><span style="color: #e6edf3">)</span>
                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">dns_server_working:</span>
                    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_last_dns_success</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">time</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">time()</span>
                    <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">True</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">time</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">time()</span> <span style="color: #ff7b72; font-weight: bold">-</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_last_connectivity_warning</span> <span style="color: #ff7b72; font-weight: bold">&gt;</span> <span style="color: #e6edf3">interval:</span>
            <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">warning(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"DNS queries are failing, please check your internet connection"</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_last_connectivity_warning</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">time</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">time()</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_errors</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">clear()</span>
        <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">False</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">_parse_rdtype</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">t,</span> <span style="color: #e6edf3">default</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">):</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">isinstance(t,</span> <span style="color: #e6edf3">str):</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">t</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">strip()</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">lower()</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">(</span><span style="color: #a5d6ff">"any"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"all"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"*"</span><span style="color: #e6edf3">):</span>
                <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">all_rdtypes</span>
            <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
                <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">[t</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">strip()</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">upper()]</span>
        <span style="color: #ff7b72">elif</span> <span style="color: #e6edf3">any([isinstance(t,</span> <span style="color: #e6edf3">x)</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">x</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">(list,</span> <span style="color: #e6edf3">tuple)]):</span>
            <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">[str(_)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">strip()</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">upper()</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">_</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">t]</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">default</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">debug</span><span style="color: #e6edf3">(self,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_debug:</span>
            <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">_get_dummy_module</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">name):</span>
        <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">dummy_module</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_dummy_modules[name]</span>
        <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">KeyError</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">dummy_module</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_make_dummy_module(name</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">name,</span> <span style="color: #e6edf3">_type</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"DNS"</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_dummy_modules[name]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">dummy_module</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">dummy_module</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">mock_dns</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">dns_dict):</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_orig_resolve_raw</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_orig_resolve_raw</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolve_raw</span>

        <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">mock_resolve_raw</span><span style="color: #e6edf3">(query,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
            <span style="color: #e6edf3">results</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>
            <span style="color: #e6edf3">errors</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>
            <span style="color: #e6edf3">types</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_parse_rdtype(kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"type"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">[</span><span style="color: #a5d6ff">"A"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"AAAA"</span><span style="color: #e6edf3">]))</span>
            <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">t</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">types:</span>
                <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">suppress(</span><span style="color: #f0883e; font-weight: bold">KeyError</span><span style="color: #e6edf3">):</span>
                    <span style="color: #e6edf3">results</span> <span style="color: #ff7b72; font-weight: bold">+=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_mock_table[(query,</span> <span style="color: #e6edf3">t)]</span>
            <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">results,</span> <span style="color: #e6edf3">errors</span>

        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">(query,</span> <span style="color: #e6edf3">rdtype),</span> <span style="color: #e6edf3">answers</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">dns_dict</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items():</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">isinstance(answers,</span> <span style="color: #e6edf3">str):</span>
                <span style="color: #e6edf3">answers</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[answers]</span>
            <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">answer</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">answers:</span>
                <span style="color: #e6edf3">rdata</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">dns</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">rdata</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">from_text(</span><span style="color: #a5d6ff">"IN"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">rdtype,</span> <span style="color: #e6edf3">answer)</span>
                <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
                    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_mock_table[(query,</span> <span style="color: #e6edf3">rdtype)]</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append((rdtype,</span> <span style="color: #e6edf3">rdata))</span>
                <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">KeyError</span><span style="color: #e6edf3">:</span>
                    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_mock_table[(query,</span> <span style="color: #e6edf3">rdtype)]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[(rdtype,</span> <span style="color: #e6edf3">[rdata])]</span>

        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolve_raw</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">mock_resolve_raw</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="bbot.core.helpers.dns.DNSHelper.resolve">
<span class="doc doc-object-name doc-function-name">resolve</span>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-async"><code>async</code></small>
</span>
</h2>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">resolve(query,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Resolve DNS names and IP addresses to their corresponding results.</p>
<p>This is a high-level function that can translate a given domain name to its associated IP addresses
or an IP address to its corresponding domain names. It's structured for ease of use within modules
and will abstract away most of the complexity of DNS resolution, returning a simple set of results.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>query</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>The domain name or IP address to resolve.</p>
</div>
</li>
<li class="field-body">
<b><code>**kwargs</code></b>
        –
        <div class="doc-md-description">
<p>Additional arguments to be passed to the resolution process.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>set</code></b>        –
        <div class="doc-md-description">
<p>A set containing resolved domain names or IP addresses.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">results</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">resolve(</span><span style="color: #a5d6ff">"1.2.3.4"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">{"evilcorp.com"}</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">results</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">resolve(</span><span style="color: #a5d6ff">"evilcorp.com"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">{"1.2.3.4", "dead::beef"}</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/dns.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">146</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">147</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">148</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">149</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">150</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">151</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">152</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">153</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">154</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">155</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">156</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">157</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">158</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">159</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">160</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">161</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">162</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">163</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">164</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">165</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">166</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">167</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">168</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">169</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">170</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">171</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">172</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">173</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">174</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">175</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">176</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">177</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">178</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">179</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">180</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">181</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">182</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">resolve</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">query,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Resolve DNS names and IP addresses to their corresponding results.</span>

<span style="color: #a5d6ff">    This is a high-level function that can translate a given domain name to its associated IP addresses</span>
<span style="color: #a5d6ff">    or an IP address to its corresponding domain names. It's structured for ease of use within modules</span>
<span style="color: #a5d6ff">    and will abstract away most of the complexity of DNS resolution, returning a simple set of results.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        query (str): The domain name or IP address to resolve.</span>
<span style="color: #a5d6ff">        **kwargs: Additional arguments to be passed to the resolution process.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        set: A set containing resolved domain names or IP addresses.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; results = await resolve("1.2.3.4")</span>
<span style="color: #a5d6ff">        {"evilcorp.com"}</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; results = await resolve("evilcorp.com")</span>
<span style="color: #a5d6ff">        {"1.2.3.4", "dead::beef"}</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">results</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">set()</span>
    <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">r</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolve_raw(query,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">r:</span>
            <span style="color: #e6edf3">raw_results,</span> <span style="color: #e6edf3">errors</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">r</span>
            <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">rdtype,</span> <span style="color: #e6edf3">answers</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">raw_results:</span>
                <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">answer</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">answers:</span>
                    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">_,</span> <span style="color: #e6edf3">t</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">extract_targets(answer):</span>
                        <span style="color: #e6edf3">results</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">add(t)</span>
    <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">BaseException</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">trace(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Caught exception in resolve({</span><span style="color: #e6edf3">query</span><span style="color: #a5d6ff">}, {</span><span style="color: #e6edf3">kwargs</span><span style="color: #a5d6ff">}):"</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">trace(traceback</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">format_exc())</span>
        <span style="color: #ff7b72">raise</span>

    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Results for {</span><span style="color: #e6edf3">query</span><span style="color: #a5d6ff">} with kwargs={</span><span style="color: #e6edf3">kwargs</span><span style="color: #a5d6ff">}: {</span><span style="color: #e6edf3">results</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">results</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="bbot.core.helpers.dns.DNSHelper.resolve_batch">
<span class="doc doc-object-name doc-function-name">resolve_batch</span>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-async"><code>async</code></small>
</span>
</h2>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">resolve_batch(queries,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Asynchronously resolves a batch of queries in parallel and yields the results as they are completed.</p>
<p>This method wraps around <code>_resolve_batch_coro_wrapper</code> to resolve a list of queries in parallel.
It batches the queries to a manageable size and executes them asynchronously, respecting
global rate limits.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>queries</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#list">list</a></code>)
        –
        <div class="doc-md-description">
<p>List of queries to resolve.</p>
</div>
</li>
<li class="field-body">
<b><code>**kwargs</code></b>
        –
        <div class="doc-md-description">
<p>Additional keyword arguments to pass to <code>_resolve_batch_coro_wrapper</code>.</p>
</div>
</li>
</ul>
<p>Yields:</p>
<ul>
<li class="field-body">
<b><code>tuple</code></b>        –
        <div class="doc-md-description">
<p>A tuple containing the original query and its resolved value.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #ff7b72">import</span> <span style="color: #ff7b72">asyncio</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">example_usage</span><span style="color: #e6edf3">():</span>
<span style="color: #8b949e">... </span>    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">result</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">resolve_batch([</span><span style="color: #a5d6ff">'www.evilcorp.com'</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">'evilcorp.com'</span><span style="color: #e6edf3">]):</span>
<span style="color: #8b949e">... </span>        <span style="color: #e6edf3">print(result)</span>
<span style="color: #8b949e">('www.evilcorp.com', {'1.1.1.1'})</span>
<span style="color: #8b949e">('evilcorp.com', {'2.2.2.2'})</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/dns.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">634</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">635</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">636</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">637</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">638</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">639</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">640</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">641</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">642</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">643</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">644</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">645</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">646</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">647</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">648</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">649</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">650</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">651</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">652</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">653</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">654</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">655</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">656</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">657</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">658</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">659</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">660</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">661</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">662</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">663</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">664</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">resolve_batch</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">queries,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Asynchronously resolves a batch of queries in parallel and yields the results as they are completed.</span>

<span style="color: #a5d6ff">    This method wraps around `_resolve_batch_coro_wrapper` to resolve a list of queries in parallel.</span>
<span style="color: #a5d6ff">    It batches the queries to a manageable size and executes them asynchronously, respecting</span>
<span style="color: #a5d6ff">    global rate limits.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        queries (list): List of queries to resolve.</span>
<span style="color: #a5d6ff">        **kwargs: Additional keyword arguments to pass to `_resolve_batch_coro_wrapper`.</span>

<span style="color: #a5d6ff">    Yields:</span>
<span style="color: #a5d6ff">        tuple: A tuple containing the original query and its resolved value.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; import asyncio</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; async def example_usage():</span>
<span style="color: #a5d6ff">        ...     async for result in resolve_batch(['www.evilcorp.com', 'evilcorp.com']):</span>
<span style="color: #a5d6ff">        ...         print(result)</span>
<span style="color: #a5d6ff">        ('www.evilcorp.com', {'1.1.1.1'})</span>
<span style="color: #a5d6ff">        ('evilcorp.com', {'2.2.2.2'})</span>

<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">queries</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">list(queries)</span>
    <span style="color: #e6edf3">batch_size</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">250</span>
    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">i</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">range(</span><span style="color: #a5d6ff">0</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">len(queries),</span> <span style="color: #e6edf3">batch_size):</span>
        <span style="color: #e6edf3">batch</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">queries[i</span> <span style="color: #e6edf3">:</span> <span style="color: #e6edf3">i</span> <span style="color: #ff7b72; font-weight: bold">+</span> <span style="color: #e6edf3">batch_size]</span>
        <span style="color: #e6edf3">tasks</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_resolve_batch_coro_wrapper(q,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">q</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">batch]</span>
        <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">task</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">as_completed(tasks):</span>
            <span style="color: #ff7b72">yield</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">task</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="bbot.core.helpers.dns.DNSHelper.resolve_raw">
<span class="doc doc-object-name doc-function-name">resolve_raw</span>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-async"><code>async</code></small>
</span>
</h2>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">resolve_raw(query,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Resolves the given query to its associated DNS records.</p>
<p>This function is a foundational method for DNS resolution in this class. It understands both IP addresses and
hostnames and returns their associated records in a raw format provided by the dnspython library.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>query</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>The IP address or hostname to resolve.</p>
</div>
</li>
<li class="field-body">
<b><code>type</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a> or <a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a>]</code>)
        –
        <div class="doc-md-description">
<p>Specifies the DNS record type(s) to fetch. Can be a single type like 'A'
or a list like ['A', 'AAAA']. If set to 'any', 'all', or '*', it fetches all supported types. If not
specified, the function defaults to fetching 'A' and 'AAAA' records.</p>
</div>
</li>
<li class="field-body">
<b><code>**kwargs</code></b>
        –
        <div class="doc-md-description">
<p>Additional arguments that might be passed to the resolver.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>tuple</code></b>        –
        <div class="doc-md-description">
<p>A tuple containing two lists:
- list: A list of tuples where each tuple consists of a record type string (like 'A') and the associated
  raw dnspython answer.
- list: A list of tuples where each tuple consists of a record type string and the associated error if
  there was an issue fetching the record.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #ff7b72">await</span> <span style="color: #e6edf3">resolve_raw(</span><span style="color: #a5d6ff">"8.8.8.8"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">([('PTR', &lt;dns.resolver.Answer object at 0x7f4a47cdb1d0&gt;)], [])</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #ff7b72">await</span> <span style="color: #e6edf3">resolve_raw(</span><span style="color: #a5d6ff">"dns.google"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">([('A', &lt;dns.resolver.Answer object at 0x7f4a47ce46d0&gt;), ('AAAA', &lt;dns.resolver.Answer object at 0x7f4a47ce4710&gt;)], [])</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/dns.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">184</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">185</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">186</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">187</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">188</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">189</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">190</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">191</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">192</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">193</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">194</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">195</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">196</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">197</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">198</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">199</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">200</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">201</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">202</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">203</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">204</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">205</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">206</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">207</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">208</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">209</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">210</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">211</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">212</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">213</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">214</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">215</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">216</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">217</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">218</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">219</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">220</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">221</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">222</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">223</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">224</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">225</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">226</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">227</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">228</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">229</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">230</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">231</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">232</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">233</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">234</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">235</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">236</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">237</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">238</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">239</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">240</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">resolve_raw</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">query,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Resolves the given query to its associated DNS records.</span>

<span style="color: #a5d6ff">    This function is a foundational method for DNS resolution in this class. It understands both IP addresses and</span>
<span style="color: #a5d6ff">    hostnames and returns their associated records in a raw format provided by the dnspython library.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        query (str): The IP address or hostname to resolve.</span>
<span style="color: #a5d6ff">        type (str or list[str], optional): Specifies the DNS record type(s) to fetch. Can be a single type like 'A'</span>
<span style="color: #a5d6ff">            or a list like ['A', 'AAAA']. If set to 'any', 'all', or '*', it fetches all supported types. If not</span>
<span style="color: #a5d6ff">            specified, the function defaults to fetching 'A' and 'AAAA' records.</span>
<span style="color: #a5d6ff">        **kwargs: Additional arguments that might be passed to the resolver.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        tuple: A tuple containing two lists:</span>
<span style="color: #a5d6ff">            - list: A list of tuples where each tuple consists of a record type string (like 'A') and the associated</span>
<span style="color: #a5d6ff">              raw dnspython answer.</span>
<span style="color: #a5d6ff">            - list: A list of tuples where each tuple consists of a record type string and the associated error if</span>
<span style="color: #a5d6ff">              there was an issue fetching the record.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; await resolve_raw("8.8.8.8")</span>
<span style="color: #a5d6ff">        ([('PTR', &lt;dns.resolver.Answer object at 0x7f4a47cdb1d0&gt;)], [])</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; await resolve_raw("dns.google")</span>
<span style="color: #a5d6ff">        ([('A', &lt;dns.resolver.Answer object at 0x7f4a47ce46d0&gt;), ('AAAA', &lt;dns.resolver.Answer object at 0x7f4a47ce4710&gt;)], [])</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #8b949e; font-style: italic"># DNS over TCP is more reliable</span>
    <span style="color: #8b949e; font-style: italic"># But setting this breaks DNS resolution on Ubuntu because systemd-resolve doesn't support TCP</span>
    <span style="color: #8b949e; font-style: italic"># kwargs["tcp"] = True</span>
    <span style="color: #e6edf3">results</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>
    <span style="color: #e6edf3">errors</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>
    <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">query</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">str(query)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">strip()</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">is_ip(query):</span>
            <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">pop(</span><span style="color: #a5d6ff">"type"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">pop(</span><span style="color: #a5d6ff">"rdtype"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">results,</span> <span style="color: #e6edf3">errors</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_resolve_ip(query,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
            <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">[(</span><span style="color: #a5d6ff">"PTR"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">results)],</span> <span style="color: #e6edf3">[(</span><span style="color: #a5d6ff">"PTR"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">e)</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">e</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">errors]</span>
        <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">types</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[</span><span style="color: #a5d6ff">"A"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"AAAA"</span><span style="color: #e6edf3">]</span>
            <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">pop(</span><span style="color: #a5d6ff">"rdtype"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
            <span style="color: #ff7b72">if</span> <span style="color: #a5d6ff">"type"</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">kwargs:</span>
                <span style="color: #e6edf3">t</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">pop(</span><span style="color: #a5d6ff">"type"</span><span style="color: #e6edf3">)</span>
                <span style="color: #e6edf3">types</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_parse_rdtype(t,</span> <span style="color: #e6edf3">default</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">types)</span>
            <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">t</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">types:</span>
                <span style="color: #e6edf3">r,</span> <span style="color: #e6edf3">e</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_resolve_hostname(query,</span> <span style="color: #e6edf3">rdtype</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">t,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">r:</span>
                    <span style="color: #e6edf3">results</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append((t,</span> <span style="color: #e6edf3">r))</span>
                <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">error</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">e:</span>
                    <span style="color: #e6edf3">errors</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append((t,</span> <span style="color: #e6edf3">error))</span>
    <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">BaseException</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">trace(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Caught exception in resolve_raw({</span><span style="color: #e6edf3">query</span><span style="color: #a5d6ff">}, {</span><span style="color: #e6edf3">kwargs</span><span style="color: #a5d6ff">}):"</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">trace(traceback</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">format_exc())</span>
        <span style="color: #ff7b72">raise</span>

    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">(results,</span> <span style="color: #e6edf3">errors)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="bbot.core.helpers.dns.DNSHelper.is_wildcard">
<span class="doc doc-object-name doc-function-name">is_wildcard</span>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-async"><code>async</code></small>
</span>
</h2>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">is_wildcard(query,</span> <span style="color: #e6edf3">ips</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">rdtype</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Use this method to check whether a <em>host</em> is a wildcard entry</p>
<p>This can reliably tell the difference between a valid DNS record and a wildcard within a wildcard domain.</p>
<p>If you want to know whether a domain is using wildcard DNS, use <code>is_wildcard_domain()</code> instead.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>query</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>The hostname to check for a wildcard entry.</p>
</div>
</li>
<li class="field-body">
<b><code>ips</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#list">list</a></code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
<p>List of IPs to compare against, typically obtained from a previous DNS resolution of the query.</p>
</div>
</li>
<li class="field-body">
<b><code>rdtype</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
<p>The DNS record type (e.g., "A", "AAAA") to consider during the check.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>dict</code></b>        –
        <div class="doc-md-description">
<p>A dictionary indicating if the query is a wildcard for each checked DNS record type.
Keys are DNS record types like "A", "AAAA", etc.
Values are tuples where the first element is a boolean indicating if the query is a wildcard,
and the second element is the wildcard parent if it's a wildcard.</p>
</div>
</li>
</ul>
<p>Raises:</p>
<ul>
<li class="field-body">
<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/exceptions.html#ValueError">ValueError</a></code>
          –
        <div class="doc-md-description">
<p>If only one of <code>ips</code> or <code>rdtype</code> is specified or if no valid IPs are specified.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">is_wildcard(</span><span style="color: #a5d6ff">"www.github.io"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">{"A": (True, "github.io"), "AAAA": (True, "github.io")}</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">is_wildcard(</span><span style="color: #a5d6ff">"www.evilcorp.com"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">ips</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">[</span><span style="color: #a5d6ff">"93.184.216.34"</span><span style="color: #e6edf3">],</span> <span style="color: #e6edf3">rdtype</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"A"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">{"A": (False, "evilcorp.com")}</span>
</code></pre></div>
<details class="note" open="">
<summary>Note</summary>
<p><code>is_wildcard</code> can be True, False, or None (indicating that wildcard detection was inconclusive)</p>
</details>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/dns.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">774</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">775</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">776</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">777</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">778</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">779</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">780</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">781</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">782</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">783</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">784</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">785</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">786</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">787</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">788</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">789</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">790</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">791</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">792</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">793</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">794</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">795</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">796</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">797</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">798</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">799</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">800</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">801</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">802</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">803</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">804</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">805</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">806</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">807</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">808</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">809</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">810</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">811</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">812</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">813</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">814</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">815</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">816</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">817</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">818</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">819</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">820</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">821</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">822</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">823</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">824</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">825</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">826</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">827</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">828</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">829</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">830</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">831</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">832</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">833</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">834</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">835</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">836</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">837</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">838</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">839</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">840</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">841</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">842</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">843</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">844</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">845</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">846</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">847</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">848</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">849</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">850</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">851</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">852</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">853</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">854</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">855</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">856</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">857</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">858</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">859</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">860</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">861</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">862</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">863</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">864</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">865</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">866</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">867</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">868</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">869</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">870</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">871</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">872</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">873</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">874</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">875</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">876</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">877</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">878</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">879</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">880</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">881</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">882</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">883</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">884</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">885</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">886</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">887</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">888</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">889</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">890</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">891</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">892</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">893</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">894</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">895</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">896</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">897</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">898</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">899</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">900</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">is_wildcard</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">query,</span> <span style="color: #e6edf3">ips</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">rdtype</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Use this method to check whether a *host* is a wildcard entry</span>

<span style="color: #a5d6ff">    This can reliably tell the difference between a valid DNS record and a wildcard within a wildcard domain.</span>

<span style="color: #a5d6ff">    If you want to know whether a domain is using wildcard DNS, use `is_wildcard_domain()` instead.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        query (str): The hostname to check for a wildcard entry.</span>
<span style="color: #a5d6ff">        ips (list, optional): List of IPs to compare against, typically obtained from a previous DNS resolution of the query.</span>
<span style="color: #a5d6ff">        rdtype (str, optional): The DNS record type (e.g., "A", "AAAA") to consider during the check.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        dict: A dictionary indicating if the query is a wildcard for each checked DNS record type.</span>
<span style="color: #a5d6ff">            Keys are DNS record types like "A", "AAAA", etc.</span>
<span style="color: #a5d6ff">            Values are tuples where the first element is a boolean indicating if the query is a wildcard,</span>
<span style="color: #a5d6ff">            and the second element is the wildcard parent if it's a wildcard.</span>

<span style="color: #a5d6ff">    Raises:</span>
<span style="color: #a5d6ff">        ValueError: If only one of `ips` or `rdtype` is specified or if no valid IPs are specified.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; is_wildcard("www.github.io")</span>
<span style="color: #a5d6ff">        {"A": (True, "github.io"), "AAAA": (True, "github.io")}</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; is_wildcard("www.evilcorp.com", ips=["93.184.216.34"], rdtype="A")</span>
<span style="color: #a5d6ff">        {"A": (False, "evilcorp.com")}</span>

<span style="color: #a5d6ff">    Note:</span>
<span style="color: #a5d6ff">        `is_wildcard` can be True, False, or None (indicating that wildcard detection was inconclusive)</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">result</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{}</span>

    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">[ips,</span> <span style="color: #e6edf3">rdtype]</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">count(</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">raise</span> <span style="color: #f0883e; font-weight: bold">ValueError</span><span style="color: #e6edf3">(</span><span style="color: #a5d6ff">"Both ips and rdtype must be specified"</span><span style="color: #e6edf3">)</span>

    <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">is_dns_name(query):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">{}</span>

    <span style="color: #8b949e; font-style: italic"># skip check if the query's parent domain is excluded in the config</span>
    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">d</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">wildcard_ignore:</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">host_in_host(query,</span> <span style="color: #e6edf3">d):</span>
            <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Skipping wildcard detection on {</span><span style="color: #e6edf3">query</span><span style="color: #a5d6ff">} because it is excluded in the config"</span><span style="color: #e6edf3">)</span>
            <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">{}</span>

    <span style="color: #e6edf3">query</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_clean_dns_record(query)</span>
    <span style="color: #8b949e; font-style: italic"># skip check if it's an IP</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">is_ip(query)</span> <span style="color: #ff7b72; font-weight: bold">or</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #a5d6ff">"."</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">query:</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">{}</span>
    <span style="color: #8b949e; font-style: italic"># skip check if the query is a domain</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">is_domain(query):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">{}</span>

    <span style="color: #e6edf3">parent</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">parent_domain(query)</span>
    <span style="color: #e6edf3">parents</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">list(domain_parents(query))</span>

    <span style="color: #e6edf3">rdtypes_to_check</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[rdtype]</span> <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">rdtype</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #79c0ff">None</span> <span style="color: #ff7b72">else</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">all_rdtypes</span>

    <span style="color: #e6edf3">base_query_ips</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">dict()</span>
    <span style="color: #8b949e; font-style: italic"># if the caller hasn't already done the work of resolving the IPs</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">ips</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
        <span style="color: #8b949e; font-style: italic"># then resolve the query for all rdtypes</span>
        <span style="color: #e6edf3">base_query_tasks</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{</span>
            <span style="color: #e6edf3">t:</span> <span style="color: #e6edf3">asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">create_task(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolve_raw(query,</span> <span style="color: #e6edf3">type</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">t,</span> <span style="color: #e6edf3">use_cache</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">))</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">t</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">rdtypes_to_check</span>
        <span style="color: #e6edf3">}</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">_rdtype,</span> <span style="color: #e6edf3">task</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">base_query_tasks</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items():</span>
            <span style="color: #e6edf3">raw_results,</span> <span style="color: #e6edf3">errors</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">task</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">errors</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">raw_results:</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Failed to resolve {</span><span style="color: #e6edf3">query</span><span style="color: #a5d6ff">} ({</span><span style="color: #e6edf3">_rdtype</span><span style="color: #a5d6ff">}) during wildcard detection"</span><span style="color: #e6edf3">)</span>
                <span style="color: #e6edf3">result[_rdtype]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">(</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">parent)</span>
                <span style="color: #ff7b72">continue</span>
            <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">__rdtype,</span> <span style="color: #e6edf3">answers</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">raw_results:</span>
                <span style="color: #e6edf3">base_query_results</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">set()</span>
                <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">answer</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">answers:</span>
                    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">_,</span> <span style="color: #e6edf3">t</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">extract_targets(answer):</span>
                        <span style="color: #e6edf3">base_query_results</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">add(t)</span>
                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">base_query_results:</span>
                    <span style="color: #e6edf3">base_query_ips[__rdtype]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">base_query_results</span>
    <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
        <span style="color: #8b949e; font-style: italic"># otherwise, we can skip all that</span>
        <span style="color: #e6edf3">cleaned_ips</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">set([self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_clean_dns_record(ip)</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">ip</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">ips])</span>
        <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">cleaned_ips:</span>
            <span style="color: #ff7b72">raise</span> <span style="color: #f0883e; font-weight: bold">ValueError</span><span style="color: #e6edf3">(</span><span style="color: #a5d6ff">"Valid IPs must be specified"</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">base_query_ips[rdtype]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">cleaned_ips</span>
    <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">base_query_ips:</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">result</span>

    <span style="color: #8b949e; font-style: italic"># once we've resolved the base query and have IP addresses to work with</span>
    <span style="color: #8b949e; font-style: italic"># we can compare the IPs to the ones we have on file for wildcards</span>

    <span style="color: #8b949e; font-style: italic"># for every parent domain, starting with the shortest</span>
    <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">host</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">parents[::</span><span style="color: #ff7b72; font-weight: bold">-</span><span style="color: #a5d6ff">1</span><span style="color: #e6edf3">]:</span>
            <span style="color: #8b949e; font-style: italic"># for every rdtype</span>
            <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">_rdtype</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">list(base_query_ips):</span>
                <span style="color: #8b949e; font-style: italic"># get the IPs from above</span>
                <span style="color: #e6edf3">query_ips</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">base_query_ips</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(_rdtype,</span> <span style="color: #e6edf3">set())</span>
                <span style="color: #8b949e; font-style: italic"># make sure we've checked that domain for wildcards</span>
                <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">is_wildcard_domain(host)</span>
                <span style="color: #e6edf3">host_hash</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">hash(host)</span>

                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">host_hash</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_wildcard_cache:</span>
                    <span style="color: #8b949e; font-style: italic"># then get its IPs from our wildcard cache</span>
                    <span style="color: #e6edf3">wildcard_rdtypes</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_wildcard_cache[host_hash]</span>

                    <span style="color: #8b949e; font-style: italic"># then check to see if our IPs match the wildcard ones</span>
                    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">_rdtype</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">wildcard_rdtypes:</span>
                        <span style="color: #e6edf3">wildcard_ips</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">wildcard_rdtypes[_rdtype]</span>
                        <span style="color: #8b949e; font-style: italic"># if our IPs match the wildcard ones, then ladies and gentlemen we have a wildcard</span>
                        <span style="color: #e6edf3">is_wildcard</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">any(r</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">wildcard_ips</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">r</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">query_ips)</span>

                        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">is_wildcard</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">result</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(_rdtype,</span> <span style="color: #e6edf3">(</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">))[</span><span style="color: #a5d6ff">0</span><span style="color: #e6edf3">]</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">True</span><span style="color: #e6edf3">:</span>
                            <span style="color: #e6edf3">result[_rdtype]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">(</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">host)</span>

                <span style="color: #8b949e; font-style: italic"># if we've reached a point where the dns name is a complete wildcard, class can be dismissed early</span>
                <span style="color: #e6edf3">base_query_rdtypes</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">set(base_query_ips)</span>
                <span style="color: #e6edf3">wildcard_rdtypes_set</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">set([k</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">k,</span> <span style="color: #e6edf3">v</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">result</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items()</span> <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">v[</span><span style="color: #a5d6ff">0</span><span style="color: #e6edf3">]</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">True</span><span style="color: #e6edf3">])</span>
                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">base_query_rdtypes</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #e6edf3">wildcard_rdtypes_set</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #e6edf3">base_query_rdtypes</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #e6edf3">wildcard_rdtypes_set:</span>
                    <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span>
                        <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Breaking from wildcard detection for {</span><span style="color: #e6edf3">query</span><span style="color: #a5d6ff">} at {</span><span style="color: #e6edf3">host</span><span style="color: #a5d6ff">} because base query rdtypes ({</span><span style="color: #e6edf3">base_query_rdtypes</span><span style="color: #a5d6ff">}) == wildcard rdtypes ({</span><span style="color: #e6edf3">wildcard_rdtypes_set</span><span style="color: #a5d6ff">})"</span>
                    <span style="color: #e6edf3">)</span>
                    <span style="color: #ff7b72">raise</span> <span style="color: #e6edf3">DNSWildcardBreak()</span>
    <span style="color: #ff7b72">except</span> <span style="color: #e6edf3">DNSWildcardBreak:</span>
        <span style="color: #ff7b72">pass</span>

    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">result</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="bbot.core.helpers.dns.DNSHelper.is_wildcard_domain">
<span class="doc doc-object-name doc-function-name">is_wildcard_domain</span>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-async"><code>async</code></small>
</span>
</h2>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">is_wildcard_domain(domain,</span> <span style="color: #e6edf3">log_info</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">False</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Check whether a given host or its children make use of wildcard DNS entries. Wildcard DNS can have
various implications, particularly in subdomain enumeration and subdomain takeovers.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>domain</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>The domain to check for wildcard DNS entries.</p>
</div>
</li>
<li class="field-body">
<b><code>log_info</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#bool">bool</a></code>, default:
                <code>False</code>
)
        –
        <div class="doc-md-description">
<p>Whether to log the result of the check. Defaults to False.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>dict</code></b>        –
        <div class="doc-md-description">
<p>A dictionary where the keys are the parent domains that have wildcard DNS entries,</p>
</div>
</li>
<li class="field-body">
        –
        <div class="doc-md-description">
<p>and the values are another dictionary of DNS record types ("A", "AAAA", etc.) mapped to</p>
</div>
</li>
<li class="field-body">
        –
        <div class="doc-md-description">
<p>sets of their resolved IP addresses.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">is_wildcard_domain(</span><span style="color: #a5d6ff">"github.io"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">{"github.io": {"A": {"1.2.3.4"}, "AAAA": {"dead::beef"}}}</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">is_wildcard_domain(</span><span style="color: #a5d6ff">"example.com"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">{}</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/dns.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">902</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">903</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">904</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">905</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">906</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">907</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">908</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">909</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">910</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">911</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">912</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">913</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">914</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">915</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">916</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">917</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">918</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">919</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">920</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">921</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">922</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">923</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">924</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">925</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">926</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">927</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">928</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">929</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">930</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">931</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">932</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">933</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">934</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">935</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">936</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">937</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">938</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">939</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">940</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">941</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">942</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">943</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">944</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">945</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">946</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">947</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">948</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">949</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">950</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">951</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">952</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">953</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">954</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">955</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">956</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">957</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">958</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">959</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">960</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">961</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">962</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">963</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">964</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">965</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">966</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">967</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">968</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">969</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">970</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">971</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">972</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">973</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">974</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">975</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">976</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">977</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">978</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">979</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">980</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">981</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">982</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">983</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">984</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">985</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">is_wildcard_domain</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">domain,</span> <span style="color: #e6edf3">log_info</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Check whether a given host or its children make use of wildcard DNS entries. Wildcard DNS can have</span>
<span style="color: #a5d6ff">    various implications, particularly in subdomain enumeration and subdomain takeovers.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        domain (str): The domain to check for wildcard DNS entries.</span>
<span style="color: #a5d6ff">        log_info (bool, optional): Whether to log the result of the check. Defaults to False.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        dict: A dictionary where the keys are the parent domains that have wildcard DNS entries,</span>
<span style="color: #a5d6ff">        and the values are another dictionary of DNS record types ("A", "AAAA", etc.) mapped to</span>
<span style="color: #a5d6ff">        sets of their resolved IP addresses.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; is_wildcard_domain("github.io")</span>
<span style="color: #a5d6ff">        {"github.io": {"A": {"1.2.3.4"}, "AAAA": {"dead::beef"}}}</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; is_wildcard_domain("example.com")</span>
<span style="color: #a5d6ff">        {}</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">wildcard_domain_results</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{}</span>
    <span style="color: #e6edf3">domain</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_clean_dns_record(domain)</span>

    <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">is_dns_name(domain):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">{}</span>

    <span style="color: #8b949e; font-style: italic"># skip check if the query's parent domain is excluded in the config</span>
    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">d</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">wildcard_ignore:</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">host_in_host(domain,</span> <span style="color: #e6edf3">d):</span>
            <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Skipping wildcard detection on {</span><span style="color: #e6edf3">domain</span><span style="color: #a5d6ff">} because it is excluded in the config"</span><span style="color: #e6edf3">)</span>
            <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">{}</span>

    <span style="color: #e6edf3">rdtypes_to_check</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">set(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">all_rdtypes)</span>

    <span style="color: #8b949e; font-style: italic"># make a list of its parents</span>
    <span style="color: #e6edf3">parents</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">list(domain_parents(domain,</span> <span style="color: #e6edf3">include_self</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">))</span>
    <span style="color: #8b949e; font-style: italic"># and check each of them, beginning with the highest parent (i.e. the root domain)</span>
    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">i,</span> <span style="color: #e6edf3">host</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">enumerate(parents[::</span><span style="color: #ff7b72; font-weight: bold">-</span><span style="color: #a5d6ff">1</span><span style="color: #e6edf3">]):</span>
        <span style="color: #8b949e; font-style: italic"># have we checked this host before?</span>
        <span style="color: #e6edf3">host_hash</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">hash(host)</span>
        <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_wildcard_lock</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">lock(host_hash):</span>
            <span style="color: #8b949e; font-style: italic"># if we've seen this host before</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">host_hash</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_wildcard_cache:</span>
                <span style="color: #e6edf3">wildcard_domain_results[host]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_wildcard_cache[host_hash]</span>
                <span style="color: #ff7b72">continue</span>

            <span style="color: #8b949e; font-style: italic"># determine if this is a wildcard domain</span>
            <span style="color: #e6edf3">wildcard_tasks</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{t:</span> <span style="color: #e6edf3">[]</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">t</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">rdtypes_to_check}</span>
            <span style="color: #8b949e; font-style: italic"># resolve a bunch of random subdomains of the same parent</span>
            <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">rdtype</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">rdtypes_to_check:</span>
                <span style="color: #8b949e; font-style: italic"># continue if a wildcard was already found for this rdtype</span>
                <span style="color: #8b949e; font-style: italic"># if rdtype in self._wildcard_cache[host_hash]:</span>
                <span style="color: #8b949e; font-style: italic">#     continue</span>
                <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">_</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">range(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">wildcard_tests):</span>
                    <span style="color: #e6edf3">rand_query</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">rand_string(digits</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">,</span><span style="color: #6e7681"> </span><span style="color: #e6edf3">length</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">10</span><span style="color: #e6edf3">)</span><span style="color: #a5d6ff">}.{</span><span style="color: #e6edf3">host</span><span style="color: #a5d6ff">}"</span>
                    <span style="color: #e6edf3">wildcard_tasks[rdtype]</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolve(rand_query,</span> <span style="color: #e6edf3">type</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">rdtype,</span> <span style="color: #e6edf3">use_cache</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">))</span>

            <span style="color: #8b949e; font-style: italic"># combine the random results</span>
            <span style="color: #e6edf3">is_wildcard</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">False</span>
            <span style="color: #e6edf3">wildcard_results</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">dict()</span>
            <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">rdtype,</span> <span style="color: #e6edf3">tasks</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">wildcard_tasks</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items():</span>
                <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">task</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">as_completed(tasks):</span>
                    <span style="color: #e6edf3">results</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">task</span>
                    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">results:</span>
                        <span style="color: #e6edf3">is_wildcard</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">True</span>
                        <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">rdtype</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">wildcard_results:</span>
                            <span style="color: #e6edf3">wildcard_results[rdtype]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">set()</span>
                        <span style="color: #e6edf3">wildcard_results[rdtype]</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">update(results)</span>
                        <span style="color: #8b949e; font-style: italic"># we know this rdtype is a wildcard</span>
                        <span style="color: #8b949e; font-style: italic"># so we don't need to check it anymore</span>
                        <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">suppress(</span><span style="color: #f0883e; font-weight: bold">KeyError</span><span style="color: #e6edf3">):</span>
                            <span style="color: #e6edf3">rdtypes_to_check</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">remove(rdtype)</span>

            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_wildcard_cache</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">update({host_hash:</span> <span style="color: #e6edf3">wildcard_results})</span>
            <span style="color: #e6edf3">wildcard_domain_results</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">update({host:</span> <span style="color: #e6edf3">wildcard_results})</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">is_wildcard:</span>
                <span style="color: #e6edf3">wildcard_rdtypes_str</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">","</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join(sorted([t</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">upper()</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">t,</span> <span style="color: #e6edf3">r</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">wildcard_results</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items()</span> <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">r]))</span>
                <span style="color: #e6edf3">log_fn</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">verbose</span>
                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">log_info:</span>
                    <span style="color: #e6edf3">log_fn</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">info</span>
                <span style="color: #e6edf3">log_fn(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Encountered domain with wildcard DNS ({</span><span style="color: #e6edf3">wildcard_rdtypes_str</span><span style="color: #a5d6ff">}): {</span><span style="color: #e6edf3">host</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>

    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">wildcard_domain_results</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "navigation.sections", "navigation.expand", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../../assets/javascripts/bundle.dff1b7c8.min.js"></script>
<script src="https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js"></script>
<script src="../../../javascripts/tablesort.js"></script>
</body>
</html>