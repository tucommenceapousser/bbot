
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="OSINT automation for hackers" name="description"/>
<meta content="TheTechromancer" name="author"/>
<link href="https://blacklanternsecurity.github.io/bbot/dev/helpers/interactsh/" rel="canonical"/>
<link href="../dns/" rel="prev"/>
<link href="../misc/" rel="next"/>
<link href="../../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.5.3, mkdocs-material-9.3.2" name="generator"/>
<title>Interactsh - BBOT Docs</title>
<link href="../../../assets/stylesheets/main.30068a00.min.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/palette.85d0ee34.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../../../assets/_mkdocstrings.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<link href="../../../assets/stylesheets/extra-style.l__wbna5.min.css" rel="stylesheet"/></head>
<body data-md-color-accent="deep-orange" data-md-color-primary="black" data-md-color-scheme="slate" dir="ltr">
<script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#interactsh">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="BBOT Docs" class="md-header__button md-logo" data-md-component="logo" href="../../.." title="BBOT Docs">
<img alt="logo" src="../../../bbot.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            BBOT Docs
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Interactsh
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-hidden="true" class="md-option" data-md-color-accent="deep-orange" data-md-color-media="" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/>
</form>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/blacklanternsecurity/bbot" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    blacklanternsecurity/bbot
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--integrated" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="BBOT Docs" class="md-nav__button md-logo" data-md-component="logo" href="../../.." title="BBOT Docs">
<img alt="logo" src="../../../bbot.png"/>
</a>
    BBOT Docs
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/blacklanternsecurity/bbot" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    blacklanternsecurity/bbot
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
<span class="md-ellipsis">
    Basics
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_1">
<span class="md-nav__icon md-icon"></span>
            Basics
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../..">
<span class="md-ellipsis">
    Getting Started
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../how_it_works/">
<span class="md-ellipsis">
    How it Works
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../comparison/">
<span class="md-ellipsis">
    Comparison to Other Tools
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
<span class="md-ellipsis">
    Scanning
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            Scanning
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../scanning/">
<span class="md-ellipsis">
    Scanning Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../scanning/events/">
<span class="md-ellipsis">
    Events
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../scanning/output/">
<span class="md-ellipsis">
    Output
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../scanning/tips_and_tricks/">
<span class="md-ellipsis">
    Tips and Tricks
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../scanning/advanced/">
<span class="md-ellipsis">
    Advanced Usage
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../scanning/configuration/">
<span class="md-ellipsis">
    Configuration
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
<span class="md-ellipsis">
    Modules
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            Modules
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../modules/list_of_modules/">
<span class="md-ellipsis">
    List of Modules
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../modules/nuclei/">
<span class="md-ellipsis">
    Nuclei
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
<span class="md-ellipsis">
    Contribution
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            Contribution
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../contribution/">
<span class="md-ellipsis">
    How to Write a Module
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_4_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
<span class="md-ellipsis">
    Developer Reference
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_4_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_2">
<span class="md-nav__icon md-icon"></span>
            Developer Reference
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../scanner/">
<span class="md-ellipsis">
    Scanner
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../event/">
<span class="md-ellipsis">
    Event
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../target/">
<span class="md-ellipsis">
    Target
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../basemodule/">
<span class="md-ellipsis">
    BaseModule
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_4_2_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_2_6" id="__nav_4_2_6_label" tabindex="0">
<span class="md-ellipsis">
    Helpers
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_4_2_6_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_4_2_6">
<span class="md-nav__icon md-icon"></span>
            Helpers
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../command/">
<span class="md-ellipsis">
    Command
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../dns/">
<span class="md-ellipsis">
    DNS
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Interactsh
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../misc/">
<span class="md-ellipsis">
    Miscellaneous
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../web/">
<span class="md-ellipsis">
    Web
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../wordcloud/">
<span class="md-ellipsis">
    Word Cloud
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
<span class="md-ellipsis">
    Misc
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            Misc
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../release_history/">
<span class="md-ellipsis">
    Release History
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../troubleshooting/">
<span class="md-ellipsis">
    Troubleshooting
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="interactsh">Interact.sh</h1>
<div class="doc doc-object doc-class">
<div class="doc doc-contents first">
<p>A pure python implementation of ProjectDiscovery's interact.sh.</p>
<p><em>"Interactsh is an open-source tool for detecting out-of-band interactions. It is a tool designed to detect vulnerabilities that cause external interactions."</em></p>
<ul>
<li>https://app.interactsh.com</li>
<li>https://github.com/projectdiscovery/interactsh</li>
</ul>
<p>This class facilitates interactions with the interact.sh service for
out-of-band data exfiltration and vulnerability confirmation. It allows
for customization by accepting server and token parameters from the
configuration provided by <code>parent_helper</code>.</p>
<p>Attributes:</p>
<ul>
<li class="field-body">
<b><code>parent_helper</code></b>
            (<code>ConfigAwareHelper</code>)
        –
        <div class="doc-md-description">
<p>An instance of a helper class containing configuration data.</p>
</div>
</li>
<li class="field-body">
<b><code>server</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>The server to be used. If None (the default), a random server will be chosen from a predetermined list.</p>
</div>
</li>
<li class="field-body">
<b><code>correlation_id</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>An identifier to correlate requests and responses. Default is None.</p>
</div>
</li>
<li class="field-body">
<b><code>custom_server</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>Optional. A custom interact.sh server. Loaded from configuration.</p>
</div>
</li>
<li class="field-body">
<b><code>token</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>Optional. A token for interact.sh API. Loaded from configuration.</p>
</div>
</li>
<li class="field-body">
<b><code>_poll_task</code></b>
            (<code>AsyncTask</code>)
        –
        <div class="doc-md-description">
<p>The task responsible for polling the interact.sh server.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e; font-style: italic"># instantiate interact.sh client (no requests are sent yet)</span>
<span style="color: #ff7b72; font-weight: bold">&gt;&gt;&gt;</span> <span style="color: #e6edf3">interactsh_client</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">interactsh()</span>
<span style="color: #8b949e; font-style: italic"># register with an interact.sh server</span>
<span style="color: #ff7b72; font-weight: bold">&gt;&gt;&gt;</span> <span style="color: #e6edf3">interactsh_domain</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">interactsh_client</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">register()</span>
<span style="color: #e6edf3">[INFO]</span> <span style="color: #e6edf3">Registering</span> <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">interact</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">sh</span> <span style="color: #e6edf3">server:</span> <span style="color: #e6edf3">oast</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">me</span>
<span style="color: #e6edf3">[INFO]</span> <span style="color: #e6edf3">Successfully</span> <span style="color: #e6edf3">registered</span> <span style="color: #e6edf3">to</span> <span style="color: #e6edf3">interactsh</span> <span style="color: #e6edf3">server</span> <span style="color: #e6edf3">oast</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">me</span> <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">correlation_id</span> <span style="color: #e6edf3">rg99x2f860h5466ou3so</span> <span style="color: #e6edf3">[rg99x2f860h5466ou3so86i07n1m3013k</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">oast</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">me]</span>
<span style="color: #8b949e; font-style: italic"># simulate an out-of-band interaction</span>
<span style="color: #ff7b72; font-weight: bold">&gt;&gt;&gt;</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">request(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"https://{</span><span style="color: #e6edf3">interactsh_domain</span><span style="color: #a5d6ff">}/test"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e; font-style: italic"># wait for out-of-band interaction to be registered</span>
<span style="color: #ff7b72; font-weight: bold">&gt;&gt;&gt;</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">sleep(</span><span style="color: #a5d6ff">10</span><span style="color: #e6edf3">)</span>
<span style="color: #ff7b72; font-weight: bold">&gt;&gt;&gt;</span> <span style="color: #e6edf3">data_list</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">interactsh_client</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">poll()</span>
<span style="color: #ff7b72; font-weight: bold">&gt;&gt;&gt;</span> <span style="color: #e6edf3">print(data_list)</span>
<span style="color: #e6edf3">[</span>
    <span style="color: #e6edf3">{</span>
        <span style="color: #a5d6ff">"protocol"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">"dns"</span><span style="color: #e6edf3">,</span>
        <span style="color: #a5d6ff">"unique-id"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">"rg99x2f860h5466ou3so86i07n1m3013k"</span><span style="color: #e6edf3">,</span>
        <span style="color: #a5d6ff">"full-id"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">"rg99x2f860h5466ou3so86i07n1m3013k"</span><span style="color: #e6edf3">,</span>
        <span style="color: #a5d6ff">"q-type"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">"A"</span><span style="color: #e6edf3">,</span>
        <span style="color: #a5d6ff">"raw-request"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">"..."</span><span style="color: #e6edf3">,</span>
        <span style="color: #a5d6ff">"remote-address"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">"1.2.3.4"</span><span style="color: #e6edf3">,</span>
        <span style="color: #a5d6ff">"timestamp"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">"2023-09-15T21:09:23.187226851Z"</span>
    <span style="color: #e6edf3">},</span>
    <span style="color: #e6edf3">{</span>
        <span style="color: #a5d6ff">"protocol"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">"http"</span><span style="color: #e6edf3">,</span>
        <span style="color: #a5d6ff">"unique-id"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">"rg99x2f860h5466ou3so86i07n1m3013k"</span><span style="color: #e6edf3">,</span>
        <span style="color: #a5d6ff">"full-id"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">"rg99x2f860h5466ou3so86i07n1m3013k"</span><span style="color: #e6edf3">,</span>
        <span style="color: #a5d6ff">"raw-request"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">"GET /test HTTP/1.1 ..."</span><span style="color: #e6edf3">,</span>
        <span style="color: #a5d6ff">"remote-address"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">"1.2.3.4"</span><span style="color: #e6edf3">,</span>
        <span style="color: #a5d6ff">"timestamp"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">"2023-09-15T21:09:24.155677967Z"</span>
    <span style="color: #e6edf3">}</span>
<span style="color: #e6edf3">]</span>
<span style="color: #8b949e; font-style: italic"># finally, shut down the client</span>
<span style="color: #ff7b72; font-weight: bold">&gt;&gt;&gt;</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">interactsh_client</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">deregister()</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/interactsh.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 21</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 22</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 23</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 24</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 25</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 26</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 27</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 28</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 29</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 30</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 31</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 32</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 33</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 34</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 35</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 36</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 37</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 38</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 39</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 40</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 41</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 42</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 43</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 44</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 45</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 46</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 47</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 48</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 49</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 50</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 51</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 52</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 53</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 54</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 55</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 56</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 57</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 58</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 59</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 60</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 61</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 62</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 63</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 64</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 65</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 66</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 67</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 68</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 69</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 70</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 71</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 72</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 73</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 74</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 75</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 76</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 77</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 78</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 79</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 80</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 81</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 82</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 83</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 84</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 85</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 86</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 87</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 88</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 89</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 90</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 91</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 92</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 93</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 94</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 95</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 96</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 97</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 98</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 99</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">100</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">101</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">102</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">103</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">104</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">105</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">106</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">107</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">108</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">109</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">110</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">111</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">112</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">113</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">114</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">115</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">116</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">117</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">118</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">119</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">120</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">121</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">122</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">123</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">124</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">125</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">126</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">127</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">128</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">129</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">130</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">131</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">132</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">133</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">134</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">135</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">136</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">137</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">138</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">139</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">140</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">141</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">142</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">143</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">144</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">145</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">146</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">147</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">148</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">149</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">150</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">151</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">152</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">153</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">154</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">155</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">156</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">157</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">158</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">159</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">160</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">161</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">162</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">163</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">164</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">165</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">166</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">167</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">168</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">169</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">170</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">171</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">172</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">173</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">174</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">175</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">176</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">177</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">178</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">179</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">180</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">181</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">182</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">183</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">184</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">185</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">186</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">187</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">188</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">189</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">190</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">191</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">192</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">193</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">194</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">195</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">196</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">197</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">198</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">199</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">200</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">201</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">202</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">203</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">204</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">205</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">206</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">207</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">208</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">209</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">210</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">211</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">212</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">213</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">214</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">215</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">216</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">217</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">218</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">219</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">220</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">221</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">222</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">223</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">224</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">225</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">226</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">227</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">228</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">229</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">230</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">231</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">232</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">233</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">234</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">235</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">236</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">237</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">238</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">239</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">240</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">241</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">242</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">243</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">244</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">245</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">246</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">247</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">248</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">249</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">250</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">251</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">252</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">253</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">254</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">255</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">256</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">257</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">258</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">259</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">260</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">261</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">262</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">263</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">264</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">265</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">266</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">267</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">268</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">269</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">270</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">271</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">272</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">273</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">274</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">275</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">276</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">277</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">278</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">279</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">280</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">281</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">282</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">283</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">284</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">285</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">286</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">287</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">288</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">289</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">290</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">291</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">292</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">293</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">294</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">295</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">296</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">297</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">298</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">299</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">300</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">301</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">302</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">303</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">304</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">305</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">306</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">307</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">308</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">309</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">310</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">class</span> <span style="color: #f0883e; font-weight: bold">Interactsh</span><span style="color: #e6edf3">:</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    A pure python implementation of ProjectDiscovery's interact.sh.</span>

<span style="color: #a5d6ff">    *"Interactsh is an open-source tool for detecting out-of-band interactions. It is a tool designed to detect vulnerabilities that cause external interactions."*</span>

<span style="color: #a5d6ff">    - https://app.interactsh.com</span>
<span style="color: #a5d6ff">    - https://github.com/projectdiscovery/interactsh</span>

<span style="color: #a5d6ff">    This class facilitates interactions with the interact.sh service for</span>
<span style="color: #a5d6ff">    out-of-band data exfiltration and vulnerability confirmation. It allows</span>
<span style="color: #a5d6ff">    for customization by accepting server and token parameters from the</span>
<span style="color: #a5d6ff">    configuration provided by `parent_helper`.</span>

<span style="color: #a5d6ff">    Attributes:</span>
<span style="color: #a5d6ff">        parent_helper (ConfigAwareHelper): An instance of a helper class containing configuration data.</span>
<span style="color: #a5d6ff">        server (str): The server to be used. If None (the default), a random server will be chosen from a predetermined list.</span>
<span style="color: #a5d6ff">        correlation_id (str): An identifier to correlate requests and responses. Default is None.</span>
<span style="color: #a5d6ff">        custom_server (str): Optional. A custom interact.sh server. Loaded from configuration.</span>
<span style="color: #a5d6ff">        token (str): Optional. A token for interact.sh API. Loaded from configuration.</span>
<span style="color: #a5d6ff">        _poll_task (AsyncTask): The task responsible for polling the interact.sh server.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        ```python</span>
<span style="color: #a5d6ff">        # instantiate interact.sh client (no requests are sent yet)</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; interactsh_client = self.helpers.interactsh()</span>
<span style="color: #a5d6ff">        # register with an interact.sh server</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; interactsh_domain = await interactsh_client.register()</span>
<span style="color: #a5d6ff">        [INFO] Registering with interact.sh server: oast.me</span>
<span style="color: #a5d6ff">        [INFO] Successfully registered to interactsh server oast.me with correlation_id rg99x2f860h5466ou3so [rg99x2f860h5466ou3so86i07n1m3013k.oast.me]</span>
<span style="color: #a5d6ff">        # simulate an out-of-band interaction</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; await self.helpers.request(f"https://{interactsh_domain}/test")</span>
<span style="color: #a5d6ff">        # wait for out-of-band interaction to be registered</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; await asyncio.sleep(10)</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; data_list = await interactsh_client.poll()</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; print(data_list)</span>
<span style="color: #a5d6ff">        [</span>
<span style="color: #a5d6ff">            {</span>
<span style="color: #a5d6ff">                "protocol": "dns",</span>
<span style="color: #a5d6ff">                "unique-id": "rg99x2f860h5466ou3so86i07n1m3013k",</span>
<span style="color: #a5d6ff">                "full-id": "rg99x2f860h5466ou3so86i07n1m3013k",</span>
<span style="color: #a5d6ff">                "q-type": "A",</span>
<span style="color: #a5d6ff">                "raw-request": "...",</span>
<span style="color: #a5d6ff">                "remote-address": "1.2.3.4",</span>
<span style="color: #a5d6ff">                "timestamp": "2023-09-15T21:09:23.187226851Z"</span>
<span style="color: #a5d6ff">            },</span>
<span style="color: #a5d6ff">            {</span>
<span style="color: #a5d6ff">                "protocol": "http",</span>
<span style="color: #a5d6ff">                "unique-id": "rg99x2f860h5466ou3so86i07n1m3013k",</span>
<span style="color: #a5d6ff">                "full-id": "rg99x2f860h5466ou3so86i07n1m3013k",</span>
<span style="color: #a5d6ff">                "raw-request": "GET /test HTTP/1.1 ...",</span>
<span style="color: #a5d6ff">                "remote-address": "1.2.3.4",</span>
<span style="color: #a5d6ff">                "timestamp": "2023-09-15T21:09:24.155677967Z"</span>
<span style="color: #a5d6ff">            }</span>
<span style="color: #a5d6ff">        ]</span>
<span style="color: #a5d6ff">        # finally, shut down the client</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; await interactsh_client.deregister()</span>
<span style="color: #a5d6ff">        ```</span>
<span style="color: #a5d6ff">    """</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">__init__</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">parent_helper):</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">parent_helper</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">server</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">correlation_id</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">custom_server</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"interactsh_server"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">token</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"interactsh_token"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_poll_task</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">register</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">callback</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        Registers the instance with an interact.sh server and sets up polling.</span>

<span style="color: #a5d6ff">        Generates RSA keys for secure communication, builds a correlation ID,</span>
<span style="color: #a5d6ff">        and sends a POST request to an interact.sh server to register. Optionally,</span>
<span style="color: #a5d6ff">        starts an asynchronous polling task to listen for interactions.</span>

<span style="color: #a5d6ff">        Args:</span>
<span style="color: #a5d6ff">            callback (callable, optional): A function to be called each time new interactions are received.</span>

<span style="color: #a5d6ff">        Returns:</span>
<span style="color: #a5d6ff">            str: The registered domain for out-of-band interactions.</span>

<span style="color: #a5d6ff">        Raises:</span>
<span style="color: #a5d6ff">            InteractshError: If registration with an interact.sh server fails.</span>

<span style="color: #a5d6ff">        Examples:</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; interactsh_client = self.helpers.interactsh()</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; registered_domain = await interactsh_client.register()</span>
<span style="color: #a5d6ff">            [INFO] Registering with interact.sh server: oast.me</span>
<span style="color: #a5d6ff">            [INFO] Successfully registered to interactsh server oast.me with correlation_id rg99x2f860h5466ou3so [rg99x2f860h5466ou3so86i07n1m3013k.oast.me]</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #e6edf3">rsa</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">RSA</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">generate(</span><span style="color: #a5d6ff">1024</span><span style="color: #e6edf3">)</span>

        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">public_key</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">rsa</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">publickey()</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">exportKey()</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">private_key</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">rsa</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">exportKey()</span>

        <span style="color: #e6edf3">encoded_public_key</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">base64</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">b64encode(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">public_key)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">decode(</span><span style="color: #a5d6ff">"utf8"</span><span style="color: #e6edf3">)</span>

        <span style="color: #e6edf3">uuid</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">uuid4()</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">hex</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">ljust(</span><span style="color: #a5d6ff">33</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"a"</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">guid</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">""</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join(i</span> <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">i</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">isdigit()</span> <span style="color: #ff7b72">else</span> <span style="color: #e6edf3">chr(ord(i)</span> <span style="color: #ff7b72; font-weight: bold">+</span> <span style="color: #e6edf3">random</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">randint(</span><span style="color: #a5d6ff">0</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">20</span><span style="color: #e6edf3">))</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">i</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">uuid)</span>

        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">correlation_id</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">guid[:</span><span style="color: #a5d6ff">20</span><span style="color: #e6edf3">]</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">secret</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">str(uuid4())</span>
        <span style="color: #e6edf3">headers</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{}</span>

        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">custom_server:</span>
            <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">token:</span>
                <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">verbose(</span><span style="color: #a5d6ff">"Interact.sh token is not set"</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">headers[</span><span style="color: #a5d6ff">"Authorization"</span><span style="color: #e6edf3">]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">token</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">server_list</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">custom_server]</span>
        <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">server_list</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">random</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">sample(server_list,</span> <span style="color: #e6edf3">k</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">len(server_list))</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">server</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">server_list:</span>
            <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">info(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Registering with interact.sh server: {</span><span style="color: #e6edf3">server</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">data</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{</span>
                <span style="color: #a5d6ff">"public-key"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">encoded_public_key,</span>
                <span style="color: #a5d6ff">"secret-key"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">secret,</span>
                <span style="color: #a5d6ff">"correlation-id"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">correlation_id,</span>
            <span style="color: #e6edf3">}</span>
            <span style="color: #e6edf3">r</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">request(</span>
                <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"https://{</span><span style="color: #e6edf3">server</span><span style="color: #a5d6ff">}/register"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">headers</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">headers,</span> <span style="color: #e6edf3">json</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">data,</span> <span style="color: #e6edf3">method</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"POST"</span>
            <span style="color: #e6edf3">)</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">r</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
                <span style="color: #ff7b72">continue</span>
            <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">msg</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">r</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">json()</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"message"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">""</span><span style="color: #e6edf3">)</span>
                <span style="color: #ff7b72">assert</span> <span style="color: #a5d6ff">"registration successful"</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">msg</span>
            <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">Exception</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Failed to register with interactsh server {</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">server</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
                <span style="color: #ff7b72">continue</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">server</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">server</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">domain</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">guid</span><span style="color: #a5d6ff">}.{</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">server</span><span style="color: #a5d6ff">}"</span>
            <span style="color: #ff7b72">break</span>

        <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">server:</span>
            <span style="color: #ff7b72">raise</span> <span style="color: #e6edf3">InteractshError(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Failed to register with an interactsh server"</span><span style="color: #e6edf3">)</span>

        <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">info(</span>
            <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Successfully registered to interactsh server {</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">server</span><span style="color: #a5d6ff">} with correlation_id {</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">correlation_id</span><span style="color: #a5d6ff">} [{</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">domain</span><span style="color: #a5d6ff">}]"</span>
        <span style="color: #e6edf3">)</span>

        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">callable(callback):</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_poll_task</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">create_task(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">poll_loop(callback))</span>

        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">domain</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">deregister</span><span style="color: #e6edf3">(self):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        Deregisters the instance from the interact.sh server and cancels the polling task.</span>

<span style="color: #a5d6ff">        Sends a POST request to the server to deregister, using the correlation ID</span>
<span style="color: #a5d6ff">        and secret key generated during registration. Optionally, if a polling</span>
<span style="color: #a5d6ff">        task was started, it is cancelled.</span>

<span style="color: #a5d6ff">        Raises:</span>
<span style="color: #a5d6ff">            InteractshError: If required information is missing or if deregistration fails.</span>

<span style="color: #a5d6ff">        Examples:</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; await interactsh_client.deregister()</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">server</span> <span style="color: #ff7b72; font-weight: bold">or</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">correlation_id</span> <span style="color: #ff7b72; font-weight: bold">or</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">secret:</span>
            <span style="color: #ff7b72">raise</span> <span style="color: #e6edf3">InteractshError(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Missing required information to deregister"</span><span style="color: #e6edf3">)</span>

        <span style="color: #e6edf3">headers</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{}</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">token:</span>
            <span style="color: #e6edf3">headers[</span><span style="color: #a5d6ff">"Authorization"</span><span style="color: #e6edf3">]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">token</span>

        <span style="color: #e6edf3">data</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{</span><span style="color: #a5d6ff">"secret-key"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">secret,</span> <span style="color: #a5d6ff">"correlation-id"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">correlation_id}</span>

        <span style="color: #e6edf3">r</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">request(</span>
            <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"https://{</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">server</span><span style="color: #a5d6ff">}/deregister"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">headers</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">headers,</span> <span style="color: #e6edf3">json</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">data,</span> <span style="color: #e6edf3">method</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"POST"</span>
        <span style="color: #e6edf3">)</span>

        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_poll_task</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_poll_task</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">cancel()</span>

        <span style="color: #ff7b72">if</span> <span style="color: #a5d6ff">"success"</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">getattr(r,</span> <span style="color: #a5d6ff">"text"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">""</span><span style="color: #e6edf3">):</span>
            <span style="color: #ff7b72">raise</span> <span style="color: #e6edf3">InteractshError(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Failed to de-register with interactsh server {</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">server</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">poll</span><span style="color: #e6edf3">(self):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        Polls the interact.sh server for interactions tied to the current instance.</span>

<span style="color: #a5d6ff">        Sends a GET request to the server to fetch interactions associated with the</span>
<span style="color: #a5d6ff">        current correlation_id and secret key. Returned interactions are decrypted</span>
<span style="color: #a5d6ff">        using an AES key provided by the server response.</span>

<span style="color: #a5d6ff">        Raises:</span>
<span style="color: #a5d6ff">            InteractshError: If required information for polling is missing.</span>

<span style="color: #a5d6ff">        Returns:</span>
<span style="color: #a5d6ff">            list: A list of decrypted interaction data dictionaries.</span>

<span style="color: #a5d6ff">        Examples:</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; data_list = await interactsh_client.poll()</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; print(data_list)</span>
<span style="color: #a5d6ff">            [</span>
<span style="color: #a5d6ff">                {</span>
<span style="color: #a5d6ff">                    "protocol": "dns",</span>
<span style="color: #a5d6ff">                    "unique-id": "rg99x2f860h5466ou3so86i07n1m3013k",</span>
<span style="color: #a5d6ff">                    ...</span>
<span style="color: #a5d6ff">                },</span>
<span style="color: #a5d6ff">                ...</span>
<span style="color: #a5d6ff">            ]</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">server</span> <span style="color: #ff7b72; font-weight: bold">or</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">correlation_id</span> <span style="color: #ff7b72; font-weight: bold">or</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">secret:</span>
            <span style="color: #ff7b72">raise</span> <span style="color: #e6edf3">InteractshError(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Missing required information to poll"</span><span style="color: #e6edf3">)</span>

        <span style="color: #e6edf3">headers</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{}</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">token:</span>
            <span style="color: #e6edf3">headers[</span><span style="color: #a5d6ff">"Authorization"</span><span style="color: #e6edf3">]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">token</span>

        <span style="color: #e6edf3">r</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">request(</span>
            <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"https://{</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">server</span><span style="color: #a5d6ff">}/poll?id={</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">correlation_id</span><span style="color: #a5d6ff">}&amp;secret={</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">secret</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">headers</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">headers</span>
        <span style="color: #e6edf3">)</span>

        <span style="color: #e6edf3">ret</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>
        <span style="color: #e6edf3">data_list</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">r</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">json()</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"data"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">data_list:</span>
            <span style="color: #e6edf3">aes_key</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">r</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">json()[</span><span style="color: #a5d6ff">"aes_key"</span><span style="color: #e6edf3">]</span>

            <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">data</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">data_list:</span>
                <span style="color: #e6edf3">decrypted_data</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_decrypt(aes_key,</span> <span style="color: #e6edf3">data)</span>
                <span style="color: #e6edf3">ret</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(decrypted_data)</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">ret</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">poll_loop</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">callback):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        Starts a polling loop to continuously check for interactions with the interact.sh server.</span>

<span style="color: #a5d6ff">        Continuously polls the interact.sh server for interactions tied to the current instance,</span>
<span style="color: #a5d6ff">        using the `poll` method. When interactions are received, it executes the given callback</span>
<span style="color: #a5d6ff">        function with each interaction data.</span>

<span style="color: #a5d6ff">        Parameters:</span>
<span style="color: #a5d6ff">            callback (callable): The function to be called for every interaction received from the server.</span>

<span style="color: #a5d6ff">        Returns:</span>
<span style="color: #a5d6ff">            awaitable: An awaitable object that executes the internal `_poll_loop` method.</span>

<span style="color: #a5d6ff">        Examples:</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; await interactsh_client.poll_loop(my_callback)</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">scan</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_acatch(context</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_poll_loop):</span>
            <span style="color: #ff7b72">return</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_poll_loop(callback)</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">_poll_loop</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">callback):</span>
        <span style="color: #ff7b72">while</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">scan</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">stopping:</span>
                <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">sleep(</span><span style="color: #a5d6ff">1</span><span style="color: #e6edf3">)</span>
                <span style="color: #ff7b72">continue</span>
            <span style="color: #e6edf3">data_list</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>
            <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">data_list</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">poll()</span>
            <span style="color: #ff7b72">except</span> <span style="color: #e6edf3">InteractshError</span> <span style="color: #ff7b72">as</span> <span style="color: #e6edf3">e:</span>
                <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">warning(e)</span>
                <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">trace(traceback</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">format_exc())</span>
            <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">data_list:</span>
                <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">sleep(</span><span style="color: #a5d6ff">10</span><span style="color: #e6edf3">)</span>
                <span style="color: #ff7b72">continue</span>
            <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">data</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">data_list:</span>
                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">data:</span>
                    <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">execute_sync_or_async(callback,</span> <span style="color: #e6edf3">data)</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">_decrypt</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">aes_key,</span> <span style="color: #e6edf3">data):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        Decrypts and returns the data received from the interact.sh server.</span>

<span style="color: #a5d6ff">        Uses RSA and AES for decrypting the data. RSA with PKCS1_OAEP and SHA256 is used to decrypt the AES key,</span>
<span style="color: #a5d6ff">        and then AES (CFB mode) is used to decrypt the actual data payload.</span>

<span style="color: #a5d6ff">        Parameters:</span>
<span style="color: #a5d6ff">            aes_key (str): The AES key for decryption, encrypted with RSA and base64 encoded.</span>
<span style="color: #a5d6ff">            data (str): The data payload to decrypt, which is base64 encoded and AES encrypted.</span>

<span style="color: #a5d6ff">        Returns:</span>
<span style="color: #a5d6ff">            dict: The decrypted data, loaded as a JSON object.</span>

<span style="color: #a5d6ff">        Examples:</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; decrypted_data = self._decrypt(aes_key, data)</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #e6edf3">private_key</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">RSA</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">importKey(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">private_key)</span>
        <span style="color: #e6edf3">cipher</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">PKCS1_OAEP</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">new(private_key,</span> <span style="color: #e6edf3">hashAlgo</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">SHA256)</span>
        <span style="color: #e6edf3">aes_plain_key</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">cipher</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">decrypt(base64</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">b64decode(aes_key))</span>
        <span style="color: #e6edf3">decode</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">base64</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">b64decode(data)</span>
        <span style="color: #e6edf3">bs</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">AES</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">block_size</span>
        <span style="color: #e6edf3">iv</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">decode[:bs]</span>
        <span style="color: #e6edf3">cryptor</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">AES</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">new(key</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">aes_plain_key,</span> <span style="color: #e6edf3">mode</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">AES</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">MODE_CFB,</span> <span style="color: #e6edf3">IV</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">iv,</span> <span style="color: #e6edf3">segment_size</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">128</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">plain_text</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">cryptor</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">decrypt(decode)</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">json</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">loads(plain_text[</span><span style="color: #a5d6ff">16</span><span style="color: #e6edf3">:])</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.interactsh.Interactsh.deregister">
<span class="doc doc-object-name doc-function-name">deregister</span>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-async"><code>async</code></small>
</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">deregister()</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Deregisters the instance from the interact.sh server and cancels the polling task.</p>
<p>Sends a POST request to the server to deregister, using the correlation ID
and secret key generated during registration. Optionally, if a polling
task was started, it is cancelled.</p>
<p>Raises:</p>
<ul>
<li class="field-body">
<code><span title="bbot.core.errors.InteractshError">InteractshError</span></code>
          –
        <div class="doc-md-description">
<p>If required information is missing or if deregistration fails.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #ff7b72">await</span> <span style="color: #e6edf3">interactsh_client</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">deregister()</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/interactsh.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">167</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">168</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">169</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">170</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">171</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">172</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">173</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">174</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">175</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">176</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">177</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">178</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">179</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">180</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">181</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">182</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">183</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">184</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">185</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">186</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">187</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">188</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">189</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">190</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">191</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">192</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">193</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">194</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">195</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">196</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">197</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">198</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">deregister</span><span style="color: #e6edf3">(self):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Deregisters the instance from the interact.sh server and cancels the polling task.</span>

<span style="color: #a5d6ff">    Sends a POST request to the server to deregister, using the correlation ID</span>
<span style="color: #a5d6ff">    and secret key generated during registration. Optionally, if a polling</span>
<span style="color: #a5d6ff">    task was started, it is cancelled.</span>

<span style="color: #a5d6ff">    Raises:</span>
<span style="color: #a5d6ff">        InteractshError: If required information is missing or if deregistration fails.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; await interactsh_client.deregister()</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">server</span> <span style="color: #ff7b72; font-weight: bold">or</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">correlation_id</span> <span style="color: #ff7b72; font-weight: bold">or</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">secret:</span>
        <span style="color: #ff7b72">raise</span> <span style="color: #e6edf3">InteractshError(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Missing required information to deregister"</span><span style="color: #e6edf3">)</span>

    <span style="color: #e6edf3">headers</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{}</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">token:</span>
        <span style="color: #e6edf3">headers[</span><span style="color: #a5d6ff">"Authorization"</span><span style="color: #e6edf3">]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">token</span>

    <span style="color: #e6edf3">data</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{</span><span style="color: #a5d6ff">"secret-key"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">secret,</span> <span style="color: #a5d6ff">"correlation-id"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">correlation_id}</span>

    <span style="color: #e6edf3">r</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">request(</span>
        <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"https://{</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">server</span><span style="color: #a5d6ff">}/deregister"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">headers</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">headers,</span> <span style="color: #e6edf3">json</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">data,</span> <span style="color: #e6edf3">method</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"POST"</span>
    <span style="color: #e6edf3">)</span>

    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_poll_task</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_poll_task</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">cancel()</span>

    <span style="color: #ff7b72">if</span> <span style="color: #a5d6ff">"success"</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">getattr(r,</span> <span style="color: #a5d6ff">"text"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">""</span><span style="color: #e6edf3">):</span>
        <span style="color: #ff7b72">raise</span> <span style="color: #e6edf3">InteractshError(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Failed to de-register with interactsh server {</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">server</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.interactsh.Interactsh.poll">
<span class="doc doc-object-name doc-function-name">poll</span>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-async"><code>async</code></small>
</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">poll()</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Polls the interact.sh server for interactions tied to the current instance.</p>
<p>Sends a GET request to the server to fetch interactions associated with the
current correlation_id and secret key. Returned interactions are decrypted
using an AES key provided by the server response.</p>
<p>Raises:</p>
<ul>
<li class="field-body">
<code><span title="bbot.core.errors.InteractshError">InteractshError</span></code>
          –
        <div class="doc-md-description">
<p>If required information for polling is missing.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>list</code></b>        –
        <div class="doc-md-description">
<p>A list of decrypted interaction data dictionaries.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">data_list</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">interactsh_client</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">poll()</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">print(data_list)</span>
<span style="color: #8b949e">[</span>
<span style="color: #8b949e">    {</span>
<span style="color: #8b949e">        "protocol": "dns",</span>
<span style="color: #8b949e">        "unique-id": "rg99x2f860h5466ou3so86i07n1m3013k",</span>
<span style="color: #8b949e">        ...</span>
<span style="color: #8b949e">    },</span>
<span style="color: #8b949e">    ...</span>
<span style="color: #8b949e">]</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/interactsh.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">200</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">201</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">202</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">203</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">204</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">205</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">206</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">207</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">208</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">209</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">210</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">211</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">212</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">213</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">214</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">215</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">216</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">217</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">218</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">219</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">220</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">221</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">222</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">223</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">224</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">225</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">226</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">227</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">228</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">229</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">230</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">231</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">232</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">233</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">234</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">235</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">236</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">237</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">238</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">239</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">240</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">241</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">242</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">243</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">244</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">245</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">poll</span><span style="color: #e6edf3">(self):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Polls the interact.sh server for interactions tied to the current instance.</span>

<span style="color: #a5d6ff">    Sends a GET request to the server to fetch interactions associated with the</span>
<span style="color: #a5d6ff">    current correlation_id and secret key. Returned interactions are decrypted</span>
<span style="color: #a5d6ff">    using an AES key provided by the server response.</span>

<span style="color: #a5d6ff">    Raises:</span>
<span style="color: #a5d6ff">        InteractshError: If required information for polling is missing.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        list: A list of decrypted interaction data dictionaries.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; data_list = await interactsh_client.poll()</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; print(data_list)</span>
<span style="color: #a5d6ff">        [</span>
<span style="color: #a5d6ff">            {</span>
<span style="color: #a5d6ff">                "protocol": "dns",</span>
<span style="color: #a5d6ff">                "unique-id": "rg99x2f860h5466ou3so86i07n1m3013k",</span>
<span style="color: #a5d6ff">                ...</span>
<span style="color: #a5d6ff">            },</span>
<span style="color: #a5d6ff">            ...</span>
<span style="color: #a5d6ff">        ]</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">server</span> <span style="color: #ff7b72; font-weight: bold">or</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">correlation_id</span> <span style="color: #ff7b72; font-weight: bold">or</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">secret:</span>
        <span style="color: #ff7b72">raise</span> <span style="color: #e6edf3">InteractshError(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Missing required information to poll"</span><span style="color: #e6edf3">)</span>

    <span style="color: #e6edf3">headers</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{}</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">token:</span>
        <span style="color: #e6edf3">headers[</span><span style="color: #a5d6ff">"Authorization"</span><span style="color: #e6edf3">]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">token</span>

    <span style="color: #e6edf3">r</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">request(</span>
        <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"https://{</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">server</span><span style="color: #a5d6ff">}/poll?id={</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">correlation_id</span><span style="color: #a5d6ff">}&amp;secret={</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">secret</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">headers</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">headers</span>
    <span style="color: #e6edf3">)</span>

    <span style="color: #e6edf3">ret</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>
    <span style="color: #e6edf3">data_list</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">r</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">json()</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"data"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">data_list:</span>
        <span style="color: #e6edf3">aes_key</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">r</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">json()[</span><span style="color: #a5d6ff">"aes_key"</span><span style="color: #e6edf3">]</span>

        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">data</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">data_list:</span>
            <span style="color: #e6edf3">decrypted_data</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_decrypt(aes_key,</span> <span style="color: #e6edf3">data)</span>
            <span style="color: #e6edf3">ret</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(decrypted_data)</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">ret</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.interactsh.Interactsh.poll_loop">
<span class="doc doc-object-name doc-function-name">poll_loop</span>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-async"><code>async</code></small>
</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">poll_loop(callback)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Starts a polling loop to continuously check for interactions with the interact.sh server.</p>
<p>Continuously polls the interact.sh server for interactions tied to the current instance,
using the <code>poll</code> method. When interactions are received, it executes the given callback
function with each interaction data.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>callback</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#callable">callable</a></code>)
        –
        <div class="doc-md-description">
<p>The function to be called for every interaction received from the server.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>awaitable</code></b>        –
        <div class="doc-md-description">
<p>An awaitable object that executes the internal <code>_poll_loop</code> method.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #ff7b72">await</span> <span style="color: #e6edf3">interactsh_client</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">poll_loop(my_callback)</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/interactsh.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">247</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">248</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">249</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">250</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">251</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">252</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">253</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">254</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">255</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">256</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">257</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">258</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">259</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">260</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">261</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">262</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">263</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">264</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">265</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">poll_loop</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">callback):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Starts a polling loop to continuously check for interactions with the interact.sh server.</span>

<span style="color: #a5d6ff">    Continuously polls the interact.sh server for interactions tied to the current instance,</span>
<span style="color: #a5d6ff">    using the `poll` method. When interactions are received, it executes the given callback</span>
<span style="color: #a5d6ff">    function with each interaction data.</span>

<span style="color: #a5d6ff">    Parameters:</span>
<span style="color: #a5d6ff">        callback (callable): The function to be called for every interaction received from the server.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        awaitable: An awaitable object that executes the internal `_poll_loop` method.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; await interactsh_client.poll_loop(my_callback)</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">scan</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_acatch(context</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_poll_loop):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_poll_loop(callback)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.interactsh.Interactsh.register">
<span class="doc doc-object-name doc-function-name">register</span>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-async"><code>async</code></small>
</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">register(callback</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Registers the instance with an interact.sh server and sets up polling.</p>
<p>Generates RSA keys for secure communication, builds a correlation ID,
and sends a POST request to an interact.sh server to register. Optionally,
starts an asynchronous polling task to listen for interactions.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>callback</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#callable">callable</a></code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
<p>A function to be called each time new interactions are received.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>str</code></b>        –
        <div class="doc-md-description">
<p>The registered domain for out-of-band interactions.</p>
</div>
</li>
</ul>
<p>Raises:</p>
<ul>
<li class="field-body">
<code><span title="bbot.core.errors.InteractshError">InteractshError</span></code>
          –
        <div class="doc-md-description">
<p>If registration with an interact.sh server fails.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">interactsh_client</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">interactsh()</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">registered_domain</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">interactsh_client</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">register()</span>
<span style="color: #8b949e">[INFO] Registering with interact.sh server: oast.me</span>
<span style="color: #8b949e">[INFO] Successfully registered to interactsh server oast.me with correlation_id rg99x2f860h5466ou3so [rg99x2f860h5466ou3so86i07n1m3013k.oast.me]</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/interactsh.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 89</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 90</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 91</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 92</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 93</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 94</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 95</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 96</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 97</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 98</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 99</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">100</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">101</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">102</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">103</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">104</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">105</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">106</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">107</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">108</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">109</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">110</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">111</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">112</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">113</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">114</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">115</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">116</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">117</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">118</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">119</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">120</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">121</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">122</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">123</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">124</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">125</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">126</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">127</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">128</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">129</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">130</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">131</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">132</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">133</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">134</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">135</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">136</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">137</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">138</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">139</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">140</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">141</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">142</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">143</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">144</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">145</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">146</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">147</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">148</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">149</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">150</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">151</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">152</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">153</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">154</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">155</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">156</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">157</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">158</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">159</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">160</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">161</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">162</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">163</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">164</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">165</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">register</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">callback</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Registers the instance with an interact.sh server and sets up polling.</span>

<span style="color: #a5d6ff">    Generates RSA keys for secure communication, builds a correlation ID,</span>
<span style="color: #a5d6ff">    and sends a POST request to an interact.sh server to register. Optionally,</span>
<span style="color: #a5d6ff">    starts an asynchronous polling task to listen for interactions.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        callback (callable, optional): A function to be called each time new interactions are received.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        str: The registered domain for out-of-band interactions.</span>

<span style="color: #a5d6ff">    Raises:</span>
<span style="color: #a5d6ff">        InteractshError: If registration with an interact.sh server fails.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; interactsh_client = self.helpers.interactsh()</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; registered_domain = await interactsh_client.register()</span>
<span style="color: #a5d6ff">        [INFO] Registering with interact.sh server: oast.me</span>
<span style="color: #a5d6ff">        [INFO] Successfully registered to interactsh server oast.me with correlation_id rg99x2f860h5466ou3so [rg99x2f860h5466ou3so86i07n1m3013k.oast.me]</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">rsa</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">RSA</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">generate(</span><span style="color: #a5d6ff">1024</span><span style="color: #e6edf3">)</span>

    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">public_key</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">rsa</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">publickey()</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">exportKey()</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">private_key</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">rsa</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">exportKey()</span>

    <span style="color: #e6edf3">encoded_public_key</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">base64</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">b64encode(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">public_key)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">decode(</span><span style="color: #a5d6ff">"utf8"</span><span style="color: #e6edf3">)</span>

    <span style="color: #e6edf3">uuid</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">uuid4()</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">hex</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">ljust(</span><span style="color: #a5d6ff">33</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"a"</span><span style="color: #e6edf3">)</span>
    <span style="color: #e6edf3">guid</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">""</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join(i</span> <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">i</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">isdigit()</span> <span style="color: #ff7b72">else</span> <span style="color: #e6edf3">chr(ord(i)</span> <span style="color: #ff7b72; font-weight: bold">+</span> <span style="color: #e6edf3">random</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">randint(</span><span style="color: #a5d6ff">0</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">20</span><span style="color: #e6edf3">))</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">i</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">uuid)</span>

    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">correlation_id</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">guid[:</span><span style="color: #a5d6ff">20</span><span style="color: #e6edf3">]</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">secret</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">str(uuid4())</span>
    <span style="color: #e6edf3">headers</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{}</span>

    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">custom_server:</span>
        <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">token:</span>
            <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">verbose(</span><span style="color: #a5d6ff">"Interact.sh token is not set"</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">headers[</span><span style="color: #a5d6ff">"Authorization"</span><span style="color: #e6edf3">]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">token</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">server_list</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">custom_server]</span>
    <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">server_list</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">random</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">sample(server_list,</span> <span style="color: #e6edf3">k</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">len(server_list))</span>
    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">server</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">server_list:</span>
        <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">info(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Registering with interact.sh server: {</span><span style="color: #e6edf3">server</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">data</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{</span>
            <span style="color: #a5d6ff">"public-key"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">encoded_public_key,</span>
            <span style="color: #a5d6ff">"secret-key"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">secret,</span>
            <span style="color: #a5d6ff">"correlation-id"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">correlation_id,</span>
        <span style="color: #e6edf3">}</span>
        <span style="color: #e6edf3">r</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">request(</span>
            <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"https://{</span><span style="color: #e6edf3">server</span><span style="color: #a5d6ff">}/register"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">headers</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">headers,</span> <span style="color: #e6edf3">json</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">data,</span> <span style="color: #e6edf3">method</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"POST"</span>
        <span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">r</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">continue</span>
        <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">msg</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">r</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">json()</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"message"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">""</span><span style="color: #e6edf3">)</span>
            <span style="color: #ff7b72">assert</span> <span style="color: #a5d6ff">"registration successful"</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">msg</span>
        <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">Exception</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Failed to register with interactsh server {</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">server</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
            <span style="color: #ff7b72">continue</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">server</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">server</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">domain</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">guid</span><span style="color: #a5d6ff">}.{</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">server</span><span style="color: #a5d6ff">}"</span>
        <span style="color: #ff7b72">break</span>

    <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">server:</span>
        <span style="color: #ff7b72">raise</span> <span style="color: #e6edf3">InteractshError(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Failed to register with an interactsh server"</span><span style="color: #e6edf3">)</span>

    <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">info(</span>
        <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Successfully registered to interactsh server {</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">server</span><span style="color: #a5d6ff">} with correlation_id {</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">correlation_id</span><span style="color: #a5d6ff">} [{</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">domain</span><span style="color: #a5d6ff">}]"</span>
    <span style="color: #e6edf3">)</span>

    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">callable(callback):</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_poll_task</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">create_task(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">poll_loop(callback))</span>

    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">domain</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "navigation.sections", "navigation.expand", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../../assets/javascripts/bundle.dff1b7c8.min.js"></script>
<script src="https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js"></script>
<script src="../../../javascripts/tablesort.js"></script>
</body>
</html>