
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="OSINT automation for hackers" name="description"/>
<meta content="TheTechromancer" name="author"/>
<link href="https://blacklanternsecurity.github.io/bbot/dev/helpers/misc/" rel="canonical"/>
<link href="../interactsh/" rel="prev"/>
<link href="../web/" rel="next"/>
<link href="../../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.5.3, mkdocs-material-9.3.2" name="generator"/>
<title>Miscellaneous - BBOT Docs</title>
<link href="../../../assets/stylesheets/main.30068a00.min.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/palette.85d0ee34.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../../../assets/_mkdocstrings.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<link href="../../../assets/stylesheets/extra-style.l__wbna5.min.css" rel="stylesheet"/></head>
<body data-md-color-accent="deep-orange" data-md-color-primary="black" data-md-color-scheme="slate" dir="ltr">
<script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#misc-helpers">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="BBOT Docs" class="md-header__button md-logo" data-md-component="logo" href="../../.." title="BBOT Docs">
<img alt="logo" src="../../../bbot.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            BBOT Docs
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Miscellaneous
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-hidden="true" class="md-option" data-md-color-accent="deep-orange" data-md-color-media="" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/>
</form>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/blacklanternsecurity/bbot" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    blacklanternsecurity/bbot
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--integrated" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="BBOT Docs" class="md-nav__button md-logo" data-md-component="logo" href="../../.." title="BBOT Docs">
<img alt="logo" src="../../../bbot.png"/>
</a>
    BBOT Docs
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/blacklanternsecurity/bbot" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    blacklanternsecurity/bbot
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
<span class="md-ellipsis">
    Basics
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_1">
<span class="md-nav__icon md-icon"></span>
            Basics
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../..">
<span class="md-ellipsis">
    Getting Started
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../how_it_works/">
<span class="md-ellipsis">
    How it Works
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../comparison/">
<span class="md-ellipsis">
    Comparison to Other Tools
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
<span class="md-ellipsis">
    Scanning
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            Scanning
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../scanning/">
<span class="md-ellipsis">
    Scanning Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../scanning/events/">
<span class="md-ellipsis">
    Events
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../scanning/output/">
<span class="md-ellipsis">
    Output
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../scanning/tips_and_tricks/">
<span class="md-ellipsis">
    Tips and Tricks
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../scanning/advanced/">
<span class="md-ellipsis">
    Advanced Usage
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../scanning/configuration/">
<span class="md-ellipsis">
    Configuration
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
<span class="md-ellipsis">
    Modules
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            Modules
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../modules/list_of_modules/">
<span class="md-ellipsis">
    List of Modules
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../modules/nuclei/">
<span class="md-ellipsis">
    Nuclei
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
<span class="md-ellipsis">
    Contribution
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            Contribution
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../contribution/">
<span class="md-ellipsis">
    How to Write a Module
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_4_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
<span class="md-ellipsis">
    Developer Reference
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_4_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_2">
<span class="md-nav__icon md-icon"></span>
            Developer Reference
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../scanner/">
<span class="md-ellipsis">
    Scanner
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../event/">
<span class="md-ellipsis">
    Event
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../target/">
<span class="md-ellipsis">
    Target
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../basemodule/">
<span class="md-ellipsis">
    BaseModule
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_4_2_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_2_6" id="__nav_4_2_6_label" tabindex="0">
<span class="md-ellipsis">
    Helpers
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_4_2_6_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_4_2_6">
<span class="md-nav__icon md-icon"></span>
            Helpers
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../command/">
<span class="md-ellipsis">
    Command
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../dns/">
<span class="md-ellipsis">
    DNS
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../interactsh/">
<span class="md-ellipsis">
    Interactsh
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Miscellaneous
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../web/">
<span class="md-ellipsis">
    Web
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../wordcloud/">
<span class="md-ellipsis">
    Word Cloud
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
<span class="md-ellipsis">
    Misc
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            Misc
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../release_history/">
<span class="md-ellipsis">
    Release History
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../troubleshooting/">
<span class="md-ellipsis">
    Troubleshooting
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="misc-helpers">Misc Helpers</h1>
<p>These are miscellaneous helpers, used throughout BBOT and its modules for simple tasks such as parsing domains, ports, urls, etc.</p>
<div class="doc doc-object doc-module">
<div class="doc doc-contents first">
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.as_completed">
<span class="doc doc-object-name doc-function-name">as_completed</span>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-async"><code>async</code></small>
</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">as_completed(coros)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Async generator that yields completed Tasks as they are completed.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>coros</code></b>
            (<code>iterable</code>)
        –
        <div class="doc-md-description">
<p>An iterable of coroutine objects or asyncio Tasks.</p>
</div>
</li>
</ul>
<p>Yields:</p>
<ul>
<li class="field-body">
        –
        <div class="doc-md-description">
<p>asyncio.Task: A Task object that has completed its execution.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">main</span><span style="color: #e6edf3">():</span>
<span style="color: #8b949e">... </span>    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">task</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">as_completed([coro1(),</span> <span style="color: #e6edf3">coro2(),</span> <span style="color: #e6edf3">coro3()]):</span>
<span style="color: #8b949e">... </span>        <span style="color: #e6edf3">result</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">task</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">result()</span>
<span style="color: #8b949e">... </span>        <span style="color: #e6edf3">print(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">'Task completed with result: {</span><span style="color: #e6edf3">result</span><span style="color: #a5d6ff">}'</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">run(main())</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2546</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2547</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2548</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2549</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2550</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2551</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2552</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2553</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2554</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2555</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2556</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2557</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2558</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2559</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2560</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2561</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2562</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2563</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2564</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2565</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2566</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2567</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2568</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2569</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">as_completed</span><span style="color: #e6edf3">(coros):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Async generator that yields completed Tasks as they are completed.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        coros (iterable): An iterable of coroutine objects or asyncio Tasks.</span>

<span style="color: #a5d6ff">    Yields:</span>
<span style="color: #a5d6ff">        asyncio.Task: A Task object that has completed its execution.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; async def main():</span>
<span style="color: #a5d6ff">        ...     async for task in as_completed([coro1(), coro2(), coro3()]):</span>
<span style="color: #a5d6ff">        ...         result = task.result()</span>
<span style="color: #a5d6ff">        ...         print(f'Task completed with result: {result}')</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; asyncio.run(main())</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">tasks</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{coro</span> <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">isinstance(coro,</span> <span style="color: #e6edf3">asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">Task)</span> <span style="color: #ff7b72">else</span> <span style="color: #e6edf3">asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">create_task(coro):</span> <span style="color: #e6edf3">coro</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">coro</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">coros}</span>
    <span style="color: #ff7b72">while</span> <span style="color: #e6edf3">tasks:</span>
        <span style="color: #e6edf3">done,</span> <span style="color: #e6edf3">_</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">wait(tasks</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">keys(),</span> <span style="color: #e6edf3">return_when</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">FIRST_COMPLETED)</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">task</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">done:</span>
            <span style="color: #e6edf3">tasks</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">pop(task)</span>
            <span style="color: #ff7b72">yield</span> <span style="color: #e6edf3">task</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.backup_file">
<span class="doc doc-object-name doc-function-name">backup_file</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">backup_file(filename,</span> <span style="color: #e6edf3">max_backups</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">10</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Renames a file by appending an iteration number as a backup. Recursively renames
files up to a specified maximum number of backups.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>filename</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a> or <a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3.11/library/pathlib.html#pathlib.Path">Path</a></code>)
        –
        <div class="doc-md-description">
<p>The file to backup.</p>
</div>
</li>
<li class="field-body">
<b><code>max_backups</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a></code>, default:
                <code>10</code>
)
        –
        <div class="doc-md-description">
<p>The maximum number of backups to keep. Defaults to 10.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
        –
        <div class="doc-md-description">
<p>pathlib.Path: The new backup filepath.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">backup_file(</span><span style="color: #a5d6ff">"/tmp/test.txt"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">PosixPath("/tmp/test.0.txt")</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">backup_file(</span><span style="color: #a5d6ff">"/tmp/test.0.txt"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">PosixPath("/tmp/test.1.txt")</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">backup_file(</span><span style="color: #a5d6ff">"/tmp/test.1.txt"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">PosixPath("/tmp/test.2.txt")</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1592</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1593</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1594</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1595</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1596</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1597</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1598</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1599</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1600</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1601</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1602</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1603</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1604</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1605</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1606</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1607</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1608</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1609</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1610</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1611</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1612</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1613</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1614</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1615</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1616</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1617</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1618</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1619</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1620</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1621</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1622</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1623</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1624</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">backup_file</span><span style="color: #e6edf3">(filename,</span> <span style="color: #e6edf3">max_backups</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">10</span><span style="color: #e6edf3">):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Renames a file by appending an iteration number as a backup. Recursively renames</span>
<span style="color: #a5d6ff">    files up to a specified maximum number of backups.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        filename (str or pathlib.Path): The file to backup.</span>
<span style="color: #a5d6ff">        max_backups (int, optional): The maximum number of backups to keep. Defaults to 10.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        pathlib.Path: The new backup filepath.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; backup_file("/tmp/test.txt")</span>
<span style="color: #a5d6ff">        PosixPath("/tmp/test.0.txt")</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; backup_file("/tmp/test.0.txt")</span>
<span style="color: #a5d6ff">        PosixPath("/tmp/test.1.txt")</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; backup_file("/tmp/test.1.txt")</span>
<span style="color: #a5d6ff">        PosixPath("/tmp/test.2.txt")</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">filename</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">Path(filename)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolve()</span>
    <span style="color: #e6edf3">suffixes</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[s</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">strip(</span><span style="color: #a5d6ff">"."</span><span style="color: #e6edf3">)</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">s</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">filename</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">suffixes]</span>
    <span style="color: #e6edf3">iteration</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">1</span>
    <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">suppress(</span><span style="color: #f0883e; font-weight: bold">Exception</span><span style="color: #e6edf3">):</span>
        <span style="color: #e6edf3">iteration</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">min(max_backups</span> <span style="color: #ff7b72; font-weight: bold">-</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">max(</span><span style="color: #a5d6ff">0</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">int(suffixes[</span><span style="color: #a5d6ff">0</span><span style="color: #e6edf3">])))</span> <span style="color: #ff7b72; font-weight: bold">+</span> <span style="color: #a5d6ff">1</span>
        <span style="color: #e6edf3">suffixes</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">suffixes[</span><span style="color: #a5d6ff">1</span><span style="color: #e6edf3">:]</span>
    <span style="color: #e6edf3">stem</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">filename</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">stem</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">split(</span><span style="color: #a5d6ff">"."</span><span style="color: #e6edf3">)[</span><span style="color: #a5d6ff">0</span><span style="color: #e6edf3">]</span>
    <span style="color: #e6edf3">destination</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">filename</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent</span> <span style="color: #ff7b72; font-weight: bold">/</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">stem</span><span style="color: #a5d6ff">}.{</span><span style="color: #e6edf3">iteration</span><span style="color: #a5d6ff">}.{'.'</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join(suffixes)</span><span style="color: #a5d6ff">}"</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">destination</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">exists()</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #e6edf3">iteration</span> <span style="color: #ff7b72; font-weight: bold">&lt;</span> <span style="color: #e6edf3">max_backups:</span>
        <span style="color: #e6edf3">backup_file(destination)</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">filename</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">exists():</span>
        <span style="color: #e6edf3">filename</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">rename(destination)</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">destination</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.bytes_to_human">
<span class="doc doc-object-name doc-function-name">bytes_to_human</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">bytes_to_human(_bytes)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Convert a bytes size to a human-readable string.</p>
<p>This function converts a numeric bytes value into a human-readable string format, complete
with the appropriate unit symbol (B, KB, MB, GB, etc.).</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>_bytes</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a></code>)
        –
        <div class="doc-md-description">
<p>The number of bytes to convert.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>str</code></b>        –
        <div class="doc-md-description">
<p>A string representing the number of bytes in a more readable format, rounded to two
 decimal places.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">bytes_to_human(</span><span style="color: #a5d6ff">1234129384</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">'1.15GB'</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1954</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1955</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1956</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1957</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1958</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1959</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1960</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1961</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1962</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1963</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1964</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1965</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1966</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1967</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1968</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1969</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1970</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1971</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1972</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1973</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1974</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1975</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1976</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1977</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1978</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1979</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1980</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1981</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1982</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1983</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">bytes_to_human</span><span style="color: #e6edf3">(_bytes):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Convert a bytes size to a human-readable string.</span>

<span style="color: #a5d6ff">    This function converts a numeric bytes value into a human-readable string format, complete</span>
<span style="color: #a5d6ff">    with the appropriate unit symbol (B, KB, MB, GB, etc.).</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        _bytes (int): The number of bytes to convert.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        str: A string representing the number of bytes in a more readable format, rounded to two</span>
<span style="color: #a5d6ff">             decimal places.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; bytes_to_human(1234129384)</span>
<span style="color: #a5d6ff">        '1.15GB'</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">sizes</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[</span><span style="color: #a5d6ff">"B"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"KB"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"MB"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"GB"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"TB"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"PB"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"EB"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"ZB"</span><span style="color: #e6edf3">]</span>
    <span style="color: #e6edf3">units</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{}</span>
    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">count,</span> <span style="color: #e6edf3">size</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">enumerate(sizes):</span>
        <span style="color: #e6edf3">units[size]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">pow(</span><span style="color: #a5d6ff">1024</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">count)</span>
    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">size</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">sizes:</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">abs(_bytes)</span> <span style="color: #ff7b72; font-weight: bold">&lt;</span> <span style="color: #a5d6ff">1024.0</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">size</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #e6edf3">sizes[</span><span style="color: #a5d6ff">0</span><span style="color: #e6edf3">]:</span>
                <span style="color: #e6edf3">_bytes</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">str(int(_bytes))</span>
            <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">_bytes</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">_bytes</span><span style="color: #a5d6ff">:.2f}"</span>
            <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">_bytes</span><span style="color: #a5d6ff">}{</span><span style="color: #e6edf3">size</span><span style="color: #a5d6ff">}"</span>
        <span style="color: #e6edf3">_bytes</span> <span style="color: #ff7b72; font-weight: bold">/=</span> <span style="color: #a5d6ff">1024</span>
    <span style="color: #ff7b72">raise</span> <span style="color: #f0883e; font-weight: bold">ValueError</span><span style="color: #e6edf3">(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">'Unable to convert "{</span><span style="color: #e6edf3">_bytes</span><span style="color: #a5d6ff">}" to human filesize'</span><span style="color: #e6edf3">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.can_sudo_without_password">
<span class="doc doc-object-name doc-function-name">can_sudo_without_password</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">can_sudo_without_password()</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Check if the current user has passwordless sudo access.</p>
<p>This function checks whether the current user can use sudo without entering a password.
It runs a command with sudo and checks the return code to determine this.</p>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>bool</code></b>        –
        <div class="doc-md-description">
<p>True if the current user can use sudo without a password, False otherwise.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">can_sudo_without_password()</span>
<span style="color: #8b949e">True</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1821</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1822</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1823</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1824</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1825</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1826</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1827</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1828</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1829</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1830</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1831</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1832</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1833</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1834</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1835</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1836</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1837</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1838</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1839</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1840</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1841</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1842</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">can_sudo_without_password</span><span style="color: #e6edf3">():</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Check if the current user has passwordless sudo access.</span>

<span style="color: #a5d6ff">    This function checks whether the current user can use sudo without entering a password.</span>
<span style="color: #a5d6ff">    It runs a command with sudo and checks the return code to determine this.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        bool: True if the current user can use sudo without a password, False otherwise.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; can_sudo_without_password()</span>
<span style="color: #a5d6ff">        True</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">os</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">geteuid()</span> <span style="color: #ff7b72; font-weight: bold">!=</span> <span style="color: #a5d6ff">0</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">env</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">dict(os</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">environ)</span>
        <span style="color: #e6edf3">env[</span><span style="color: #a5d6ff">"SUDO_ASKPASS"</span><span style="color: #e6edf3">]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">"/bin/false"</span>
        <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">sp</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">run([</span><span style="color: #a5d6ff">"sudo"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"-K"</span><span style="color: #e6edf3">],</span> <span style="color: #e6edf3">stderr</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">sp</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">DEVNULL,</span> <span style="color: #e6edf3">stdout</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">sp</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">DEVNULL,</span> <span style="color: #e6edf3">check</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">env</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">env)</span>
            <span style="color: #e6edf3">sp</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">run([</span><span style="color: #a5d6ff">"sudo"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"-An"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"/bin/true"</span><span style="color: #e6edf3">],</span> <span style="color: #e6edf3">stderr</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">sp</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">DEVNULL,</span> <span style="color: #e6edf3">stdout</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">sp</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">DEVNULL,</span> <span style="color: #e6edf3">check</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">env</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">env)</span>
        <span style="color: #ff7b72">except</span> <span style="color: #e6edf3">sp</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">CalledProcessError:</span>
            <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">False</span>
    <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">True</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.cancel_tasks">
<span class="doc doc-object-name doc-function-name">cancel_tasks</span>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-async"><code>async</code></small>
</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">cancel_tasks(tasks,</span> <span style="color: #e6edf3">ignore_errors</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">True</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Asynchronously cancels a list of asyncio tasks.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>tasks</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#list">list</a>[Task]</code>)
        –
        <div class="doc-md-description">
<p>A list of asyncio Task objects to cancel.</p>
</div>
</li>
<li class="field-body">
<b><code>ignore_errors</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#bool">bool</a></code>, default:
                <code>True</code>
)
        –
        <div class="doc-md-description">
<p>Whether to ignore errors other than asyncio.CancelledError. Defaults to True.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">main</span><span style="color: #e6edf3">():</span>
<span style="color: #8b949e">... </span>    <span style="color: #e6edf3">task1</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">create_task(async_function1())</span>
<span style="color: #8b949e">... </span>    <span style="color: #e6edf3">task2</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">create_task(async_function2())</span>
<span style="color: #8b949e">... </span>    <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">cancel_tasks([task1,</span> <span style="color: #e6edf3">task2])</span>
<span style="color: #8b949e">...</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">run(main())</span>
</code></pre></div>
<details class="note" open="">
<summary>Note</summary>
<p>This function will not cancel the current task that it is called from.</p>
</details>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2363</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2364</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2365</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2366</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2367</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2368</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2369</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2370</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2371</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2372</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2373</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2374</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2375</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2376</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2377</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2378</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2379</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2380</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2381</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2382</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2383</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2384</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2385</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2386</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2387</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2388</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2389</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2390</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2391</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2392</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2393</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">cancel_tasks</span><span style="color: #e6edf3">(tasks,</span> <span style="color: #e6edf3">ignore_errors</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Asynchronously cancels a list of asyncio tasks.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        tasks (list[Task]): A list of asyncio Task objects to cancel.</span>
<span style="color: #a5d6ff">        ignore_errors (bool, optional): Whether to ignore errors other than asyncio.CancelledError. Defaults to True.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; async def main():</span>
<span style="color: #a5d6ff">        ...     task1 = asyncio.create_task(async_function1())</span>
<span style="color: #a5d6ff">        ...     task2 = asyncio.create_task(async_function2())</span>
<span style="color: #a5d6ff">        ...     await cancel_tasks([task1, task2])</span>
<span style="color: #a5d6ff">        ...</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; asyncio.run(main())</span>

<span style="color: #a5d6ff">    Note:</span>
<span style="color: #a5d6ff">        This function will not cancel the current task that it is called from.</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">current_task</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">current_task()</span>
    <span style="color: #e6edf3">tasks</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[t</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">t</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">tasks</span> <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">t</span> <span style="color: #ff7b72; font-weight: bold">!=</span> <span style="color: #e6edf3">current_task]</span>
    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">task</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">tasks:</span>
        <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Cancelling task: {</span><span style="color: #e6edf3">task</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">task</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">cancel()</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">ignore_errors:</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">task</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">tasks:</span>
            <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
                <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">task</span>
            <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">BaseException</span> <span style="color: #ff7b72">as</span> <span style="color: #e6edf3">e:</span>
                <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">isinstance(e,</span> <span style="color: #e6edf3">asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">CancelledError):</span>
                    <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">trace(traceback</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">format_exc())</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.cancel_tasks_sync">
<span class="doc doc-object-name doc-function-name">cancel_tasks_sync</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">cancel_tasks_sync(tasks)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Synchronously cancels a list of asyncio tasks.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>tasks</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#list">list</a>[Task]</code>)
        –
        <div class="doc-md-description">
<p>A list of asyncio Task objects to cancel.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">loop</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get_event_loop()</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">task1</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">loop</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">create_task(some_async_function1())</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">task2</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">loop</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">create_task(some_async_function2())</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">cancel_tasks_sync([task1,</span> <span style="color: #e6edf3">task2])</span>
</code></pre></div>
<details class="note" open="">
<summary>Note</summary>
<p>This function will not cancel the current task from which it is called.</p>
</details>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2396</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2397</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2398</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2399</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2400</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2401</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2402</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2403</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2404</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2405</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2406</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2407</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2408</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2409</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2410</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2411</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2412</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2413</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2414</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2415</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2416</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">cancel_tasks_sync</span><span style="color: #e6edf3">(tasks):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Synchronously cancels a list of asyncio tasks.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        tasks (list[Task]): A list of asyncio Task objects to cancel.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; loop = asyncio.get_event_loop()</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; task1 = loop.create_task(some_async_function1())</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; task2 = loop.create_task(some_async_function2())</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; cancel_tasks_sync([task1, task2])</span>

<span style="color: #a5d6ff">    Note:</span>
<span style="color: #a5d6ff">        This function will not cancel the current task from which it is called.</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">current_task</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">current_task()</span>
    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">task</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">tasks:</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">task</span> <span style="color: #ff7b72; font-weight: bold">!=</span> <span style="color: #e6edf3">current_task:</span>
            <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Cancelling task: {</span><span style="color: #e6edf3">task</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">task</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">cancel()</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.chain_lists">
<span class="doc doc-object-name doc-function-name">chain_lists</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">chain_lists(l,</span> <span style="color: #e6edf3">try_files</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">False</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">msg</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">remove_blank</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">True</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Chains together list elements, allowing for entries separated by commas.</p>
<p>This function takes a list <code>l</code> and flattens it by splitting its entries on commas.
It also allows you to optionally open entries as files and add their contents to the list.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>l</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#list">list</a></code>)
        –
        <div class="doc-md-description">
<p>The list of strings to chain together.</p>
</div>
</li>
<li class="field-body">
<b><code>try_files</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#bool">bool</a></code>, default:
                <code>False</code>
)
        –
        <div class="doc-md-description">
<p>Whether to try to open entries as files. Defaults to False.</p>
</div>
</li>
<li class="field-body">
<b><code>msg</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
<p>An optional message to log when reading from a file. Defaults to None.</p>
</div>
</li>
<li class="field-body">
<b><code>remove_blank</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#bool">bool</a></code>, default:
                <code>True</code>
)
        –
        <div class="doc-md-description">
<p>Whether to remove blank entries from the list. Defaults to True.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>list</code></b>        –
        <div class="doc-md-description">
<p>The list of chained elements.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">chain_lists([</span><span style="color: #a5d6ff">"a"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"b,c,d"</span><span style="color: #e6edf3">])</span>
<span style="color: #8b949e">['a', 'b', 'c', 'd']</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">chain_lists([</span><span style="color: #a5d6ff">"a,file.txt"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"c,d"</span><span style="color: #e6edf3">],</span> <span style="color: #e6edf3">try_files</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">['a', 'f_line1', 'f_line2', 'f_line3', 'c', 'd']</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1107</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1108</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1109</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1110</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1111</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1112</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1113</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1114</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1115</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1116</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1117</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1118</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1119</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1120</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1121</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1122</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1123</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1124</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1125</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1126</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1127</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1128</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1129</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1130</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1131</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1132</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1133</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1134</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1135</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1136</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1137</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1138</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1139</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1140</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1141</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1142</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1143</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1144</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1145</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1146</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">chain_lists</span><span style="color: #e6edf3">(l,</span> <span style="color: #e6edf3">try_files</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">msg</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">remove_blank</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Chains together list elements, allowing for entries separated by commas.</span>

<span style="color: #a5d6ff">    This function takes a list `l` and flattens it by splitting its entries on commas.</span>
<span style="color: #a5d6ff">    It also allows you to optionally open entries as files and add their contents to the list.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        l (list): The list of strings to chain together.</span>
<span style="color: #a5d6ff">        try_files (bool, optional): Whether to try to open entries as files. Defaults to False.</span>
<span style="color: #a5d6ff">        msg (str, optional): An optional message to log when reading from a file. Defaults to None.</span>
<span style="color: #a5d6ff">        remove_blank (bool, optional): Whether to remove blank entries from the list. Defaults to True.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        list: The list of chained elements.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; chain_lists(["a", "b,c,d"])</span>
<span style="color: #a5d6ff">        ['a', 'b', 'c', 'd']</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; chain_lists(["a,file.txt", "c,d"], try_files=True)</span>
<span style="color: #a5d6ff">        ['a', 'f_line1', 'f_line2', 'f_line3', 'c', 'd']</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">final_list</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">dict()</span>
    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">entry</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">l:</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">s</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">entry</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">split(</span><span style="color: #a5d6ff">","</span><span style="color: #e6edf3">):</span>
            <span style="color: #e6edf3">f</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">s</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">strip()</span>
            <span style="color: #e6edf3">f_path</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">Path(f)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolve()</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">try_files</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #e6edf3">f_path</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">is_file():</span>
                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">msg</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
                    <span style="color: #e6edf3">new_msg</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">str(msg)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">format(filename</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">f_path)</span>
                    <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">info(new_msg)</span>
                <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">line</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">str_or_file(f):</span>
                    <span style="color: #e6edf3">final_list[line]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span>
            <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">final_list[f]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span>

    <span style="color: #e6edf3">ret</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">list(final_list)</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">remove_blank:</span>
        <span style="color: #e6edf3">ret</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[r</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">r</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">ret</span> <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">r]</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">ret</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.clean_dict">
<span class="doc doc-object-name doc-function-name">clean_dict</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">clean_dict(d,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">key_names,</span> <span style="color: #e6edf3">fuzzy</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">False</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">exclude_keys</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">_prev_key</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Recursively clean unwanted keys from a dictionary.
Useful for removing secrets from a config.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>d</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#dict">dict</a></code>)
        –
        <div class="doc-md-description">
<p>The input dictionary.</p>
</div>
</li>
<li class="field-body">
<b><code>*key_names</code></b>
        –
        <div class="doc-md-description">
<p>Names of keys to remove.</p>
</div>
</li>
<li class="field-body">
<b><code>fuzzy</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#bool">bool</a></code>, default:
                <code>False</code>
)
        –
        <div class="doc-md-description">
<p>Whether to perform fuzzy matching on keys.</p>
</div>
</li>
<li class="field-body">
<b><code>exclude_keys</code></b>
            (<code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#list">list</a>, None)</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
<p>List of keys to be excluded from removal.</p>
</div>
</li>
<li class="field-body">
<b><code>_prev_key</code></b>
            (<code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a>, None)</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
<p>For internal recursive use; the previous key in the hierarchy.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>dict</code></b>        –
        <div class="doc-md-description">
<p>A dictionary cleaned of the keys specified in key_names.</p>
</div>
</li>
</ul>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1430</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1431</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1432</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1433</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1434</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1435</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1436</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1437</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1438</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1439</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1440</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1441</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1442</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1443</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1444</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1445</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1446</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1447</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1448</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1449</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1450</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1451</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1452</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1453</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1454</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1455</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1456</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1457</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1458</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">clean_dict</span><span style="color: #e6edf3">(d,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">key_names,</span> <span style="color: #e6edf3">fuzzy</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">exclude_keys</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">_prev_key</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Recursively clean unwanted keys from a dictionary.</span>
<span style="color: #a5d6ff">    Useful for removing secrets from a config.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        d (dict): The input dictionary.</span>
<span style="color: #a5d6ff">        *key_names: Names of keys to remove.</span>
<span style="color: #a5d6ff">        fuzzy (bool): Whether to perform fuzzy matching on keys.</span>
<span style="color: #a5d6ff">        exclude_keys (list, None): List of keys to be excluded from removal.</span>
<span style="color: #a5d6ff">        _prev_key (str, None): For internal recursive use; the previous key in the hierarchy.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        dict: A dictionary cleaned of the keys specified in key_names.</span>

<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">exclude_keys</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">exclude_keys</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">isinstance(exclude_keys,</span> <span style="color: #e6edf3">str):</span>
        <span style="color: #e6edf3">exclude_keys</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[exclude_keys]</span>
    <span style="color: #e6edf3">d</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">copy</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">deepcopy(d)</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">isinstance(d,</span> <span style="color: #e6edf3">dict):</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">key,</span> <span style="color: #e6edf3">val</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">list(d</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items()):</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">key</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">key_names</span> <span style="color: #ff7b72; font-weight: bold">or</span> <span style="color: #e6edf3">(fuzzy</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #e6edf3">any(k</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">key</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">k</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">key_names)):</span>
                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">_prev_key</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">exclude_keys:</span>
                    <span style="color: #e6edf3">d</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">pop(key)</span>
            <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">d[key]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">clean_dict(val,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">key_names,</span> <span style="color: #e6edf3">fuzzy</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">fuzzy,</span> <span style="color: #e6edf3">_prev_key</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">key,</span> <span style="color: #e6edf3">exclude_keys</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">exclude_keys)</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">d</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.clean_old">
<span class="doc doc-object-name doc-function-name">clean_old</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">clean_old(d,</span> <span style="color: #e6edf3">keep</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">10</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">filter</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">lambda</span> <span style="color: #e6edf3">:</span> <span style="color: #79c0ff">True</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">key</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">latest_mtime,</span> <span style="color: #e6edf3">reverse</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">True</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">raise_error</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">False</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Clean up old files and directories within a given directory based on various filtering and sorting options.</p>
<p>This function removes the oldest files and directories in the provided directory 'd' that exceed a specified
threshold ('keep'). The items to be deleted can be filtered using a lambda function 'filter', and they are
sorted by a key function, defaulting to latest modification time.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>d</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a> or <a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3.11/library/pathlib.html#pathlib.Path">Path</a></code>)
        –
        <div class="doc-md-description">
<p>The directory path to clean up.</p>
</div>
</li>
<li class="field-body">
<b><code>keep</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a></code>, default:
                <code>10</code>
)
        –
        <div class="doc-md-description">
<p>The number of items to keep. Ones beyond this count will be removed.</p>
</div>
</li>
<li class="field-body">
<b><code>filter</code></b>
            (<code>Callable</code>, default:
                <code>lambda : True</code>
)
        –
        <div class="doc-md-description">
<p>A lambda function for filtering which files or directories to consider.
               Defaults to a lambda function that returns True for all.</p>
</div>
</li>
<li class="field-body">
<b><code>key</code></b>
            (<code>Callable</code>, default:
                <code><a class="autorefs autorefs-internal" title="bbot.core.helpers.misc.latest_mtime" href="#bbot.core.helpers.misc.latest_mtime">latest_mtime</a></code>
)
        –
        <div class="doc-md-description">
<p>A function to sort the files and directories. Defaults to latest modification time.</p>
</div>
</li>
<li class="field-body">
<b><code>reverse</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#bool">bool</a></code>, default:
                <code>True</code>
)
        –
        <div class="doc-md-description">
<p>Whether to reverse the order of sorted items before removing. Defaults to True.</p>
</div>
</li>
<li class="field-body">
<b><code>raise_error</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#bool">bool</a></code>, default:
                <code>False</code>
)
        –
        <div class="doc-md-description">
<p>Whether to raise an error if directory deletion fails. Defaults to False.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">clean_old(</span><span style="color: #a5d6ff">"~/.bbot/scans"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">filter</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #ff7b72">lambda</span> <span style="color: #e6edf3">x:</span> <span style="color: #e6edf3">x</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">is_dir()</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #e6edf3">scan_name_regex</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">match(x</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name))</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1677</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1678</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1679</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1680</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1681</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1682</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1683</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1684</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1685</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1686</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1687</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1688</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1689</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1690</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1691</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1692</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1693</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1694</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1695</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1696</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1697</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1698</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1699</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1700</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1701</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1702</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1703</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1704</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1705</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1706</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1707</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1708</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1709</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">clean_old</span><span style="color: #e6edf3">(d,</span> <span style="color: #e6edf3">keep</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">10</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">filter</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #ff7b72">lambda</span> <span style="color: #e6edf3">x:</span> <span style="color: #79c0ff">True</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">key</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">latest_mtime,</span> <span style="color: #e6edf3">reverse</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">raise_error</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Clean up old files and directories within a given directory based on various filtering and sorting options.</span>

<span style="color: #a5d6ff">    This function removes the oldest files and directories in the provided directory 'd' that exceed a specified</span>
<span style="color: #a5d6ff">    threshold ('keep'). The items to be deleted can be filtered using a lambda function 'filter', and they are</span>
<span style="color: #a5d6ff">    sorted by a key function, defaulting to latest modification time.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        d (str or Path): The directory path to clean up.</span>
<span style="color: #a5d6ff">        keep (int): The number of items to keep. Ones beyond this count will be removed.</span>
<span style="color: #a5d6ff">        filter (Callable): A lambda function for filtering which files or directories to consider.</span>
<span style="color: #a5d6ff">                           Defaults to a lambda function that returns True for all.</span>
<span style="color: #a5d6ff">        key (Callable): A function to sort the files and directories. Defaults to latest modification time.</span>
<span style="color: #a5d6ff">        reverse (bool): Whether to reverse the order of sorted items before removing. Defaults to True.</span>
<span style="color: #a5d6ff">        raise_error (bool): Whether to raise an error if directory deletion fails. Defaults to False.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; clean_old("~/.bbot/scans", filter=lambda x: x.is_dir() and scan_name_regex.match(x.name))</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">d</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">Path(d)</span>
    <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">d</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">is_dir():</span>
        <span style="color: #ff7b72">return</span>
    <span style="color: #e6edf3">paths</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[x</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">x</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">d</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">iterdir()</span> <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">filter(x)]</span>
    <span style="color: #e6edf3">paths</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">sort(key</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">key,</span> <span style="color: #e6edf3">reverse</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">reverse)</span>
    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">path</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">paths[keep:]:</span>
        <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Removing {</span><span style="color: #e6edf3">path</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">shutil</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">rmtree(path)</span>
        <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">Exception</span> <span style="color: #ff7b72">as</span> <span style="color: #e6edf3">e:</span>
            <span style="color: #e6edf3">msg</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Failed to delete directory: {</span><span style="color: #e6edf3">path</span><span style="color: #a5d6ff">}, {</span><span style="color: #e6edf3">e</span><span style="color: #a5d6ff">}"</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">raise_error:</span>
                <span style="color: #ff7b72">raise</span> <span style="color: #e6edf3">errors</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">DirectoryDeletionError()</span>
            <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">warning(msg)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.closest_match">
<span class="doc doc-object-name doc-function-name">closest_match</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">closest_match(s,</span> <span style="color: #e6edf3">choices,</span> <span style="color: #e6edf3">n</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">cutoff</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">0.0</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Finds the closest matching strings from a list of choices based on a given string.</p>
<p>This function uses the difflib library to find the closest matches to a given string <code>s</code> from a list of <code>choices</code>.
It can return either the single best match or a list of the top <code>n</code> best matches.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>s</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>The string for which to find the closest match.</p>
</div>
</li>
<li class="field-body">
<b><code>choices</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#list">list</a></code>)
        –
        <div class="doc-md-description">
<p>A list of strings to compare against.</p>
</div>
</li>
<li class="field-body">
<b><code>n</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a></code>, default:
                <code>1</code>
)
        –
        <div class="doc-md-description">
<p>The number of best matches to return. Defaults to 1.</p>
</div>
</li>
<li class="field-body">
<b><code>cutoff</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#float">float</a></code>, default:
                <code>0.0</code>
)
        –
        <div class="doc-md-description">
<p>A float value that defines the similarity threshold. Strings with similarity below this value are not considered. Defaults to 0.0.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
        –
        <div class="doc-md-description">
<p>str or list: Either the closest matching string or a list of the <code>n</code> closest matching strings.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">closest_match(</span><span style="color: #a5d6ff">"asdf"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">[</span><span style="color: #a5d6ff">"asd"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"fds"</span><span style="color: #e6edf3">])</span>
<span style="color: #8b949e">'asd'</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">closest_match(</span><span style="color: #a5d6ff">"asdf"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">[</span><span style="color: #a5d6ff">"asd"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"fds"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"asdff"</span><span style="color: #e6edf3">],</span> <span style="color: #e6edf3">n</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">3</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">['asdff', 'asd', 'fds']</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1005</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1006</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1007</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1008</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1009</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1010</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1011</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1012</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1013</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1014</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1015</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1016</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1017</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1018</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1019</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1020</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1021</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1022</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1023</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1024</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1025</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1026</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1027</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1028</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1029</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1030</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1031</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">closest_match</span><span style="color: #e6edf3">(s,</span> <span style="color: #e6edf3">choices,</span> <span style="color: #e6edf3">n</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">1</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">cutoff</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">0.0</span><span style="color: #e6edf3">):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Finds the closest matching strings from a list of choices based on a given string.</span>

<span style="color: #a5d6ff">    This function uses the difflib library to find the closest matches to a given string `s` from a list of `choices`.</span>
<span style="color: #a5d6ff">    It can return either the single best match or a list of the top `n` best matches.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        s (str): The string for which to find the closest match.</span>
<span style="color: #a5d6ff">        choices (list): A list of strings to compare against.</span>
<span style="color: #a5d6ff">        n (int, optional): The number of best matches to return. Defaults to 1.</span>
<span style="color: #a5d6ff">        cutoff (float, optional): A float value that defines the similarity threshold. Strings with similarity below this value are not considered. Defaults to 0.0.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        str or list: Either the closest matching string or a list of the `n` closest matching strings.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; closest_match("asdf", ["asd", "fds"])</span>
<span style="color: #a5d6ff">        'asd'</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; closest_match("asdf", ["asd", "fds", "asdff"], n=3)</span>
<span style="color: #a5d6ff">        ['asdff', 'asd', 'fds']</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">matches</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">difflib</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get_close_matches(s,</span> <span style="color: #e6edf3">choices,</span> <span style="color: #e6edf3">n</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">n,</span> <span style="color: #e6edf3">cutoff</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">cutoff)</span>
    <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">choices</span> <span style="color: #ff7b72; font-weight: bold">or</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">matches:</span>
        <span style="color: #ff7b72">return</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">n</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">matches[</span><span style="color: #a5d6ff">0</span><span style="color: #e6edf3">]</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">matches</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.cloudcheck">
<span class="doc doc-object-name doc-function-name">cloudcheck</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">cloudcheck(ip)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Check whether an IP address belongs to a cloud provider and returns the provider name, type, and subnet.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>ip</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>The IP address to check.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>tuple</code></b>        –
        <div class="doc-md-description">
<p>A tuple containing provider name (str), provider type (str), and subnet (IPv4Network).</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">cloudcheck(</span><span style="color: #a5d6ff">"168.62.20.37"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">('Azure', 'cloud', IPv4Network('168.62.0.0/19'))</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2240</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2241</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2242</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2243</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2244</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2245</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2246</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2247</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2248</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2249</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2250</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2251</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2252</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2253</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2254</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2255</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2256</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2257</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2258</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">cloudcheck</span><span style="color: #e6edf3">(ip):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Check whether an IP address belongs to a cloud provider and returns the provider name, type, and subnet.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        ip (str): The IP address to check.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        tuple: A tuple containing provider name (str), provider type (str), and subnet (IPv4Network).</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; cloudcheck("168.62.20.37")</span>
<span style="color: #a5d6ff">        ('Azure', 'cloud', IPv4Network('168.62.0.0/19'))</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">provider,</span> <span style="color: #e6edf3">provider_type,</span> <span style="color: #e6edf3">subnet</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">_cloudcheck</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">check(ip)</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">provider:</span>
        <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">suppress(</span><span style="color: #f0883e; font-weight: bold">KeyError</span><span style="color: #e6edf3">):</span>
            <span style="color: #e6edf3">provider</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">provider_map[provider</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">lower()]</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">provider,</span> <span style="color: #e6edf3">provider_type,</span> <span style="color: #e6edf3">subnet</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.cpu_architecture">
<span class="doc doc-object-name doc-function-name">cpu_architecture</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">cpu_architecture()</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Return the CPU architecture of the current system.</p>
<p>This function fetches and returns the architecture type of the CPU where the code is being executed.
It maps common identifiers like "x86_64" to more general types like "amd64".</p>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>str</code></b>        –
        <div class="doc-md-description">
<p>A string representing the CPU architecture, such as "amd64", "armv7", or "arm64".</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">cpu_architecture()</span>
<span style="color: #8b949e">'amd64'</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2029</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2030</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2031</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2032</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2033</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2034</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2035</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2036</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2037</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2038</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2039</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2040</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2041</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2042</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2043</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2044</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2045</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2046</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2047</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2048</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">cpu_architecture</span><span style="color: #e6edf3">():</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Return the CPU architecture of the current system.</span>

<span style="color: #a5d6ff">    This function fetches and returns the architecture type of the CPU where the code is being executed.</span>
<span style="color: #a5d6ff">    It maps common identifiers like "x86_64" to more general types like "amd64".</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        str: A string representing the CPU architecture, such as "amd64", "armv7", or "arm64".</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; cpu_architecture()</span>
<span style="color: #a5d6ff">        'amd64'</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">uname</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">platform</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">uname()</span>
    <span style="color: #e6edf3">arch</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">uname</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">machine</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">lower()</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">arch</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">startswith(</span><span style="color: #a5d6ff">"aarch"</span><span style="color: #e6edf3">):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #a5d6ff">"arm64"</span>
    <span style="color: #ff7b72">elif</span> <span style="color: #e6edf3">arch</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #a5d6ff">"x86_64"</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">return</span> <span style="color: #a5d6ff">"amd64"</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">arch</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.delete_file">
<span class="doc doc-object-name doc-function-name">delete_file</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">delete_file(path)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Deletes a file at the given path.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>path</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a> or <a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3.11/library/pathlib.html#pathlib.Path">Path</a></code>)
        –
        <div class="doc-md-description">
<p>The path to the file to be deleted.</p>
</div>
</li>
</ul>
<details class="note" open="">
<summary>Note</summary>
<p>This function suppresses all exceptions to ensure that the program continues running even if the file could not be deleted.</p>
</details>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">delete_file(</span><span style="color: #a5d6ff">"/tmp/test/file1.txt"</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1185</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1186</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1187</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1188</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1189</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1190</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1191</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1192</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1193</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1194</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1195</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1196</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1197</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1198</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">delete_file</span><span style="color: #e6edf3">(path):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Deletes a file at the given path.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        path (str or Path): The path to the file to be deleted.</span>

<span style="color: #a5d6ff">    Note:</span>
<span style="color: #a5d6ff">        This function suppresses all exceptions to ensure that the program continues running even if the file could not be deleted.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; delete_file("/tmp/test/file1.txt")</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">suppress(</span><span style="color: #f0883e; font-weight: bold">Exception</span><span style="color: #e6edf3">):</span>
        <span style="color: #e6edf3">Path(path)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">unlink(missing_ok</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.domain_parents">
<span class="doc doc-object-name doc-function-name">domain_parents</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">domain_parents(d,</span> <span style="color: #e6edf3">include_self</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">False</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Generate a list of parent domains for a given domain string.</p>
<p>This function takes an input string <code>d</code> and generates a list of parent domains in decreasing order of specificity.
If <code>include_self</code> is set to True, the list will also include the input domain if it is not a top-level domain.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>d</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>The input string representing a domain or subdomain.</p>
</div>
</li>
<li class="field-body">
<b><code>include_self</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#bool">bool</a></code>, default:
                <code>False</code>
)
        –
        <div class="doc-md-description">
<p>Whether to include the input domain itself. Defaults to False.</p>
</div>
</li>
</ul>
<p>Yields:</p>
<ul>
<li class="field-body">
<b><code>str</code></b>        –
        <div class="doc-md-description">
<p>Parent domains of the input string in decreasing order of specificity.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">list(domain_parents(</span><span style="color: #a5d6ff">"test.www.evilcorp.co.uk"</span><span style="color: #e6edf3">))</span>
<span style="color: #8b949e">["www.evilcorp.co.uk", "evilcorp.co.uk"]</span>
</code></pre></div>
<details class="notes" open="">
<summary>Notes</summary>
<ul>
<li>Port, if present in input, is preserved in the output.</li>
</ul>
</details>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">295</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">296</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">297</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">298</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">299</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">300</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">301</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">302</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">303</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">304</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">305</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">306</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">307</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">308</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">309</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">310</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">311</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">312</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">313</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">314</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">315</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">316</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">317</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">318</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">319</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">320</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">321</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">322</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">323</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">324</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">325</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">326</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">327</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">domain_parents</span><span style="color: #e6edf3">(d,</span> <span style="color: #e6edf3">include_self</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Generate a list of parent domains for a given domain string.</span>

<span style="color: #a5d6ff">    This function takes an input string `d` and generates a list of parent domains in decreasing order of specificity.</span>
<span style="color: #a5d6ff">    If `include_self` is set to True, the list will also include the input domain if it is not a top-level domain.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        d (str): The input string representing a domain or subdomain.</span>
<span style="color: #a5d6ff">        include_self (bool, optional): Whether to include the input domain itself. Defaults to False.</span>

<span style="color: #a5d6ff">    Yields:</span>
<span style="color: #a5d6ff">        str: Parent domains of the input string in decreasing order of specificity.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; list(domain_parents("test.www.evilcorp.co.uk"))</span>
<span style="color: #a5d6ff">        ["www.evilcorp.co.uk", "evilcorp.co.uk"]</span>

<span style="color: #a5d6ff">    Notes:</span>
<span style="color: #a5d6ff">        - Port, if present in input, is preserved in the output.</span>
<span style="color: #a5d6ff">    """</span>

    <span style="color: #e6edf3">parent</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">str(d)</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">include_self</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">is_domain(parent):</span>
        <span style="color: #ff7b72">yield</span> <span style="color: #e6edf3">parent</span>
    <span style="color: #ff7b72">while</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">parent</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">parent_domain(parent)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">is_subdomain(parent):</span>
            <span style="color: #ff7b72">yield</span> <span style="color: #e6edf3">parent</span>
            <span style="color: #ff7b72">continue</span>
        <span style="color: #ff7b72">elif</span> <span style="color: #e6edf3">is_domain(parent):</span>
            <span style="color: #ff7b72">yield</span> <span style="color: #e6edf3">parent</span>
        <span style="color: #ff7b72">break</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.domain_stem">
<span class="doc doc-object-name doc-function-name">domain_stem</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">domain_stem(domain)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Returns an abbreviated representation of the hostname by removing the TLD (Top-Level Domain).</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>domain</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>The full domain name to be abbreviated.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>str</code></b>        –
        <div class="doc-md-description">
<p>An abbreviated domain string without the TLD.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">domain_stem(</span><span style="color: #a5d6ff">"www.evilcorp.com"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">"www.evilcorp"</span>
</code></pre></div>
<details class="notes" open="">
<summary>Notes</summary>
<ul>
<li>Utilizes the <code>tldextract</code> function for domain parsing.</li>
</ul>
</details>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">442</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">443</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">444</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">445</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">446</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">447</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">448</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">449</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">450</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">451</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">452</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">453</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">454</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">455</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">456</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">457</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">458</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">459</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">460</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">domain_stem</span><span style="color: #e6edf3">(domain):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Returns an abbreviated representation of the hostname by removing the TLD (Top-Level Domain).</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        domain (str): The full domain name to be abbreviated.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        str: An abbreviated domain string without the TLD.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; domain_stem("www.evilcorp.com")</span>
<span style="color: #a5d6ff">        "www.evilcorp"</span>

<span style="color: #a5d6ff">    Notes:</span>
<span style="color: #a5d6ff">        - Utilizes the `tldextract` function for domain parsing.</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">parsed</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">tldextract(str(domain))</span>
    <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"."</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join(parsed</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">subdomain</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">split(</span><span style="color: #a5d6ff">"."</span><span style="color: #e6edf3">)</span> <span style="color: #ff7b72; font-weight: bold">+</span> <span style="color: #e6edf3">parsed</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">domain</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">split(</span><span style="color: #a5d6ff">"."</span><span style="color: #e6edf3">))</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">strip(</span><span style="color: #a5d6ff">"."</span><span style="color: #e6edf3">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.execute_sync_or_async">
<span class="doc doc-object-name doc-function-name">execute_sync_or_async</span>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-async"><code>async</code></small>
</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">execute_sync_or_async(callback,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Execute a function or coroutine, handling either synchronous or asynchronous invocation.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>callback</code></b>
            (<code>Union[Callable, Coroutine]</code>)
        –
        <div class="doc-md-description">
<p>The function or coroutine to execute.</p>
</div>
</li>
<li class="field-body">
<b><code>*args</code></b>
        –
        <div class="doc-md-description">
<p>Variable-length argument list to pass to the callback.</p>
</div>
</li>
<li class="field-body">
<b><code>**kwargs</code></b>
        –
        <div class="doc-md-description">
<p>Arbitrary keyword arguments to pass to the callback.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>Any</code></b>        –
        <div class="doc-md-description">
<p>The return value from the executed function or coroutine.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">foo_async</span><span style="color: #e6edf3">(x):</span>
<span style="color: #8b949e">... </span>    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">x</span> <span style="color: #ff7b72; font-weight: bold">+</span> <span style="color: #a5d6ff">1</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">foo_sync</span><span style="color: #e6edf3">(x):</span>
<span style="color: #8b949e">... </span>    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">x</span> <span style="color: #ff7b72; font-weight: bold">+</span> <span style="color: #a5d6ff">1</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">run(execute_sync_or_async(foo_async,</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">))</span>
<span style="color: #8b949e">2</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">run(execute_sync_or_async(foo_sync,</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">))</span>
<span style="color: #8b949e">2</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2280</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2281</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2282</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2283</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2284</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2285</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2286</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2287</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2288</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2289</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2290</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2291</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2292</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2293</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2294</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2295</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2296</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2297</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2298</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2299</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2300</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2301</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2302</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2303</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2304</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2305</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2306</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2307</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">execute_sync_or_async</span><span style="color: #e6edf3">(callback,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Execute a function or coroutine, handling either synchronous or asynchronous invocation.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        callback (Union[Callable, Coroutine]): The function or coroutine to execute.</span>
<span style="color: #a5d6ff">        *args: Variable-length argument list to pass to the callback.</span>
<span style="color: #a5d6ff">        **kwargs: Arbitrary keyword arguments to pass to the callback.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        Any: The return value from the executed function or coroutine.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; async def foo_async(x):</span>
<span style="color: #a5d6ff">        ...     return x + 1</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; def foo_sync(x):</span>
<span style="color: #a5d6ff">        ...     return x + 1</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; asyncio.run(execute_sync_or_async(foo_async, 1))</span>
<span style="color: #a5d6ff">        2</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; asyncio.run(execute_sync_or_async(foo_sync, 1))</span>
<span style="color: #a5d6ff">        2</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">is_async_function(callback):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">callback(</span><span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
    <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">callback(</span><span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.extract_emails">
<span class="doc doc-object-name doc-function-name">extract_emails</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">extract_emails(s)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Extract email addresses from a body of text</p>
<p>This function takes in a string and yields all email addresses found in it.
The emails are converted to lower case before yielding. It utilizes
regular expressions for email pattern matching.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>s</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>The input string from which to extract email addresses.</p>
</div>
</li>
</ul>
<p>Yields:</p>
<ul>
<li class="field-body">
<b><code>str</code></b>        –
        <div class="doc-md-description">
<p>Yields email addresses found in the input string, in lower case.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">list(extract_emails(</span><span style="color: #a5d6ff">"Contact us at info@evilcorp.com and support@evilcorp.com"</span><span style="color: #e6edf3">))</span>
<span style="color: #8b949e">['info@evilcorp.com', 'support@evilcorp.com']</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1712</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1713</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1714</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1715</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1716</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1717</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1718</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1719</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1720</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1721</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1722</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1723</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1724</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1725</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1726</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1727</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1728</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1729</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1730</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1731</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">extract_emails</span><span style="color: #e6edf3">(s):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Extract email addresses from a body of text</span>

<span style="color: #a5d6ff">    This function takes in a string and yields all email addresses found in it.</span>
<span style="color: #a5d6ff">    The emails are converted to lower case before yielding. It utilizes</span>
<span style="color: #a5d6ff">    regular expressions for email pattern matching.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        s (str): The input string from which to extract email addresses.</span>

<span style="color: #a5d6ff">    Yields:</span>
<span style="color: #a5d6ff">        str: Yields email addresses found in the input string, in lower case.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; list(extract_emails("Contact us at info@evilcorp.com and support@evilcorp.com"))</span>
<span style="color: #a5d6ff">        ['info@evilcorp.com', 'support@evilcorp.com']</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">email</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">bbot_regexes</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">email_regex</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">findall(smart_decode(s)):</span>
        <span style="color: #ff7b72">yield</span> <span style="color: #e6edf3">email</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">lower()</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.extract_host">
<span class="doc doc-object-name doc-function-name">extract_host</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">extract_host(s)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Attempts to find and extract the host portion of a string.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>s</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>The string from which to extract the host.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>tuple</code></b>        –
        <div class="doc-md-description">
<p>A tuple containing three strings:
   (hostname (None if not found), string_before_hostname, string_after_hostname).</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">extract_host(</span><span style="color: #a5d6ff">"evilcorp.com:80"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">("evilcorp.com", "", ":80")</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">extract_host(</span><span style="color: #a5d6ff">"http://evilcorp.com:80/asdf.php?a=b"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">("evilcorp.com", "http://", ":80/asdf.php?a=b")</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">extract_host(</span><span style="color: #a5d6ff">"bob@evilcorp.com"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">("evilcorp.com", "bob@", "")</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">extract_host(</span><span style="color: #a5d6ff">"[dead::beef]:22"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">("dead::beef", "[", "]:22")</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">extract_host(</span><span style="color: #a5d6ff">"ftp://username:password@my-ftp.com/my-file.csv"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">(</span>
<span style="color: #8b949e">    "my-ftp.com",</span>
<span style="color: #8b949e">    "ftp://username:password@",</span>
<span style="color: #8b949e">    "/my-file.csv",</span>
<span style="color: #8b949e">)</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1734</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1735</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1736</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1737</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1738</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1739</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1740</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1741</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1742</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1743</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1744</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1745</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1746</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1747</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1748</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1749</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1750</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1751</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1752</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1753</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1754</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1755</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1756</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1757</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1758</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1759</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1760</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1761</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1762</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1763</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1764</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1765</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1766</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1767</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1768</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1769</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1770</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1771</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1772</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1773</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1774</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1775</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1776</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1777</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1778</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1779</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1780</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1781</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1782</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1783</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1784</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1785</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1786</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">extract_host</span><span style="color: #e6edf3">(s):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Attempts to find and extract the host portion of a string.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        s (str): The string from which to extract the host.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        tuple: A tuple containing three strings:</span>
<span style="color: #a5d6ff">               (hostname (None if not found), string_before_hostname, string_after_hostname).</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; extract_host("evilcorp.com:80")</span>
<span style="color: #a5d6ff">        ("evilcorp.com", "", ":80")</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; extract_host("http://evilcorp.com:80/asdf.php?a=b")</span>
<span style="color: #a5d6ff">        ("evilcorp.com", "http://", ":80/asdf.php?a=b")</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; extract_host("bob@evilcorp.com")</span>
<span style="color: #a5d6ff">        ("evilcorp.com", "bob@", "")</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; extract_host("[dead::beef]:22")</span>
<span style="color: #a5d6ff">        ("dead::beef", "[", "]:22")</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; extract_host("ftp://username:password@my-ftp.com/my-file.csv")</span>
<span style="color: #a5d6ff">        (</span>
<span style="color: #a5d6ff">            "my-ftp.com",</span>
<span style="color: #a5d6ff">            "ftp://username:password@",</span>
<span style="color: #a5d6ff">            "/my-file.csv",</span>
<span style="color: #a5d6ff">        )</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">s</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">smart_decode(s)</span>
    <span style="color: #e6edf3">match</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">bbot_regexes</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">extract_host_regex</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">search(s)</span>

    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">match:</span>
        <span style="color: #e6edf3">hostname</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">match</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">group(</span><span style="color: #a5d6ff">1</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">before</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">s[:</span> <span style="color: #e6edf3">match</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">start(</span><span style="color: #a5d6ff">1</span><span style="color: #e6edf3">)]</span>
        <span style="color: #e6edf3">after</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">s[match</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">end(</span><span style="color: #a5d6ff">1</span><span style="color: #e6edf3">)</span> <span style="color: #e6edf3">:]</span>
        <span style="color: #e6edf3">host,</span> <span style="color: #e6edf3">port</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">split_host_port(hostname)</span>
        <span style="color: #e6edf3">netloc</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">make_netloc(host,</span> <span style="color: #e6edf3">port)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">netloc</span> <span style="color: #ff7b72; font-weight: bold">!=</span> <span style="color: #e6edf3">hostname:</span>
            <span style="color: #8b949e; font-style: italic"># invalid host / port</span>
            <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">(</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">s,</span> <span style="color: #a5d6ff">""</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">host</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">port</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">after</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">":{</span><span style="color: #e6edf3">port</span><span style="color: #a5d6ff">}{</span><span style="color: #e6edf3">after</span><span style="color: #a5d6ff">}"</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">is_ip(host,</span> <span style="color: #e6edf3">version</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">6</span><span style="color: #e6edf3">)</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #e6edf3">hostname</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">startswith(</span><span style="color: #a5d6ff">"["</span><span style="color: #e6edf3">):</span>
                <span style="color: #e6edf3">before</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">before</span><span style="color: #a5d6ff">}["</span>
                <span style="color: #e6edf3">after</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"]{</span><span style="color: #e6edf3">after</span><span style="color: #a5d6ff">}"</span>
            <span style="color: #e6edf3">hostname</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">str(host)</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">(hostname,</span> <span style="color: #e6edf3">before,</span> <span style="color: #e6edf3">after)</span>

    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">(</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">s,</span> <span style="color: #a5d6ff">""</span><span style="color: #e6edf3">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.extract_params_html">
<span class="doc doc-object-name doc-function-name">extract_params_html</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">extract_params_html(html_data)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Extracts parameters from an HTML object, yielding them one at a time.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>html_data</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>HTML-formatted string.</p>
</div>
</li>
</ul>
<p>Yields:</p>
<ul>
<li class="field-body">
<b><code>str</code></b>        –
        <div class="doc-md-description">
<p>A string containing the parameter found in HTML object.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">html_data</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">'''</span>
<span style="color: #8b949e">... </span><span style="color: #a5d6ff">&lt;html&gt;</span>
<span style="color: #8b949e">... </span><span style="color: #a5d6ff">    &lt;body&gt;</span>
<span style="color: #8b949e">... </span><span style="color: #a5d6ff">        &lt;input name="user"&gt;</span>
<span style="color: #8b949e">... </span><span style="color: #a5d6ff">        &lt;a href="/page?param3=value3"&gt;Click Me&lt;/a&gt;</span>
<span style="color: #8b949e">... </span><span style="color: #a5d6ff">        &lt;script&gt;</span>
<span style="color: #8b949e">... </span><span style="color: #a5d6ff">            $.get("/test", {param1: "value1"});</span>
<span style="color: #8b949e">... </span><span style="color: #a5d6ff">            $.post("/test", {param2: "value2"});</span>
<span style="color: #8b949e">... </span><span style="color: #a5d6ff">        &lt;/script&gt;</span>
<span style="color: #8b949e">... </span><span style="color: #a5d6ff">    &lt;/body&gt;</span>
<span style="color: #8b949e">... </span><span style="color: #a5d6ff">&lt;/html&gt;</span>
<span style="color: #8b949e">... </span><span style="color: #a5d6ff">'''</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">list(extract_params_html(html_data))</span>
<span style="color: #8b949e">['user', 'param2', 'param3']</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">895</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">896</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">897</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">898</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">899</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">900</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">901</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">902</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">903</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">904</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">905</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">906</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">907</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">908</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">909</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">910</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">911</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">912</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">913</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">914</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">915</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">916</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">917</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">918</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">919</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">920</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">921</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">922</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">923</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">924</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">925</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">926</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">927</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">928</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">929</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">930</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">931</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">932</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">933</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">934</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">935</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">936</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">937</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">938</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">939</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">940</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">941</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">942</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">943</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">944</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">945</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">946</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">extract_params_html</span><span style="color: #e6edf3">(html_data):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Extracts parameters from an HTML object, yielding them one at a time.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        html_data (str): HTML-formatted string.</span>

<span style="color: #a5d6ff">    Yields:</span>
<span style="color: #a5d6ff">        str: A string containing the parameter found in HTML object.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; html_data = '''</span>
<span style="color: #a5d6ff">        ... &lt;html&gt;</span>
<span style="color: #a5d6ff">        ...     &lt;body&gt;</span>
<span style="color: #a5d6ff">        ...         &lt;input name="user"&gt;</span>
<span style="color: #a5d6ff">        ...         &lt;a href="/page?param3=value3"&gt;Click Me&lt;/a&gt;</span>
<span style="color: #a5d6ff">        ...         &lt;script&gt;</span>
<span style="color: #a5d6ff">        ...             $.get("/test", {param1: "value1"});</span>
<span style="color: #a5d6ff">        ...             $.post("/test", {param2: "value2"});</span>
<span style="color: #a5d6ff">        ...         &lt;/script&gt;</span>
<span style="color: #a5d6ff">        ...     &lt;/body&gt;</span>
<span style="color: #a5d6ff">        ... &lt;/html&gt;</span>
<span style="color: #a5d6ff">        ... '''</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; list(extract_params_html(html_data))</span>
<span style="color: #a5d6ff">        ['user', 'param2', 'param3']</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">input_tag</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">bbot_regexes</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">input_tag_regex</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">findall(html_data)</span>

    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">i</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">input_tag:</span>
        <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"FOUND PARAM ({</span><span style="color: #e6edf3">i</span><span style="color: #a5d6ff">}) IN INPUT TAGS"</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">yield</span> <span style="color: #e6edf3">i</span>

    <span style="color: #8b949e; font-style: italic"># check for jquery get parameters</span>
    <span style="color: #e6edf3">jquery_get</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">bbot_regexes</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">jquery_get_regex</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">findall(html_data)</span>

    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">i</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">jquery_get:</span>
        <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"FOUND PARAM ({</span><span style="color: #e6edf3">i</span><span style="color: #a5d6ff">}) IN JQUERY GET PARAMS"</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">yield</span> <span style="color: #e6edf3">i</span>

    <span style="color: #8b949e; font-style: italic"># check for jquery post parameters</span>
    <span style="color: #e6edf3">jquery_post</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">bbot_regexes</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">jquery_post_regex</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">findall(html_data)</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">jquery_post:</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">i</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">jquery_post:</span>
            <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">x</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">i</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">split(</span><span style="color: #a5d6ff">","</span><span style="color: #e6edf3">):</span>
                <span style="color: #e6edf3">s</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">x</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">split(</span><span style="color: #a5d6ff">":"</span><span style="color: #e6edf3">)[</span><span style="color: #a5d6ff">0</span><span style="color: #e6edf3">]</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">rstrip()</span>
                <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"FOUND PARAM ({</span><span style="color: #e6edf3">s</span><span style="color: #a5d6ff">}) IN A JQUERY POST PARAMS"</span><span style="color: #e6edf3">)</span>
                <span style="color: #ff7b72">yield</span> <span style="color: #e6edf3">s</span>

    <span style="color: #e6edf3">a_tag</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">bbot_regexes</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">a_tag_regex</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">findall(html_data)</span>
    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">s</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">a_tag:</span>
        <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"FOUND PARAM ({</span><span style="color: #e6edf3">s</span><span style="color: #a5d6ff">}) IN A TAG GET PARAMS"</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">yield</span> <span style="color: #e6edf3">s</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.extract_params_json">
<span class="doc doc-object-name doc-function-name">extract_params_json</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">extract_params_json(json_data)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Extracts keys from a JSON object and returns them as a set. Used by the <code>paramminer_headers</code> module.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>json_data</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>JSON-formatted string containing key-value pairs.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>set</code></b>        –
        <div class="doc-md-description">
<p>A set containing the keys present in the JSON object.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">extract_params_json(</span><span style="color: #a5d6ff">'{"a": 1, "b": {"c": 2}}'</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">{'a', 'b', 'c'}</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">820</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">821</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">822</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">823</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">824</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">825</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">826</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">827</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">828</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">829</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">830</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">831</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">832</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">833</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">834</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">835</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">836</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">837</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">838</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">839</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">840</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">841</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">842</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">843</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">844</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">845</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">846</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">847</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">848</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">849</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">850</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">851</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">852</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">853</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">854</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">855</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">856</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">857</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">858</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">extract_params_json</span><span style="color: #e6edf3">(json_data):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Extracts keys from a JSON object and returns them as a set. Used by the `paramminer_headers` module.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        json_data (str): JSON-formatted string containing key-value pairs.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        set: A set containing the keys present in the JSON object.</span>

<span style="color: #a5d6ff">    Raises:</span>
<span style="color: #a5d6ff">        Logs a message if JSONDecodeError occurs.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; extract_params_json('{"a": 1, "b": {"c": 2}}')</span>
<span style="color: #a5d6ff">        {'a', 'b', 'c'}</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">data</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">json</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">loads(json_data)</span>
    <span style="color: #ff7b72">except</span> <span style="color: #e6edf3">json</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">JSONDecodeError:</span>
        <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #a5d6ff">"Invalid JSON supplied. Returning empty list."</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">set()</span>

    <span style="color: #e6edf3">keys</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">set()</span>
    <span style="color: #e6edf3">stack</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[data]</span>

    <span style="color: #ff7b72">while</span> <span style="color: #e6edf3">stack:</span>
        <span style="color: #e6edf3">current_data</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">stack</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">pop()</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">isinstance(current_data,</span> <span style="color: #e6edf3">dict):</span>
            <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">key,</span> <span style="color: #e6edf3">value</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">current_data</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items():</span>
                <span style="color: #e6edf3">keys</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">add(key)</span>
                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">isinstance(value,</span> <span style="color: #e6edf3">(dict,</span> <span style="color: #e6edf3">list)):</span>
                    <span style="color: #e6edf3">stack</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(value)</span>
        <span style="color: #ff7b72">elif</span> <span style="color: #e6edf3">isinstance(current_data,</span> <span style="color: #e6edf3">list):</span>
            <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">item</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">current_data:</span>
                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">isinstance(item,</span> <span style="color: #e6edf3">(dict,</span> <span style="color: #e6edf3">list)):</span>
                    <span style="color: #e6edf3">stack</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(item)</span>

    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">keys</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.extract_params_xml">
<span class="doc doc-object-name doc-function-name">extract_params_xml</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">extract_params_xml(xml_data)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Extracts tags from an XML object and returns them as a set.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>xml_data</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>XML-formatted string containing elements.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>set</code></b>        –
        <div class="doc-md-description">
<p>A set containing the tags present in the XML object.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">extract_params_xml(</span><span style="color: #a5d6ff">'&lt;root&gt;&lt;child1&gt;&lt;child2/&gt;&lt;/child1&gt;&lt;/root&gt;'</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">{'child1', 'child2', 'root'}</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">861</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">862</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">863</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">864</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">865</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">866</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">867</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">868</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">869</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">870</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">871</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">872</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">873</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">874</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">875</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">876</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">877</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">878</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">879</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">880</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">881</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">882</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">883</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">884</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">885</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">886</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">887</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">888</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">889</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">890</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">891</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">892</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">extract_params_xml</span><span style="color: #e6edf3">(xml_data):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Extracts tags from an XML object and returns them as a set.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        xml_data (str): XML-formatted string containing elements.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        set: A set containing the tags present in the XML object.</span>

<span style="color: #a5d6ff">    Raises:</span>
<span style="color: #a5d6ff">        Logs a message if ParseError occurs.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; extract_params_xml('&lt;root&gt;&lt;child1&gt;&lt;child2/&gt;&lt;/child1&gt;&lt;/root&gt;')</span>
<span style="color: #a5d6ff">        {'child1', 'child2', 'root'}</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">root</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">ET</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">fromstring(xml_data)</span>
    <span style="color: #ff7b72">except</span> <span style="color: #e6edf3">ET</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">ParseError:</span>
        <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #a5d6ff">"Invalid XML supplied. Returning empty list."</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">set()</span>

    <span style="color: #e6edf3">tags</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">set()</span>
    <span style="color: #e6edf3">stack</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[root]</span>

    <span style="color: #ff7b72">while</span> <span style="color: #e6edf3">stack:</span>
        <span style="color: #e6edf3">current_element</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">stack</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">pop()</span>
        <span style="color: #e6edf3">tags</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">add(current_element</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">tag)</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">child</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">current_element:</span>
            <span style="color: #e6edf3">stack</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(child)</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">tags</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.extract_words">
<span class="doc doc-object-name doc-function-name">extract_words</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">extract_words(data,</span> <span style="color: #e6edf3">acronyms</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">True</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">wordninja</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">True</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">model</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">max_length</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">100</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">word_regexes</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Intelligently extracts words from given data.</p>
<p>This function uses regular expressions and optionally wordninja to extract words
from a given text string. Thanks to wordninja it can handle concatenated words intelligently.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>data</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>The data from which words are to be extracted.</p>
</div>
</li>
<li class="field-body">
<b><code>acronyms</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#bool">bool</a></code>, default:
                <code>True</code>
)
        –
        <div class="doc-md-description">
<p>Whether to include acronyms. Defaults to True.</p>
</div>
</li>
<li class="field-body">
<b><code>wordninja</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#bool">bool</a></code>, default:
                <code>True</code>
)
        –
        <div class="doc-md-description">
<p>Whether to use the wordninja library to split concatenated words. Defaults to True.</p>
</div>
</li>
<li class="field-body">
<b><code>model</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#object">object</a></code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
<p>A custom wordninja model for special types of data such as DNS names.</p>
</div>
</li>
<li class="field-body">
<b><code>max_length</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a></code>, default:
                <code>100</code>
)
        –
        <div class="doc-md-description">
<p>Maximum length for a word to be included. Defaults to 100.</p>
</div>
</li>
<li class="field-body">
<b><code>word_regexes</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#list">list</a></code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
<p>A list of compiled regular expression objects for word extraction. Defaults to None.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>set</code></b>        –
        <div class="doc-md-description">
<p>A set of extracted words.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">extract_words(</span><span style="color: #a5d6ff">'blacklanternsecurity'</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">{'black', 'lantern', 'security', 'bls', 'blacklanternsecurity'}</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 949</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 950</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 951</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 952</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 953</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 954</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 955</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 956</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 957</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 958</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 959</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 960</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 961</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 962</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 963</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 964</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 965</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 966</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 967</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 968</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 969</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 970</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 971</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 972</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 973</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 974</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 975</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 976</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 977</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 978</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 979</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 980</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 981</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 982</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 983</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 984</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 985</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 986</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 987</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 988</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 989</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 990</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 991</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 992</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 993</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 994</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 995</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 996</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 997</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 998</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 999</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1000</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1001</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1002</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">extract_words</span><span style="color: #e6edf3">(data,</span> <span style="color: #e6edf3">acronyms</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">wordninja</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">model</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">max_length</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">100</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">word_regexes</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Intelligently extracts words from given data.</span>

<span style="color: #a5d6ff">    This function uses regular expressions and optionally wordninja to extract words</span>
<span style="color: #a5d6ff">    from a given text string. Thanks to wordninja it can handle concatenated words intelligently.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        data (str): The data from which words are to be extracted.</span>
<span style="color: #a5d6ff">        acronyms (bool, optional): Whether to include acronyms. Defaults to True.</span>
<span style="color: #a5d6ff">        wordninja (bool, optional): Whether to use the wordninja library to split concatenated words. Defaults to True.</span>
<span style="color: #a5d6ff">        model (object, optional): A custom wordninja model for special types of data such as DNS names.</span>
<span style="color: #a5d6ff">        max_length (int, optional): Maximum length for a word to be included. Defaults to 100.</span>
<span style="color: #a5d6ff">        word_regexes (list, optional): A list of compiled regular expression objects for word extraction. Defaults to None.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        set: A set of extracted words.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; extract_words('blacklanternsecurity')</span>
<span style="color: #a5d6ff">        {'black', 'lantern', 'security', 'bls', 'blacklanternsecurity'}</span>
<span style="color: #a5d6ff">    """</span>

    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">word_regexes</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">word_regexes</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">bbot_regexes</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">word_regexes</span>
    <span style="color: #e6edf3">words</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">set()</span>
    <span style="color: #e6edf3">data</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">smart_decode(data)</span>
    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">r</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">word_regexes:</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">word</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">set(r</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">findall(data)):</span>
            <span style="color: #8b949e; font-style: italic"># blacklanternsecurity</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">len(word)</span> <span style="color: #ff7b72; font-weight: bold">&lt;=</span> <span style="color: #e6edf3">max_length:</span>
                <span style="color: #e6edf3">words</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">add(word)</span>

    <span style="color: #8b949e; font-style: italic"># blacklanternsecurity --&gt; ['black', 'lantern', 'security']</span>
    <span style="color: #8b949e; font-style: italic"># max_slice_length = 3</span>
    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">word</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">list(words):</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">wordninja:</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">model</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">model</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">_wordninja</span>
            <span style="color: #e6edf3">subwords</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">model</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">split(word)</span>
            <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">subword</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">subwords:</span>
                <span style="color: #e6edf3">words</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">add(subword)</span>
        <span style="color: #8b949e; font-style: italic"># this section generates compound words</span>
        <span style="color: #8b949e; font-style: italic"># it is interesting but currently disabled the quality of its output doesn't quite justify its quantity</span>
        <span style="color: #8b949e; font-style: italic"># blacklanternsecurity --&gt; ['black', 'lantern', 'security', 'blacklantern', 'lanternsecurity']</span>
        <span style="color: #8b949e; font-style: italic"># for s, e in combinations(range(len(subwords) + 1), 2):</span>
        <span style="color: #8b949e; font-style: italic">#    if e - s &lt;= max_slice_length:</span>
        <span style="color: #8b949e; font-style: italic">#        subword_slice = "".join(subwords[s:e])</span>
        <span style="color: #8b949e; font-style: italic">#        words.add(subword_slice)</span>
        <span style="color: #8b949e; font-style: italic"># blacklanternsecurity --&gt; bls</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">acronyms:</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">len(subwords)</span> <span style="color: #ff7b72; font-weight: bold">&gt;</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">words</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">add(</span><span style="color: #a5d6ff">""</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join([c[</span><span style="color: #a5d6ff">0</span><span style="color: #e6edf3">]</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">c</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">subwords</span> <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">len(c)</span> <span style="color: #ff7b72; font-weight: bold">&gt;</span> <span style="color: #a5d6ff">0</span><span style="color: #e6edf3">]))</span>

    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">words</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.filesize">
<span class="doc doc-object-name doc-function-name">filesize</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">filesize(f)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Get the file size of a given file.</p>
<p>This function takes a file path as an argument and returns its size in bytes. If the path
does not point to a file, the function returns 0.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>f</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a> or <a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3.11/library/pathlib.html#pathlib.Path">Path</a></code>)
        –
        <div class="doc-md-description">
<p>The file path for which to get the size.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>int</code></b>        –
        <div class="doc-md-description">
<p>The size of the file in bytes, or 0 if the path does not point to a file.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">filesize(</span><span style="color: #a5d6ff">"/path/to/file.txt"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">1024</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1655</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1656</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1657</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1658</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1659</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1660</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1661</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1662</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1663</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1664</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1665</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1666</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1667</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1668</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1669</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1670</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1671</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1672</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1673</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1674</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">filesize</span><span style="color: #e6edf3">(f):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Get the file size of a given file.</span>

<span style="color: #a5d6ff">    This function takes a file path as an argument and returns its size in bytes. If the path</span>
<span style="color: #a5d6ff">    does not point to a file, the function returns 0.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        f (str or Path): The file path for which to get the size.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        int: The size of the file in bytes, or 0 if the path does not point to a file.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; filesize("/path/to/file.txt")</span>
<span style="color: #a5d6ff">        1024</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">f</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">Path(f)</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">f</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">is_file():</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">f</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">stat()</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">st_size</span>
    <span style="color: #ff7b72">return</span> <span style="color: #a5d6ff">0</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.filter_dict">
<span class="doc doc-object-name doc-function-name">filter_dict</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">filter_dict(d,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">key_names,</span> <span style="color: #e6edf3">fuzzy</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">False</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">exclude_keys</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">_prev_key</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Recursively filter a dictionary based on key names.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>d</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#dict">dict</a></code>)
        –
        <div class="doc-md-description">
<p>The input dictionary.</p>
</div>
</li>
<li class="field-body">
<b><code>*key_names</code></b>
        –
        <div class="doc-md-description">
<p>Names of keys to filter for.</p>
</div>
</li>
<li class="field-body">
<b><code>fuzzy</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#bool">bool</a></code>, default:
                <code>False</code>
)
        –
        <div class="doc-md-description">
<p>Whether to perform fuzzy matching on keys.</p>
</div>
</li>
<li class="field-body">
<b><code>exclude_keys</code></b>
            (<code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#list">list</a>, None)</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
<p>List of keys to be excluded from the final dict.</p>
</div>
</li>
<li class="field-body">
<b><code>_prev_key</code></b>
            (<code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a>, None)</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
<p>For internal recursive use; the previous key in the hierarchy.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>dict</code></b>        –
        <div class="doc-md-description">
<p>A dictionary containing only the keys specified in key_names.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">filter_dict({</span><span style="color: #a5d6ff">"key1"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">"test"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"key2"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">"asdf"</span><span style="color: #e6edf3">},</span> <span style="color: #a5d6ff">"key2"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">{"key2": "asdf"}</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">filter_dict({</span><span style="color: #a5d6ff">"key1"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">"test"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"key2"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">{</span><span style="color: #a5d6ff">"key3"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">"asdf"</span><span style="color: #e6edf3">}},</span> <span style="color: #a5d6ff">"key1"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"key3"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">exclude_keys</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"key2"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">{'key1': 'test'}</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1393</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1394</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1395</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1396</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1397</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1398</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1399</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1400</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1401</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1402</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1403</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1404</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1405</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1406</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1407</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1408</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1409</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1410</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1411</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1412</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1413</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1414</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1415</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1416</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1417</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1418</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1419</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1420</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1421</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1422</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1423</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1424</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1425</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1426</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1427</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">filter_dict</span><span style="color: #e6edf3">(d,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">key_names,</span> <span style="color: #e6edf3">fuzzy</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">exclude_keys</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">_prev_key</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Recursively filter a dictionary based on key names.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        d (dict): The input dictionary.</span>
<span style="color: #a5d6ff">        *key_names: Names of keys to filter for.</span>
<span style="color: #a5d6ff">        fuzzy (bool): Whether to perform fuzzy matching on keys.</span>
<span style="color: #a5d6ff">        exclude_keys (list, None): List of keys to be excluded from the final dict.</span>
<span style="color: #a5d6ff">        _prev_key (str, None): For internal recursive use; the previous key in the hierarchy.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        dict: A dictionary containing only the keys specified in key_names.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; filter_dict({"key1": "test", "key2": "asdf"}, "key2")</span>
<span style="color: #a5d6ff">        {"key2": "asdf"}</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; filter_dict({"key1": "test", "key2": {"key3": "asdf"}}, "key1", "key3", exclude_keys="key2")</span>
<span style="color: #a5d6ff">        {'key1': 'test'}</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">exclude_keys</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">exclude_keys</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">isinstance(exclude_keys,</span> <span style="color: #e6edf3">str):</span>
        <span style="color: #e6edf3">exclude_keys</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[exclude_keys]</span>
    <span style="color: #e6edf3">ret</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{}</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">isinstance(d,</span> <span style="color: #e6edf3">dict):</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">key</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">d:</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">key</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">key_names</span> <span style="color: #ff7b72; font-weight: bold">or</span> <span style="color: #e6edf3">(fuzzy</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #e6edf3">any(k</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">key</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">k</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">key_names)):</span>
                <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">any(k</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">exclude_keys</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">k</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">[key,</span> <span style="color: #e6edf3">_prev_key]):</span>
                    <span style="color: #e6edf3">ret[key]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">copy</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">deepcopy(d[key])</span>
            <span style="color: #ff7b72">elif</span> <span style="color: #e6edf3">isinstance(d[key],</span> <span style="color: #e6edf3">list)</span> <span style="color: #ff7b72; font-weight: bold">or</span> <span style="color: #e6edf3">isinstance(d[key],</span> <span style="color: #e6edf3">dict):</span>
                <span style="color: #e6edf3">child</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">filter_dict(d[key],</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">key_names,</span> <span style="color: #e6edf3">fuzzy</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">fuzzy,</span> <span style="color: #e6edf3">_prev_key</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">key,</span> <span style="color: #e6edf3">exclude_keys</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">exclude_keys)</span>
                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">child:</span>
                    <span style="color: #e6edf3">ret[key]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">child</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">ret</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.gen_numbers">
<span class="doc doc-object-name doc-function-name">gen_numbers</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">gen_numbers(n,</span> <span style="color: #e6edf3">padding</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">2</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Generates numbers with variable padding and returns them as a set of strings.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>n</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a></code>)
        –
        <div class="doc-md-description">
<p>The upper limit of numbers to generate, exclusive.</p>
</div>
</li>
<li class="field-body">
<b><code>padding</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a></code>, default:
                <code>2</code>
)
        –
        <div class="doc-md-description">
<p>The maximum number of digits to pad the numbers with. Defaults to 2.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>set</code></b>        –
        <div class="doc-md-description">
<p>A set of string representations of numbers with varying degrees of padding.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">gen_numbers(</span><span style="color: #a5d6ff">5</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">{'0', '00', '01', '02', '03', '04', '1', '2', '3', '4'}</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">gen_numbers(</span><span style="color: #a5d6ff">3</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">padding</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">3</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">{'0', '00', '000', '001', '002', '01', '02', '1', '2'}</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">gen_numbers(</span><span style="color: #a5d6ff">5</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">padding</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">1</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">{'0', '1', '2', '3', '4'}</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1222</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1223</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1224</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1225</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1226</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1227</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1228</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1229</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1230</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1231</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1232</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1233</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1234</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1235</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1236</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1237</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1238</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1239</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1240</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1241</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1242</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1243</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1244</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1245</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1246</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">gen_numbers</span><span style="color: #e6edf3">(n,</span> <span style="color: #e6edf3">padding</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">2</span><span style="color: #e6edf3">):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Generates numbers with variable padding and returns them as a set of strings.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        n (int): The upper limit of numbers to generate, exclusive.</span>
<span style="color: #a5d6ff">        padding (int, optional): The maximum number of digits to pad the numbers with. Defaults to 2.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        set: A set of string representations of numbers with varying degrees of padding.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; gen_numbers(5)</span>
<span style="color: #a5d6ff">        {'0', '00', '01', '02', '03', '04', '1', '2', '3', '4'}</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; gen_numbers(3, padding=3)</span>
<span style="color: #a5d6ff">        {'0', '00', '000', '001', '002', '01', '02', '1', '2'}</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; gen_numbers(5, padding=1)</span>
<span style="color: #a5d6ff">        {'0', '1', '2', '3', '4'}</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">results</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">set()</span>
    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">i</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">range(n):</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">p</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">range(</span><span style="color: #a5d6ff">1</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">padding</span> <span style="color: #ff7b72; font-weight: bold">+</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">):</span>
            <span style="color: #e6edf3">results</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">add(str(i)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">zfill(p))</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">results</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.get_exception_chain">
<span class="doc doc-object-name doc-function-name">get_exception_chain</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">get_exception_chain(e)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Retrieves the full chain of exceptions leading to the given exception.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>e</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/exceptions.html#BaseException">BaseException</a></code>)
        –
        <div class="doc-md-description">
<p>The exception for which to get the chain.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
        –
        <div class="doc-md-description">
<p>list[BaseException]: List of exceptions in the chain, from the given exception back to the root cause.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
<span style="color: #8b949e">... </span>    <span style="color: #ff7b72">raise</span> <span style="color: #f0883e; font-weight: bold">ValueError</span><span style="color: #e6edf3">(</span><span style="color: #a5d6ff">"This is a value error"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">... </span><span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">ValueError</span> <span style="color: #ff7b72">as</span> <span style="color: #e6edf3">e:</span>
<span style="color: #8b949e">... </span>    <span style="color: #e6edf3">exc_chain</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">get_exception_chain(e)</span>
<span style="color: #8b949e">... </span>    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">exc</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">exc_chain:</span>
<span style="color: #8b949e">... </span>        <span style="color: #e6edf3">print(exc)</span>
<span style="color: #8b949e">This is a value error</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2310</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2311</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2312</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2313</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2314</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2315</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2316</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2317</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2318</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2319</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2320</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2321</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2322</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2323</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2324</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2325</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2326</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2327</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2328</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2329</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2330</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2331</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2332</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2333</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2334</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">get_exception_chain</span><span style="color: #e6edf3">(e):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Retrieves the full chain of exceptions leading to the given exception.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        e (BaseException): The exception for which to get the chain.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        list[BaseException]: List of exceptions in the chain, from the given exception back to the root cause.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; try:</span>
<span style="color: #a5d6ff">        ...     raise ValueError("This is a value error")</span>
<span style="color: #a5d6ff">        ... except ValueError as e:</span>
<span style="color: #a5d6ff">        ...     exc_chain = get_exception_chain(e)</span>
<span style="color: #a5d6ff">        ...     for exc in exc_chain:</span>
<span style="color: #a5d6ff">        ...         print(exc)</span>
<span style="color: #a5d6ff">        This is a value error</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">exception_chain</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>
    <span style="color: #e6edf3">current_exception</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">e</span>
    <span style="color: #ff7b72">while</span> <span style="color: #e6edf3">current_exception</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">exception_chain</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(current_exception)</span>
        <span style="color: #e6edf3">current_exception</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">getattr(current_exception,</span> <span style="color: #a5d6ff">"__context__"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">exception_chain</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.get_file_extension">
<span class="doc doc-object-name doc-function-name">get_file_extension</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">get_file_extension(s)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Extracts the file extension from a given string representing a URL or file path.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>s</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>The string from which to extract the file extension.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>str</code></b>        –
        <div class="doc-md-description">
<p>The file extension, or an empty string if no extension is found.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">get_file_extension(</span><span style="color: #a5d6ff">"https://evilcorp.com/api/test.php"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">"php"</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">get_file_extension(</span><span style="color: #a5d6ff">"/etc/test.conf"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">"conf"</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">get_file_extension(</span><span style="color: #a5d6ff">"/etc/passwd"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">""</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1566</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1567</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1568</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1569</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1570</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1571</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1572</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1573</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1574</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1575</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1576</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1577</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1578</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1579</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1580</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1581</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1582</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1583</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1584</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1585</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1586</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1587</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1588</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1589</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">get_file_extension</span><span style="color: #e6edf3">(s):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Extracts the file extension from a given string representing a URL or file path.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        s (str): The string from which to extract the file extension.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        str: The file extension, or an empty string if no extension is found.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; get_file_extension("https://evilcorp.com/api/test.php")</span>
<span style="color: #a5d6ff">        "php"</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; get_file_extension("/etc/test.conf")</span>
<span style="color: #a5d6ff">        "conf"</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; get_file_extension("/etc/passwd")</span>
<span style="color: #a5d6ff">        ""</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">s</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">str(s)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">lower()</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">strip()</span>
    <span style="color: #e6edf3">rightmost_section</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">s</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">rsplit(</span><span style="color: #a5d6ff">"/"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">)[</span><span style="color: #ff7b72; font-weight: bold">-</span><span style="color: #a5d6ff">1</span><span style="color: #e6edf3">]</span>
    <span style="color: #ff7b72">if</span> <span style="color: #a5d6ff">"."</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">rightmost_section:</span>
        <span style="color: #e6edf3">extension</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">rightmost_section</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">rsplit(</span><span style="color: #a5d6ff">"."</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">)[</span><span style="color: #ff7b72; font-weight: bold">-</span><span style="color: #a5d6ff">1</span><span style="color: #e6edf3">]</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">extension</span>
    <span style="color: #ff7b72">return</span> <span style="color: #a5d6ff">""</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.get_size">
<span class="doc doc-object-name doc-function-name">get_size</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">get_size(obj,</span> <span style="color: #e6edf3">max_depth</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">5</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">seen</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Roughly estimate the memory footprint of a Python object using recursion.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>obj</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#any">any</a></code>)
        –
        <div class="doc-md-description">
<p>The object whose size is to be determined.</p>
</div>
</li>
<li class="field-body">
<b><code>max_depth</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a></code>, default:
                <code>5</code>
)
        –
        <div class="doc-md-description">
<p>Maximum depth to which nested objects will be inspected. Defaults to 5.</p>
</div>
</li>
<li class="field-body">
<b><code>seen</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#set">set</a></code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
<p>Objects that have already been accounted for, to avoid loops.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>int</code></b>        –
        <div class="doc-md-description">
<p>Approximate memory footprint of the object in bytes.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">get_size(my_list)</span>
<span style="color: #8b949e">4200</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">get_size(my_dict,</span> <span style="color: #e6edf3">max_depth</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">3</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">8400</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2157</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2158</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2159</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2160</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2161</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2162</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2163</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2164</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2165</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2166</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2167</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2168</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2169</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2170</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2171</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2172</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2173</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2174</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2175</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2176</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2177</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2178</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2179</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2180</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2181</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2182</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2183</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2184</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2185</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2186</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2187</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2188</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2189</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2190</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2191</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2192</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2193</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2194</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2195</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2196</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2197</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2198</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2199</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2200</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2201</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2202</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2203</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2204</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2205</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2206</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2207</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2208</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2209</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2210</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2211</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2212</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">get_size</span><span style="color: #e6edf3">(obj,</span> <span style="color: #e6edf3">max_depth</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">5</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">seen</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Roughly estimate the memory footprint of a Python object using recursion.</span>

<span style="color: #a5d6ff">    Parameters:</span>
<span style="color: #a5d6ff">        obj (any): The object whose size is to be determined.</span>
<span style="color: #a5d6ff">        max_depth (int, optional): Maximum depth to which nested objects will be inspected. Defaults to 5.</span>
<span style="color: #a5d6ff">        seen (set, optional): Objects that have already been accounted for, to avoid loops.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        int: Approximate memory footprint of the object in bytes.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; get_size(my_list)</span>
<span style="color: #a5d6ff">        4200</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; get_size(my_dict, max_depth=3)</span>
<span style="color: #a5d6ff">        8400</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #8b949e; font-style: italic"># If seen is not provided, initialize an empty set</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">seen</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">seen</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">set()</span>
    <span style="color: #8b949e; font-style: italic"># Get the id of the object</span>
    <span style="color: #e6edf3">obj_id</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">id(obj)</span>
    <span style="color: #8b949e; font-style: italic"># Decrease the maximum depth for the next recursion</span>
    <span style="color: #e6edf3">new_max_depth</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">max_depth</span> <span style="color: #ff7b72; font-weight: bold">-</span> <span style="color: #a5d6ff">1</span>
    <span style="color: #8b949e; font-style: italic"># If the object has already been seen or we've reached the maximum recursion depth, return 0</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">obj_id</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">seen</span> <span style="color: #ff7b72; font-weight: bold">or</span> <span style="color: #e6edf3">new_max_depth</span> <span style="color: #ff7b72; font-weight: bold">&lt;=</span> <span style="color: #a5d6ff">0</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">return</span> <span style="color: #a5d6ff">0</span>
    <span style="color: #8b949e; font-style: italic"># Get the size of the object</span>
    <span style="color: #e6edf3">size</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">sys</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">getsizeof(obj)</span>
    <span style="color: #8b949e; font-style: italic"># Add the object's id to the set of seen objects</span>
    <span style="color: #e6edf3">seen</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">add(obj_id)</span>
    <span style="color: #8b949e; font-style: italic"># If the object has a __dict__ attribute, we want to measure its size</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">hasattr(obj,</span> <span style="color: #a5d6ff">"__dict__"</span><span style="color: #e6edf3">):</span>
        <span style="color: #8b949e; font-style: italic"># Iterate over the Method Resolution Order (MRO) of the class of the object</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">cls</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">obj</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #79c0ff">__class__</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #79c0ff">__mro__</span><span style="color: #e6edf3">:</span>
            <span style="color: #8b949e; font-style: italic"># If the class's __dict__ contains a __dict__ key</span>
            <span style="color: #ff7b72">if</span> <span style="color: #a5d6ff">"__dict__"</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">cls</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #79c0ff">__dict__</span><span style="color: #e6edf3">:</span>
                <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">k,</span> <span style="color: #e6edf3">v</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">obj</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #79c0ff">__dict__</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items():</span>
                    <span style="color: #e6edf3">size</span> <span style="color: #ff7b72; font-weight: bold">+=</span> <span style="color: #e6edf3">get_size(k,</span> <span style="color: #e6edf3">new_max_depth,</span> <span style="color: #e6edf3">seen)</span>
                    <span style="color: #e6edf3">size</span> <span style="color: #ff7b72; font-weight: bold">+=</span> <span style="color: #e6edf3">get_size(v,</span> <span style="color: #e6edf3">new_max_depth,</span> <span style="color: #e6edf3">seen)</span>
                <span style="color: #ff7b72">break</span>
    <span style="color: #8b949e; font-style: italic"># If the object is a mapping (like a dictionary), we want to measure the size of its items</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">isinstance(obj,</span> <span style="color: #e6edf3">Mapping):</span>
        <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">suppress(</span><span style="color: #f0883e; font-weight: bold">StopIteration</span><span style="color: #e6edf3">):</span>
            <span style="color: #e6edf3">k,</span> <span style="color: #e6edf3">v</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">next(iter(obj</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items()))</span>
            <span style="color: #e6edf3">size</span> <span style="color: #ff7b72; font-weight: bold">+=</span> <span style="color: #e6edf3">(get_size(k,</span> <span style="color: #e6edf3">new_max_depth,</span> <span style="color: #e6edf3">seen)</span> <span style="color: #ff7b72; font-weight: bold">+</span> <span style="color: #e6edf3">get_size(v,</span> <span style="color: #e6edf3">new_max_depth,</span> <span style="color: #e6edf3">seen))</span> <span style="color: #ff7b72; font-weight: bold">*</span> <span style="color: #e6edf3">len(obj)</span>
    <span style="color: #8b949e; font-style: italic"># If the object is a container (like a list or tuple) but not a string or bytes-like object</span>
    <span style="color: #ff7b72">elif</span> <span style="color: #e6edf3">isinstance(obj,</span> <span style="color: #e6edf3">(list,</span> <span style="color: #e6edf3">tuple,</span> <span style="color: #e6edf3">set)):</span>
        <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">suppress(</span><span style="color: #f0883e; font-weight: bold">StopIteration</span><span style="color: #e6edf3">):</span>
            <span style="color: #e6edf3">size</span> <span style="color: #ff7b72; font-weight: bold">+=</span> <span style="color: #e6edf3">get_size(next(iter(obj)),</span> <span style="color: #e6edf3">new_max_depth,</span> <span style="color: #e6edf3">seen)</span> <span style="color: #ff7b72; font-weight: bold">*</span> <span style="color: #e6edf3">len(obj)</span>
    <span style="color: #8b949e; font-style: italic"># If the object has __slots__, we want to measure the size of the attributes in __slots__</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">hasattr(obj,</span> <span style="color: #a5d6ff">"__slots__"</span><span style="color: #e6edf3">):</span>
        <span style="color: #e6edf3">size</span> <span style="color: #ff7b72; font-weight: bold">+=</span> <span style="color: #e6edf3">sum(get_size(getattr(obj,</span> <span style="color: #e6edf3">s),</span> <span style="color: #e6edf3">new_max_depth,</span> <span style="color: #e6edf3">seen)</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">s</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">obj</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #79c0ff">__slots__</span> <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">hasattr(obj,</span> <span style="color: #e6edf3">s))</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">size</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.get_traceback_details">
<span class="doc doc-object-name doc-function-name">get_traceback_details</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">get_traceback_details(e)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Retrieves detailed information from the traceback of an exception.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>e</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/exceptions.html#BaseException">BaseException</a></code>)
        –
        <div class="doc-md-description">
<p>The exception for which to get traceback details.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>tuple</code></b>        –
        <div class="doc-md-description">
<p>A tuple containing filename (str), line number (int), and function name (str) where the exception was raised.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
<span style="color: #8b949e">... </span>    <span style="color: #ff7b72">raise</span> <span style="color: #f0883e; font-weight: bold">ValueError</span><span style="color: #e6edf3">(</span><span style="color: #a5d6ff">"This is a value error"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">... </span><span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">ValueError</span> <span style="color: #ff7b72">as</span> <span style="color: #e6edf3">e:</span>
<span style="color: #8b949e">... </span>    <span style="color: #e6edf3">filename,</span> <span style="color: #e6edf3">lineno,</span> <span style="color: #e6edf3">funcname</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">get_traceback_details(e)</span>
<span style="color: #8b949e">... </span>    <span style="color: #e6edf3">print(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"File: {</span><span style="color: #e6edf3">filename</span><span style="color: #a5d6ff">}, Line: {</span><span style="color: #e6edf3">lineno</span><span style="color: #a5d6ff">}, Function: {</span><span style="color: #e6edf3">funcname</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">File: &lt;stdin&gt;, Line: 2, Function: &lt;module&gt;</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2337</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2338</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2339</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2340</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2341</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2342</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2343</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2344</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2345</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2346</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2347</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2348</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2349</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2350</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2351</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2352</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2353</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2354</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2355</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2356</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2357</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2358</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2359</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2360</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">get_traceback_details</span><span style="color: #e6edf3">(e):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Retrieves detailed information from the traceback of an exception.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        e (BaseException): The exception for which to get traceback details.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        tuple: A tuple containing filename (str), line number (int), and function name (str) where the exception was raised.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; try:</span>
<span style="color: #a5d6ff">        ...     raise ValueError("This is a value error")</span>
<span style="color: #a5d6ff">        ... except ValueError as e:</span>
<span style="color: #a5d6ff">        ...     filename, lineno, funcname = get_traceback_details(e)</span>
<span style="color: #a5d6ff">        ...     print(f"File: {filename}, Line: {lineno}, Function: {funcname}")</span>
<span style="color: #a5d6ff">        File: &lt;stdin&gt;, Line: 2, Function: &lt;module&gt;</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">tb</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">traceback</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">extract_tb(e</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">__traceback__)</span>
    <span style="color: #e6edf3">last_frame</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">tb[</span><span style="color: #ff7b72; font-weight: bold">-</span><span style="color: #a5d6ff">1</span><span style="color: #e6edf3">]</span>  <span style="color: #8b949e; font-style: italic"># Get the last frame in the traceback (the one where the exception was raised)</span>
    <span style="color: #e6edf3">filename</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">last_frame</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">filename</span>
    <span style="color: #e6edf3">lineno</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">last_frame</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">lineno</span>
    <span style="color: #e6edf3">funcname</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">last_frame</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">filename,</span> <span style="color: #e6edf3">lineno,</span> <span style="color: #e6edf3">funcname</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.grouper">
<span class="doc doc-object-name doc-function-name">grouper</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">grouper(iterable,</span> <span style="color: #e6edf3">n)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Grouper groups an iterable into chunks of a given size.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>iterable</code></b>
            (<code>iterable</code>)
        –
        <div class="doc-md-description">
<p>The iterable to be chunked.</p>
</div>
</li>
<li class="field-body">
<b><code>n</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a></code>)
        –
        <div class="doc-md-description">
<p>The size of each chunk.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>iterator</code></b>        –
        <div class="doc-md-description">
<p>An iterator that produces lists of elements from the original iterable, each of length <code>n</code> or less.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">list(grouper(</span><span style="color: #a5d6ff">'ABCDEFG'</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">3</span><span style="color: #e6edf3">))</span>
<span style="color: #8b949e">[['A', 'B', 'C'], ['D', 'E', 'F'], ['G']]</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1461</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1462</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1463</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1464</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1465</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1466</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1467</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1468</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1469</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1470</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1471</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1472</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1473</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1474</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1475</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1476</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1477</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1478</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">grouper</span><span style="color: #e6edf3">(iterable,</span> <span style="color: #e6edf3">n):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Grouper groups an iterable into chunks of a given size.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        iterable (iterable): The iterable to be chunked.</span>
<span style="color: #a5d6ff">        n (int): The size of each chunk.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        iterator: An iterator that produces lists of elements from the original iterable, each of length `n` or less.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; list(grouper('ABCDEFG', 3))</span>
<span style="color: #a5d6ff">        [['A', 'B', 'C'], ['D', 'E', 'F'], ['G']]</span>
<span style="color: #a5d6ff">    """</span>

    <span style="color: #e6edf3">iterable</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">iter(iterable)</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">iter(</span><span style="color: #ff7b72">lambda</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">list(islice(iterable,</span> <span style="color: #e6edf3">n)),</span> <span style="color: #e6edf3">[])</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.host_in_host">
<span class="doc doc-object-name doc-function-name">host_in_host</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">host_in_host(host1,</span> <span style="color: #e6edf3">host2)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Checks if host1 is included within host2, either as a subdomain, IP, or IP network.
Used for scope calculations/decisions within BBOT.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>host1</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a> or <a class="autorefs autorefs-external" title="ipaddress.IPv4Address" href="https://docs.python.org/3.11/library/ipaddress.html#ipaddress.IPv4Address">IPv4Address</a> or <a class="autorefs autorefs-external" title="ipaddress.IPv6Address" href="https://docs.python.org/3.11/library/ipaddress.html#ipaddress.IPv6Address">IPv6Address</a> or <a class="autorefs autorefs-external" title="ipaddress.IPv4Network" href="https://docs.python.org/3.11/library/ipaddress.html#ipaddress.IPv4Network">IPv4Network</a> or <a class="autorefs autorefs-external" title="ipaddress.IPv6Network" href="https://docs.python.org/3.11/library/ipaddress.html#ipaddress.IPv6Network">IPv6Network</a></code>)
        –
        <div class="doc-md-description">
<p>The host to check for inclusion within host2.</p>
</div>
</li>
<li class="field-body">
<b><code>host2</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a> or <a class="autorefs autorefs-external" title="ipaddress.IPv4Address" href="https://docs.python.org/3.11/library/ipaddress.html#ipaddress.IPv4Address">IPv4Address</a> or <a class="autorefs autorefs-external" title="ipaddress.IPv6Address" href="https://docs.python.org/3.11/library/ipaddress.html#ipaddress.IPv6Address">IPv6Address</a> or <a class="autorefs autorefs-external" title="ipaddress.IPv4Network" href="https://docs.python.org/3.11/library/ipaddress.html#ipaddress.IPv4Network">IPv4Network</a> or <a class="autorefs autorefs-external" title="ipaddress.IPv6Network" href="https://docs.python.org/3.11/library/ipaddress.html#ipaddress.IPv6Network">IPv6Network</a></code>)
        –
        <div class="doc-md-description">
<p>The host within which to check for the inclusion of host1.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>bool</code></b>        –
        <div class="doc-md-description">
<p>True if host1 is included in host2, otherwise False.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">host_in_host(</span><span style="color: #a5d6ff">"www.evilcorp.com"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"evilcorp.com"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">True</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">host_in_host(</span><span style="color: #a5d6ff">"evilcorp.com"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"www.evilcorp.com"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">False</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">host_in_host(ipaddress</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">IPv6Address(</span><span style="color: #a5d6ff">'dead::beef'</span><span style="color: #e6edf3">),</span> <span style="color: #e6edf3">ipaddress</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">IPv6Network(</span><span style="color: #a5d6ff">'dead::/64'</span><span style="color: #e6edf3">))</span>
<span style="color: #8b949e">True</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">host_in_host(ipaddress</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">IPv4Address(</span><span style="color: #a5d6ff">'192.168.1.1'</span><span style="color: #e6edf3">),</span> <span style="color: #e6edf3">ipaddress</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">IPv4Network(</span><span style="color: #a5d6ff">'10.0.0.0/8'</span><span style="color: #e6edf3">))</span>
<span style="color: #8b949e">False</span>
</code></pre></div>
<details class="notes" open="">
<summary>Notes</summary>
<ul>
<li>If checking an IP address/network, you MUST FIRST convert your IP into an ipaddress object (e.g. via <code>make_ip_type()</code>) before passing it to this function.</li>
</ul>
</details>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">621</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">622</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">623</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">624</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">625</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">626</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">627</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">628</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">629</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">630</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">631</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">632</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">633</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">634</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">635</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">636</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">637</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">638</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">639</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">640</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">641</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">642</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">643</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">644</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">645</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">646</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">647</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">648</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">649</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">650</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">651</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">652</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">653</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">654</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">655</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">656</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">657</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">658</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">659</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">660</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">661</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">662</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">663</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">664</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">665</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">666</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">667</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">668</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">669</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">670</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">671</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">672</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">673</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">674</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">675</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">676</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">677</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">678</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">679</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">680</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">681</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">host_in_host</span><span style="color: #e6edf3">(host1,</span> <span style="color: #e6edf3">host2):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Checks if host1 is included within host2, either as a subdomain, IP, or IP network.</span>
<span style="color: #a5d6ff">    Used for scope calculations/decisions within BBOT.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        host1 (str or ipaddress.IPv4Address or ipaddress.IPv6Address or ipaddress.IPv4Network or ipaddress.IPv6Network):</span>
<span style="color: #a5d6ff">            The host to check for inclusion within host2.</span>
<span style="color: #a5d6ff">        host2 (str or ipaddress.IPv4Address or ipaddress.IPv6Address or ipaddress.IPv4Network or ipaddress.IPv6Network):</span>
<span style="color: #a5d6ff">            The host within which to check for the inclusion of host1.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        bool: True if host1 is included in host2, otherwise False.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; host_in_host("www.evilcorp.com", "evilcorp.com")</span>
<span style="color: #a5d6ff">        True</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; host_in_host("evilcorp.com", "www.evilcorp.com")</span>
<span style="color: #a5d6ff">        False</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; host_in_host(ipaddress.IPv6Address('dead::beef'), ipaddress.IPv6Network('dead::/64'))</span>
<span style="color: #a5d6ff">        True</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; host_in_host(ipaddress.IPv4Address('192.168.1.1'), ipaddress.IPv4Network('10.0.0.0/8'))</span>
<span style="color: #a5d6ff">        False</span>

<span style="color: #a5d6ff">    Notes:</span>
<span style="color: #a5d6ff">        - If checking an IP address/network, you MUST FIRST convert your IP into an ipaddress object (e.g. via `make_ip_type()`) before passing it to this function.</span>
<span style="color: #a5d6ff">    """</span>

<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Is host1 included in host2?</span>
<span style="color: #a5d6ff">        "www.evilcorp.com" in "evilcorp.com"? --&gt; True</span>
<span style="color: #a5d6ff">        "evilcorp.com" in "www.evilcorp.com"? --&gt; False</span>
<span style="color: #a5d6ff">        IPv6Address('dead::beef') in IPv6Network('dead::/64')? --&gt; True</span>
<span style="color: #a5d6ff">        IPv4Address('192.168.1.1') in IPv4Network('10.0.0.0/8')? --&gt; False</span>

<span style="color: #a5d6ff">    Very important! Used throughout BBOT for scope calculations/decisions.</span>

<span style="color: #a5d6ff">    Works with hostnames, IPs, and IP networks.</span>
<span style="color: #a5d6ff">    """</span>

    <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">host1</span> <span style="color: #ff7b72; font-weight: bold">or</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">host2:</span>
        <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">False</span>

    <span style="color: #8b949e; font-style: italic"># check if hosts are IP types</span>
    <span style="color: #e6edf3">host1_ip_type</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">is_ip_type(host1)</span>
    <span style="color: #e6edf3">host2_ip_type</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">is_ip_type(host2)</span>
    <span style="color: #8b949e; font-style: italic"># if both hosts are IP types</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">host1_ip_type</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #e6edf3">host2_ip_type:</span>
        <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">host1</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">version</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #e6edf3">host2</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">version:</span>
            <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">False</span>
        <span style="color: #e6edf3">host1_net</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">ipaddress</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">ip_network(host1)</span>
        <span style="color: #e6edf3">host2_net</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">ipaddress</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">ip_network(host2)</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">host1_net</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">subnet_of(host2_net)</span>

    <span style="color: #8b949e; font-style: italic"># else hostnames</span>
    <span style="color: #ff7b72">elif</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">(host1_ip_type</span> <span style="color: #ff7b72; font-weight: bold">or</span> <span style="color: #e6edf3">host2_ip_type):</span>
        <span style="color: #e6edf3">host2_len</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">len(host2</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">split(</span><span style="color: #a5d6ff">"."</span><span style="color: #e6edf3">))</span>
        <span style="color: #e6edf3">host1_truncated</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">"."</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join(host1</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">split(</span><span style="color: #a5d6ff">"."</span><span style="color: #e6edf3">)[</span><span style="color: #ff7b72; font-weight: bold">-</span><span style="color: #e6edf3">host2_len:])</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">host1_truncated</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #e6edf3">host2</span>

    <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">False</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.human_timedelta">
<span class="doc doc-object-name doc-function-name">human_timedelta</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">human_timedelta(d)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Convert a TimeDelta object into a human-readable string.</p>
<p>This function takes a datetime.timedelta object and converts it into a string format that
is easier to read and understand.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>d</code></b>
            (<code><span title="datetime.datetime.timedelta">timedelta</span></code>)
        –
        <div class="doc-md-description">
<p>The TimeDelta object to convert.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>str</code></b>        –
        <div class="doc-md-description">
<p>A string representation of the TimeDelta object in human-readable form.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #ff7b72">from</span> <span style="color: #ff7b72">datetime</span> <span style="color: #ff7b72">import</span> <span style="color: #e6edf3">datetime</span>
<span style="color: #8b949e">&gt;&gt;&gt;</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">start_time</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">datetime</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">now()</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">end_time</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">datetime</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">now()</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">elapsed_time</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">end_time</span> <span style="color: #ff7b72; font-weight: bold">-</span> <span style="color: #e6edf3">start_time</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">human_timedelta(elapsed_time)</span>
<span style="color: #8b949e">'2 hours, 30 minutes, 15 seconds'</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1918</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1919</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1920</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1921</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1922</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1923</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1924</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1925</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1926</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1927</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1928</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1929</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1930</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1931</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1932</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1933</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1934</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1935</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1936</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1937</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1938</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1939</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1940</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1941</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1942</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1943</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1944</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1945</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1946</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1947</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1948</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1949</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1950</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1951</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">human_timedelta</span><span style="color: #e6edf3">(d):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Convert a TimeDelta object into a human-readable string.</span>

<span style="color: #a5d6ff">    This function takes a datetime.timedelta object and converts it into a string format that</span>
<span style="color: #a5d6ff">    is easier to read and understand.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        d (datetime.timedelta): The TimeDelta object to convert.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        str: A string representation of the TimeDelta object in human-readable form.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; from datetime import datetime</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt;</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; start_time = datetime.now()</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; end_time = datetime.now()</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; elapsed_time = end_time - start_time</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; human_timedelta(elapsed_time)</span>
<span style="color: #a5d6ff">        '2 hours, 30 minutes, 15 seconds'</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">hours,</span> <span style="color: #e6edf3">remainder</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">divmod(d</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">seconds,</span> <span style="color: #a5d6ff">3600</span><span style="color: #e6edf3">)</span>
    <span style="color: #e6edf3">minutes,</span> <span style="color: #e6edf3">seconds</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">divmod(remainder,</span> <span style="color: #a5d6ff">60</span><span style="color: #e6edf3">)</span>
    <span style="color: #e6edf3">result</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">hours:</span>
        <span style="color: #e6edf3">result</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">hours</span><span style="color: #a5d6ff">:,} hour"</span> <span style="color: #ff7b72; font-weight: bold">+</span> <span style="color: #e6edf3">(</span><span style="color: #a5d6ff">"s"</span> <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">hours</span> <span style="color: #ff7b72; font-weight: bold">&gt;</span> <span style="color: #a5d6ff">1</span> <span style="color: #ff7b72">else</span> <span style="color: #a5d6ff">""</span><span style="color: #e6edf3">))</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">minutes:</span>
        <span style="color: #e6edf3">result</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">minutes</span><span style="color: #a5d6ff">:,} minute"</span> <span style="color: #ff7b72; font-weight: bold">+</span> <span style="color: #e6edf3">(</span><span style="color: #a5d6ff">"s"</span> <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">minutes</span> <span style="color: #ff7b72; font-weight: bold">&gt;</span> <span style="color: #a5d6ff">1</span> <span style="color: #ff7b72">else</span> <span style="color: #a5d6ff">""</span><span style="color: #e6edf3">))</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">seconds:</span>
        <span style="color: #e6edf3">result</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">seconds</span><span style="color: #a5d6ff">:,} second"</span> <span style="color: #ff7b72; font-weight: bold">+</span> <span style="color: #e6edf3">(</span><span style="color: #a5d6ff">"s"</span> <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">seconds</span> <span style="color: #ff7b72; font-weight: bold">&gt;</span> <span style="color: #a5d6ff">1</span> <span style="color: #ff7b72">else</span> <span style="color: #a5d6ff">""</span><span style="color: #e6edf3">))</span>
    <span style="color: #e6edf3">ret</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">", "</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join(result)</span>
    <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">ret:</span>
        <span style="color: #e6edf3">ret</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">"0 seconds"</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">ret</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.human_to_bytes">
<span class="doc doc-object-name doc-function-name">human_to_bytes</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">human_to_bytes(filesize)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Convert a human-readable file size string to its bytes equivalent.</p>
<p>This function takes a human-readable file size string, such as "2.5GB", and converts it
to its equivalent number of bytes.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>filesize</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a> or <a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a></code>)
        –
        <div class="doc-md-description">
<p>The human-readable file size string or integer bytes value to convert.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>int</code></b>        –
        <div class="doc-md-description">
<p>The number of bytes equivalent to the input human-readable file size.</p>
</div>
</li>
</ul>
<p>Raises:</p>
<ul>
<li class="field-body">
<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/exceptions.html#ValueError">ValueError</a></code>
          –
        <div class="doc-md-description">
<p>If the input string cannot be converted to bytes.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">human_to_bytes(</span><span style="color: #a5d6ff">"23.23gb"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">24943022571</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1989</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1990</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1991</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1992</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1993</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1994</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1995</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1996</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1997</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1998</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1999</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2000</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2001</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2002</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2003</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2004</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2005</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2006</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2007</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2008</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2009</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2010</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2011</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2012</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2013</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2014</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2015</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2016</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2017</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2018</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2019</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2020</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2021</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2022</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2023</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2024</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2025</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2026</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">human_to_bytes</span><span style="color: #e6edf3">(filesize):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Convert a human-readable file size string to its bytes equivalent.</span>

<span style="color: #a5d6ff">    This function takes a human-readable file size string, such as "2.5GB", and converts it</span>
<span style="color: #a5d6ff">    to its equivalent number of bytes.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        filesize (str or int): The human-readable file size string or integer bytes value to convert.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        int: The number of bytes equivalent to the input human-readable file size.</span>

<span style="color: #a5d6ff">    Raises:</span>
<span style="color: #a5d6ff">        ValueError: If the input string cannot be converted to bytes.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; human_to_bytes("23.23gb")</span>
<span style="color: #a5d6ff">        24943022571</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">isinstance(filesize,</span> <span style="color: #e6edf3">int):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">filesize</span>
    <span style="color: #e6edf3">sizes</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[</span><span style="color: #a5d6ff">"B"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"KB"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"MB"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"GB"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"TB"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"PB"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"EB"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"ZB"</span><span style="color: #e6edf3">]</span>
    <span style="color: #e6edf3">units</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{}</span>
    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">count,</span> <span style="color: #e6edf3">size</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">enumerate(sizes):</span>
        <span style="color: #e6edf3">size_increment</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">pow(</span><span style="color: #a5d6ff">1024</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">count)</span>
        <span style="color: #e6edf3">units[size]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">size_increment</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">len(size)</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #a5d6ff">2</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">units[size[</span><span style="color: #a5d6ff">0</span><span style="color: #e6edf3">]]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">size_increment</span>
    <span style="color: #e6edf3">match</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">filesize_regex</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">match(filesize)</span>
    <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">match:</span>
            <span style="color: #e6edf3">num,</span> <span style="color: #e6edf3">size</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">match</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">groups()</span>
            <span style="color: #e6edf3">size</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">size</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">upper()</span>
            <span style="color: #e6edf3">size_increment</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">units[size]</span>
            <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">int(float(num)</span> <span style="color: #ff7b72; font-weight: bold">*</span> <span style="color: #e6edf3">size_increment)</span>
    <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">KeyError</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">pass</span>
    <span style="color: #ff7b72">raise</span> <span style="color: #f0883e; font-weight: bold">ValueError</span><span style="color: #e6edf3">(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">'Unable to convert filesize "{</span><span style="color: #e6edf3">filesize</span><span style="color: #a5d6ff">}" to bytes'</span><span style="color: #e6edf3">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.ip_network_parents">
<span class="doc doc-object-name doc-function-name">ip_network_parents</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">ip_network_parents(i,</span> <span style="color: #e6edf3">include_self</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">False</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Generates all parent IP networks for a given IP address or network, optionally including the network itself.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>i</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a> or <a class="autorefs autorefs-external" title="ipaddress.IPv4Network" href="https://docs.python.org/3.11/library/ipaddress.html#ipaddress.IPv4Network">IPv4Network</a> / <a class="autorefs autorefs-external" title="ipaddress.IPv6Network" href="https://docs.python.org/3.11/library/ipaddress.html#ipaddress.IPv6Network">IPv6Network</a></code>)
        –
        <div class="doc-md-description">
<p>The IP address or network to find parents for.</p>
</div>
</li>
<li class="field-body">
<b><code>include_self</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#bool">bool</a></code>, default:
                <code>False</code>
)
        –
        <div class="doc-md-description">
<p>Whether to include the network itself in the result. Default is False.</p>
</div>
</li>
</ul>
<p>Yields:</p>
<ul>
<li class="field-body">
        –
        <div class="doc-md-description">
<p>ipaddress.IPv4Network or ipaddress.IPv6Network: Parent IP networks in descending order of prefix length.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">list(ip_network_parents(</span><span style="color: #a5d6ff">"192.168.1.1"</span><span style="color: #e6edf3">))</span>
<span style="color: #8b949e">[ipaddress.IPv4Network('192.168.1.0/31'), ipaddress.IPv4Network('192.168.1.0/30'), ... , ipaddress.IPv4Network('0.0.0.0/0')]</span>
</code></pre></div>
<details class="notes" open="">
<summary>Notes</summary>
<ul>
<li>Utilizes Python's built-in <code>ipaddress</code> module for network operations.</li>
</ul>
</details>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">463</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">464</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">465</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">466</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">467</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">468</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">469</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">470</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">471</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">472</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">473</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">474</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">475</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">476</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">477</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">478</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">479</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">480</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">481</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">482</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">483</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">ip_network_parents</span><span style="color: #e6edf3">(i,</span> <span style="color: #e6edf3">include_self</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Generates all parent IP networks for a given IP address or network, optionally including the network itself.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        i (str or ipaddress.IPv4Network/ipaddress.IPv6Network): The IP address or network to find parents for.</span>
<span style="color: #a5d6ff">        include_self (bool, optional): Whether to include the network itself in the result. Default is False.</span>

<span style="color: #a5d6ff">    Yields:</span>
<span style="color: #a5d6ff">        ipaddress.IPv4Network or ipaddress.IPv6Network: Parent IP networks in descending order of prefix length.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; list(ip_network_parents("192.168.1.1"))</span>
<span style="color: #a5d6ff">        [ipaddress.IPv4Network('192.168.1.0/31'), ipaddress.IPv4Network('192.168.1.0/30'), ... , ipaddress.IPv4Network('0.0.0.0/0')]</span>

<span style="color: #a5d6ff">    Notes:</span>
<span style="color: #a5d6ff">        - Utilizes Python's built-in `ipaddress` module for network operations.</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">net</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">ipaddress</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">ip_network(i,</span> <span style="color: #e6edf3">strict</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">)</span>
    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">i</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">range(net</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">prefixlen</span> <span style="color: #ff7b72; font-weight: bold">-</span> <span style="color: #e6edf3">(</span><span style="color: #a5d6ff">0</span> <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">include_self</span> <span style="color: #ff7b72">else</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">),</span> <span style="color: #ff7b72; font-weight: bold">-</span><span style="color: #a5d6ff">1</span><span style="color: #e6edf3">,</span> <span style="color: #ff7b72; font-weight: bold">-</span><span style="color: #a5d6ff">1</span><span style="color: #e6edf3">):</span>
        <span style="color: #ff7b72">yield</span> <span style="color: #e6edf3">ipaddress</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">ip_network(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">net</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">network_address</span><span style="color: #a5d6ff">}/{</span><span style="color: #e6edf3">i</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">strict</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.is_async_function">
<span class="doc doc-object-name doc-function-name">is_async_function</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">is_async_function(f)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Check if a given function is an asynchronous function.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>f</code></b>
            (<code>function</code>)
        –
        <div class="doc-md-description">
<p>The function to check.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>bool</code></b>        –
        <div class="doc-md-description">
<p>True if the function is asynchronous, False otherwise.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">foo</span><span style="color: #e6edf3">():</span>
<span style="color: #8b949e">... </span>    <span style="color: #ff7b72">pass</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">is_async_function(foo)</span>
<span style="color: #8b949e">True</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2261</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2262</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2263</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2264</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2265</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2266</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2267</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2268</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2269</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2270</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2271</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2272</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2273</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2274</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2275</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2276</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2277</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">is_async_function</span><span style="color: #e6edf3">(f):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Check if a given function is an asynchronous function.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        f (function): The function to check.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        bool: True if the function is asynchronous, False otherwise.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; async def foo():</span>
<span style="color: #a5d6ff">        ...     pass</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; is_async_function(foo)</span>
<span style="color: #a5d6ff">        True</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">inspect</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">iscoroutinefunction(f)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.is_dns_name">
<span class="doc doc-object-name doc-function-name">is_dns_name</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">is_dns_name(d)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Determines if the given string is a valid DNS name.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>d</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>The string to be checked.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>bool</code></b>        –
        <div class="doc-md-description">
<p>True if the string is a valid DNS name, False otherwise.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">is_dns_name(</span><span style="color: #a5d6ff">'www.example.com'</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">True</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">is_dns_name(</span><span style="color: #a5d6ff">'localhost'</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">True</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">is_dns_name(</span><span style="color: #a5d6ff">'192.168.1.1'</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">False</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">507</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">508</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">509</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">510</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">511</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">512</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">513</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">514</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">515</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">516</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">517</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">518</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">519</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">520</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">521</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">522</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">523</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">524</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">525</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">526</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">527</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">528</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">529</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">530</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">531</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">532</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">is_dns_name</span><span style="color: #e6edf3">(d):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Determines if the given string is a valid DNS name.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        d (str): The string to be checked.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        bool: True if the string is a valid DNS name, False otherwise.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; is_dns_name('www.example.com')</span>
<span style="color: #a5d6ff">        True</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; is_dns_name('localhost')</span>
<span style="color: #a5d6ff">        True</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; is_dns_name('192.168.1.1')</span>
<span style="color: #a5d6ff">        False</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">is_ip(d):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">False</span>
    <span style="color: #e6edf3">d</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">smart_decode(d)</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">bbot_regexes</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">hostname_regex</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">match(d):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">True</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">bbot_regexes</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">dns_name_regex</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">match(d):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">True</span>
    <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">False</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.is_domain">
<span class="doc doc-object-name doc-function-name">is_domain</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">is_domain(d)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Check if the given input represents a domain without subdomains.</p>
<p>This function takes an input string <code>d</code> and returns True if it represents a domain without any subdomains.
Otherwise, it returns False.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>d</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>The input string containing the domain.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>bool</code></b>        –
        <div class="doc-md-description">
<p>True if the input is a domain without subdomains, False otherwise.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">is_domain(</span><span style="color: #a5d6ff">"evilcorp.co.uk"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">True</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">is_domain(</span><span style="color: #a5d6ff">"www.evilcorp.co.uk"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">False</span>
</code></pre></div>
<details class="notes" open="">
<summary>Notes</summary>
<ul>
<li>Port, if present in input, is ignored.</li>
</ul>
</details>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">45</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">46</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">47</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">48</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">49</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">50</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">51</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">52</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">53</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">54</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">55</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">56</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">57</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">58</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">59</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">60</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">61</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">62</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">63</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">64</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">65</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">66</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">67</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">68</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">69</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">70</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">71</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">72</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">is_domain</span><span style="color: #e6edf3">(d):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Check if the given input represents a domain without subdomains.</span>

<span style="color: #a5d6ff">    This function takes an input string `d` and returns True if it represents a domain without any subdomains.</span>
<span style="color: #a5d6ff">    Otherwise, it returns False.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        d (str): The input string containing the domain.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        bool: True if the input is a domain without subdomains, False otherwise.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; is_domain("evilcorp.co.uk")</span>
<span style="color: #a5d6ff">        True</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; is_domain("www.evilcorp.co.uk")</span>
<span style="color: #a5d6ff">        False</span>

<span style="color: #a5d6ff">    Notes:</span>
<span style="color: #a5d6ff">        - Port, if present in input, is ignored.</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">d,</span> <span style="color: #e6edf3">_</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">split_host_port(d)</span>
    <span style="color: #e6edf3">extracted</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">tldextract(d)</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">extracted</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">domain</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">extracted</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">subdomain:</span>
        <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">True</span>
    <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">False</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.is_file">
<span class="doc doc-object-name doc-function-name">is_file</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">is_file(f)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Check if a path points to a file.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>f</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>Path to the file.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>bool</code></b>        –
        <div class="doc-md-description">
<p>True if the path is a file, False otherwise.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">is_file(</span><span style="color: #a5d6ff">"/etc/passwd"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">True</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">is_file(</span><span style="color: #a5d6ff">"/nonexistent"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">False</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2215</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2216</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2217</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2218</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2219</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2220</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2221</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2222</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2223</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2224</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2225</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2226</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2227</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2228</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2229</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2230</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2231</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2232</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2233</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2234</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">is_file</span><span style="color: #e6edf3">(f):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Check if a path points to a file.</span>

<span style="color: #a5d6ff">    Parameters:</span>
<span style="color: #a5d6ff">        f (str): Path to the file.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        bool: True if the path is a file, False otherwise.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; is_file("/etc/passwd")</span>
<span style="color: #a5d6ff">        True</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; is_file("/nonexistent")</span>
<span style="color: #a5d6ff">        False</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">suppress(</span><span style="color: #f0883e; font-weight: bold">Exception</span><span style="color: #e6edf3">):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">Path(f)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">is_file()</span>
    <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">False</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.is_ip">
<span class="doc doc-object-name doc-function-name">is_ip</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">is_ip(d,</span> <span style="color: #e6edf3">version</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Checks if the given string or object represents a valid IP address.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>d</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a> or <span title="ipaddress.IPvXAddress">IPvXAddress</span></code>)
        –
        <div class="doc-md-description">
<p>The IP address to check.</p>
</div>
</li>
<li class="field-body">
<b><code>version</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a></code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
<p>The IP version to validate (4 or 6). Default is None.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>bool</code></b>        –
        <div class="doc-md-description">
<p>True if the string or object is a valid IP address, False otherwise.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">is_ip(</span><span style="color: #a5d6ff">'192.168.1.1'</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">True</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">is_ip(</span><span style="color: #a5d6ff">'bad::c0de'</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">version</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">6</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">True</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">is_ip(</span><span style="color: #a5d6ff">'bad::c0de'</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">version</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">4</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">False</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">is_ip(</span><span style="color: #a5d6ff">'evilcorp.com'</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">False</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">535</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">536</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">537</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">538</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">539</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">540</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">541</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">542</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">543</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">544</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">545</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">546</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">547</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">548</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">549</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">550</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">551</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">552</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">553</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">554</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">555</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">556</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">557</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">558</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">559</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">560</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">561</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">562</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">563</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">564</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">565</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">is_ip</span><span style="color: #e6edf3">(d,</span> <span style="color: #e6edf3">version</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Checks if the given string or object represents a valid IP address.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        d (str or ipaddress.IPvXAddress): The IP address to check.</span>
<span style="color: #a5d6ff">        version (int, optional): The IP version to validate (4 or 6). Default is None.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        bool: True if the string or object is a valid IP address, False otherwise.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; is_ip('192.168.1.1')</span>
<span style="color: #a5d6ff">        True</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; is_ip('bad::c0de', version=6)</span>
<span style="color: #a5d6ff">        True</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; is_ip('bad::c0de', version=4)</span>
<span style="color: #a5d6ff">        False</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; is_ip('evilcorp.com')</span>
<span style="color: #a5d6ff">        False</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">isinstance(d,</span> <span style="color: #e6edf3">(ipaddress</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">IPv4Address,</span> <span style="color: #e6edf3">ipaddress</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">IPv6Address)):</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">version</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span> <span style="color: #ff7b72; font-weight: bold">or</span> <span style="color: #e6edf3">version</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #e6edf3">d</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">version:</span>
            <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">True</span>
    <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">ip</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">ipaddress</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">ip_address(d)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">version</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span> <span style="color: #ff7b72; font-weight: bold">or</span> <span style="color: #e6edf3">ip</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">version</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #e6edf3">version:</span>
            <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">True</span>
    <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">Exception</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">pass</span>
    <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">False</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.is_ip_type">
<span class="doc doc-object-name doc-function-name">is_ip_type</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">is_ip_type(i)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Checks if the given object is an instance of an IPv4 or IPv6 type from the ipaddress module.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>i</code></b>
            (<code><span title="ipaddress._BaseV4">_BaseV4</span> or <span title="ipaddress._BaseV6">_BaseV6</span></code>)
        –
        <div class="doc-md-description">
<p>The IP object to check.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>bool</code></b>        –
        <div class="doc-md-description">
<p>True if the object is an instance of ipaddress._BaseV4 or ipaddress._BaseV6, False otherwise.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">is_ip_type(ipaddress</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">IPv6Address(</span><span style="color: #a5d6ff">'dead::beef'</span><span style="color: #e6edf3">))</span>
<span style="color: #8b949e">True</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">is_ip_type(ipaddress</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">IPv4Network(</span><span style="color: #a5d6ff">'192.168.1.0/24'</span><span style="color: #e6edf3">))</span>
<span style="color: #8b949e">True</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">is_ip_type(</span><span style="color: #a5d6ff">"192.168.1.0/24"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">False</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">568</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">569</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">570</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">571</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">572</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">573</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">574</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">575</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">576</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">577</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">578</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">579</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">580</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">581</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">582</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">583</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">584</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">585</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">586</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">is_ip_type</span><span style="color: #e6edf3">(i):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Checks if the given object is an instance of an IPv4 or IPv6 type from the ipaddress module.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        i (ipaddress._BaseV4 or ipaddress._BaseV6): The IP object to check.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        bool: True if the object is an instance of ipaddress._BaseV4 or ipaddress._BaseV6, False otherwise.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; is_ip_type(ipaddress.IPv6Address('dead::beef'))</span>
<span style="color: #a5d6ff">        True</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; is_ip_type(ipaddress.IPv4Network('192.168.1.0/24'))</span>
<span style="color: #a5d6ff">        True</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; is_ip_type("192.168.1.0/24")</span>
<span style="color: #a5d6ff">        False</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">isinstance(i,</span> <span style="color: #e6edf3">ipaddress</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_BaseV4)</span> <span style="color: #ff7b72; font-weight: bold">or</span> <span style="color: #e6edf3">isinstance(i,</span> <span style="color: #e6edf3">ipaddress</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_BaseV6)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.is_port">
<span class="doc doc-object-name doc-function-name">is_port</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">is_port(p)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Checks if the given string represents a valid port number.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>p</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a> or <a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a></code>)
        –
        <div class="doc-md-description">
<p>The port number to check.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>bool</code></b>        –
        <div class="doc-md-description">
<p>True if the port number is valid, False otherwise.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">is_port(</span><span style="color: #a5d6ff">'80'</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">True</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">is_port(</span><span style="color: #a5d6ff">'70000'</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">False</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">486</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">487</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">488</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">489</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">490</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">491</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">492</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">493</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">494</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">495</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">496</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">497</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">498</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">499</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">500</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">501</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">502</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">503</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">504</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">is_port</span><span style="color: #e6edf3">(p):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Checks if the given string represents a valid port number.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        p (str or int): The port number to check.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        bool: True if the port number is valid, False otherwise.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; is_port('80')</span>
<span style="color: #a5d6ff">        True</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; is_port('70000')</span>
<span style="color: #a5d6ff">        False</span>
<span style="color: #a5d6ff">    """</span>

    <span style="color: #e6edf3">p</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">str(p)</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">p</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #e6edf3">p</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">isdigit()</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #a5d6ff">0</span> <span style="color: #ff7b72; font-weight: bold">&lt;=</span> <span style="color: #e6edf3">int(p)</span> <span style="color: #ff7b72; font-weight: bold">&lt;=</span> <span style="color: #a5d6ff">65535</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.is_ptr">
<span class="doc doc-object-name doc-function-name">is_ptr</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">is_ptr(d)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Check if the given input represents a PTR record domain.</p>
<p>This function takes an input string <code>d</code> and returns True if it matches the PTR record format.
Otherwise, it returns False.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>d</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>The input string potentially representing a PTR record domain.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>bool</code></b>        –
        <div class="doc-md-description">
<p>True if the input matches PTR record format, False otherwise.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">is_ptr(</span><span style="color: #a5d6ff">"wsc-11-22-33-44.evilcorp.com"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">True</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">is_ptr(</span><span style="color: #a5d6ff">"www2.evilcorp.com"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">False</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">105</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">106</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">107</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">108</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">109</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">110</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">111</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">112</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">113</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">114</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">115</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">116</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">117</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">118</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">119</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">120</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">121</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">122</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">123</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">124</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">125</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">is_ptr</span><span style="color: #e6edf3">(d):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Check if the given input represents a PTR record domain.</span>

<span style="color: #a5d6ff">    This function takes an input string `d` and returns True if it matches the PTR record format.</span>
<span style="color: #a5d6ff">    Otherwise, it returns False.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        d (str): The input string potentially representing a PTR record domain.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        bool: True if the input matches PTR record format, False otherwise.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; is_ptr("wsc-11-22-33-44.evilcorp.com")</span>
<span style="color: #a5d6ff">        True</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; is_ptr("www2.evilcorp.com")</span>
<span style="color: #a5d6ff">        False</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">bool(bbot_regexes</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">ptr_regex</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">search(str(d)))</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.is_subdomain">
<span class="doc doc-object-name doc-function-name">is_subdomain</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">is_subdomain(d)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Check if the given input represents a subdomain.</p>
<p>This function takes an input string <code>d</code> and returns True if it represents a subdomain.
Otherwise, it returns False.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>d</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>The input string containing the domain or subdomain.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>bool</code></b>        –
        <div class="doc-md-description">
<p>True if the input is a subdomain, False otherwise.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">is_subdomain(</span><span style="color: #a5d6ff">"www.evilcorp.co.uk"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">True</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">is_subdomain(</span><span style="color: #a5d6ff">"evilcorp.co.uk"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">False</span>
</code></pre></div>
<details class="notes" open="">
<summary>Notes</summary>
<ul>
<li>Port, if present in input, is ignored.</li>
</ul>
</details>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 75</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 76</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 77</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 78</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 79</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 80</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 81</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 82</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 83</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 84</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 85</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 86</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 87</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 88</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 89</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 90</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 91</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 92</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 93</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 94</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 95</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 96</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 97</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 98</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 99</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">100</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">101</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">102</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">is_subdomain</span><span style="color: #e6edf3">(d):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Check if the given input represents a subdomain.</span>

<span style="color: #a5d6ff">    This function takes an input string `d` and returns True if it represents a subdomain.</span>
<span style="color: #a5d6ff">    Otherwise, it returns False.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        d (str): The input string containing the domain or subdomain.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        bool: True if the input is a subdomain, False otherwise.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; is_subdomain("www.evilcorp.co.uk")</span>
<span style="color: #a5d6ff">        True</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; is_subdomain("evilcorp.co.uk")</span>
<span style="color: #a5d6ff">        False</span>

<span style="color: #a5d6ff">    Notes:</span>
<span style="color: #a5d6ff">        - Port, if present in input, is ignored.</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">d,</span> <span style="color: #e6edf3">_</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">split_host_port(d)</span>
    <span style="color: #e6edf3">extracted</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">tldextract(d)</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">extracted</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">domain</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #e6edf3">extracted</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">subdomain:</span>
        <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">True</span>
    <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">False</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.is_uri">
<span class="doc doc-object-name doc-function-name">is_uri</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">is_uri(u,</span> <span style="color: #e6edf3">return_scheme</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">False</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Check if the given input represents a URI and optionally return its scheme.</p>
<p>This function takes an input string <code>u</code> and returns True if it matches a URI format.
When <code>return_scheme</code> is True, it returns the URI scheme instead of a boolean.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>u</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>The input string potentially representing a URI.</p>
</div>
</li>
<li class="field-body">
<b><code>return_scheme</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#bool">bool</a></code>, default:
                <code>False</code>
)
        –
        <div class="doc-md-description">
<p>Whether to return the URI scheme. Defaults to False.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
        –
        <div class="doc-md-description">
<p>Union[bool, str]: True if the input matches a URI format; the URI scheme if <code>return_scheme</code> is True.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">is_uri(</span><span style="color: #a5d6ff">"http://evilcorp.com"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">True</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">is_uri(</span><span style="color: #a5d6ff">"ftp://evilcorp.com"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">True</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">is_uri(</span><span style="color: #a5d6ff">"evilcorp.com"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">False</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">is_uri(</span><span style="color: #a5d6ff">"ftp://evilcorp.com"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">return_scheme</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">"ftp"</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">158</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">159</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">160</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">161</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">162</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">163</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">164</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">165</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">166</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">167</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">168</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">169</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">170</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">171</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">172</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">173</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">174</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">175</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">176</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">177</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">178</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">179</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">180</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">181</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">182</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">183</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">184</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">185</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">186</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">187</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">188</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">189</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">190</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">is_uri</span><span style="color: #e6edf3">(u,</span> <span style="color: #e6edf3">return_scheme</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Check if the given input represents a URI and optionally return its scheme.</span>

<span style="color: #a5d6ff">    This function takes an input string `u` and returns True if it matches a URI format.</span>
<span style="color: #a5d6ff">    When `return_scheme` is True, it returns the URI scheme instead of a boolean.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        u (str): The input string potentially representing a URI.</span>
<span style="color: #a5d6ff">        return_scheme (bool, optional): Whether to return the URI scheme. Defaults to False.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        Union[bool, str]: True if the input matches a URI format; the URI scheme if `return_scheme` is True.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; is_uri("http://evilcorp.com")</span>
<span style="color: #a5d6ff">        True</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; is_uri("ftp://evilcorp.com")</span>
<span style="color: #a5d6ff">        True</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; is_uri("evilcorp.com")</span>
<span style="color: #a5d6ff">        False</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; is_uri("ftp://evilcorp.com", return_scheme=True)</span>
<span style="color: #a5d6ff">        "ftp"</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">match</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">uri_regex</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">match(u)</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">return_scheme:</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">match:</span>
            <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">match</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">groups()[</span><span style="color: #a5d6ff">0</span><span style="color: #e6edf3">]</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">lower()</span>
        <span style="color: #ff7b72">return</span> <span style="color: #a5d6ff">""</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">bool(match)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.is_url">
<span class="doc doc-object-name doc-function-name">is_url</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">is_url(u)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Check if the given input represents a valid URL.</p>
<p>This function takes an input string <code>u</code> and returns True if it matches any of the predefined URL formats.
Otherwise, it returns False.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>u</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>The input string potentially representing a URL.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>bool</code></b>        –
        <div class="doc-md-description">
<p>True if the input matches a valid URL format, False otherwise.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">is_url(</span><span style="color: #a5d6ff">"https://evilcorp.com"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">True</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">is_url(</span><span style="color: #a5d6ff">"not-a-url"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">False</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">128</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">129</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">130</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">131</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">132</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">133</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">134</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">135</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">136</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">137</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">138</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">139</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">140</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">141</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">142</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">143</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">144</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">145</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">146</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">147</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">148</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">149</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">150</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">151</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">152</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">is_url</span><span style="color: #e6edf3">(u):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Check if the given input represents a valid URL.</span>

<span style="color: #a5d6ff">    This function takes an input string `u` and returns True if it matches any of the predefined URL formats.</span>
<span style="color: #a5d6ff">    Otherwise, it returns False.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        u (str): The input string potentially representing a URL.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        bool: True if the input matches a valid URL format, False otherwise.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; is_url("https://evilcorp.com")</span>
<span style="color: #a5d6ff">        True</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; is_url("not-a-url")</span>
<span style="color: #a5d6ff">        False</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">u</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">str(u)</span>
    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">r</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">bbot_regexes</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">event_type_regexes[</span><span style="color: #a5d6ff">"URL"</span><span style="color: #e6edf3">]:</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">r</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">match(u):</span>
            <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">True</span>
    <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">False</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.kill_children">
<span class="doc doc-object-name doc-function-name">kill_children</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">kill_children(parent_pid</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">sig</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">signal</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">SIGTERM)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Forgive me father for I have sinned</p>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1060</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1061</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1062</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1063</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1064</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1065</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1066</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1067</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1068</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1069</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1070</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1071</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1072</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1073</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1074</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1075</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1076</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1077</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1078</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">kill_children</span><span style="color: #e6edf3">(parent_pid</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">sig</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">signal</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">SIGTERM):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Forgive me father for I have sinned</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">parent</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">psutil</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">Process(parent_pid)</span>
    <span style="color: #ff7b72">except</span> <span style="color: #e6edf3">psutil</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">NoSuchProcess:</span>
        <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"No such PID: {</span><span style="color: #e6edf3">parent_pid</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
    <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Killing children of process ID {</span><span style="color: #e6edf3">parent</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">pid</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
    <span style="color: #e6edf3">children</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">parent</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">children(recursive</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">)</span>
    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">child</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">children:</span>
        <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Killing child with PID {</span><span style="color: #e6edf3">child</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">pid</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">child</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name</span> <span style="color: #ff7b72; font-weight: bold">!=</span> <span style="color: #a5d6ff">"python"</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">child</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">send_signal(sig)</span>
            <span style="color: #ff7b72">except</span> <span style="color: #e6edf3">psutil</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">NoSuchProcess:</span>
                <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"No such PID: {</span><span style="color: #e6edf3">child</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">pid</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
            <span style="color: #ff7b72">except</span> <span style="color: #e6edf3">psutil</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">AccessDenied:</span>
                <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Error killing PID: {</span><span style="color: #e6edf3">child</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">pid</span><span style="color: #a5d6ff">} - access denied"</span><span style="color: #e6edf3">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.latest_mtime">
<span class="doc doc-object-name doc-function-name">latest_mtime</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">latest_mtime(d)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Get the latest modified time of any file or sub-directory in a given directory.</p>
<p>This function takes a directory path as an argument and returns the latest modified time
of any contained file or directory, recursively. It's useful for sorting directories by
modified time for cleanup or other purposes.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>d</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a> or <a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3.11/library/pathlib.html#pathlib.Path">Path</a></code>)
        –
        <div class="doc-md-description">
<p>The directory path to search for the latest modified time.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>float</code></b>        –
        <div class="doc-md-description">
<p>The latest modified time in Unix timestamp format.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">latest_mtime(</span><span style="color: #a5d6ff">"~/.bbot/scans/mushy_susan"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">1659016928.2848816</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1627</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1628</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1629</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1630</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1631</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1632</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1633</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1634</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1635</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1636</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1637</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1638</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1639</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1640</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1641</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1642</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1643</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1644</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1645</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1646</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1647</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1648</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1649</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1650</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1651</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1652</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">latest_mtime</span><span style="color: #e6edf3">(d):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Get the latest modified time of any file or sub-directory in a given directory.</span>

<span style="color: #a5d6ff">    This function takes a directory path as an argument and returns the latest modified time</span>
<span style="color: #a5d6ff">    of any contained file or directory, recursively. It's useful for sorting directories by</span>
<span style="color: #a5d6ff">    modified time for cleanup or other purposes.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        d (str or Path): The directory path to search for the latest modified time.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        float: The latest modified time in Unix timestamp format.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; latest_mtime("~/.bbot/scans/mushy_susan")</span>
<span style="color: #a5d6ff">        1659016928.2848816</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">d</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">Path(d)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolve()</span>
    <span style="color: #e6edf3">mtimes</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[d</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">lstat()</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">st_mtime]</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">d</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">is_dir():</span>
        <span style="color: #e6edf3">to_list</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">d</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">glob(</span><span style="color: #a5d6ff">"**/*"</span><span style="color: #e6edf3">)</span>
    <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">to_list</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[d]</span>
    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">e</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">to_list:</span>
        <span style="color: #e6edf3">mtimes</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(e</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">lstat()</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">st_mtime)</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">max(mtimes)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.list_files">
<span class="doc doc-object-name doc-function-name">list_files</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">list_files(directory,</span> <span style="color: #e6edf3">filter</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">lambda</span> <span style="color: #e6edf3">:</span> <span style="color: #79c0ff">True</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Lists files in a given directory that meet a specified filter condition.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>directory</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>The directory where to list files.</p>
</div>
</li>
<li class="field-body">
<b><code>filter</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#callable">callable</a></code>, default:
                <code>lambda : True</code>
)
        –
        <div class="doc-md-description">
<p>A function to filter the files. Defaults to a lambda function that returns True for all files.</p>
</div>
</li>
</ul>
<p>Yields:</p>
<ul>
<li class="field-body">
<b><code>Path</code></b>        –
        <div class="doc-md-description">
<p>A Path object for each file that meets the filter condition.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">list(list_files(</span><span style="color: #a5d6ff">"/tmp/test"</span><span style="color: #e6edf3">))</span>
<span style="color: #8b949e">[Path('/tmp/test/file1.py'), Path('/tmp/test/file2.txt')]</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">list(list_files(</span><span style="color: #a5d6ff">"/tmp/test"</span><span style="color: #e6edf3">),</span> <span style="color: #e6edf3">filter</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #ff7b72">lambda</span> <span style="color: #e6edf3">f:</span> <span style="color: #e6edf3">f</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">suffix</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #a5d6ff">".py"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">[Path('/tmp/test/file1.py')]</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1149</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1150</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1151</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1152</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1153</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1154</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1155</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1156</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1157</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1158</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1159</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1160</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1161</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1162</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1163</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1164</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1165</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1166</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1167</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1168</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1169</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1170</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">list_files</span><span style="color: #e6edf3">(directory,</span> <span style="color: #e6edf3">filter</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #ff7b72">lambda</span> <span style="color: #e6edf3">x:</span> <span style="color: #79c0ff">True</span><span style="color: #e6edf3">):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Lists files in a given directory that meet a specified filter condition.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        directory (str): The directory where to list files.</span>
<span style="color: #a5d6ff">        filter (callable, optional): A function to filter the files. Defaults to a lambda function that returns True for all files.</span>

<span style="color: #a5d6ff">    Yields:</span>
<span style="color: #a5d6ff">        Path: A Path object for each file that meets the filter condition.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; list(list_files("/tmp/test"))</span>
<span style="color: #a5d6ff">        [Path('/tmp/test/file1.py'), Path('/tmp/test/file2.txt')]</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; list(list_files("/tmp/test"), filter=lambda f: f.suffix == ".py")</span>
<span style="color: #a5d6ff">        [Path('/tmp/test/file1.py')]</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">directory</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">Path(directory)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolve()</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">directory</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">is_dir():</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">file</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">directory</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">iterdir():</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">file</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">is_file()</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #e6edf3">filter(file):</span>
                <span style="color: #ff7b72">yield</span> <span style="color: #e6edf3">file</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.make_date">
<span class="doc doc-object-name doc-function-name">make_date</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">make_date(d</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">microseconds</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">False</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Generates a string representation of the current date and time, with optional microsecond precision.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>d</code></b>
            (<code><a class="autorefs autorefs-external" title="datetime.datetime" href="https://docs.python.org/3.11/library/datetime.html#datetime.datetime">datetime</a></code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
<p>A datetime object to convert. Defaults to the current date and time.</p>
</div>
</li>
<li class="field-body">
<b><code>microseconds</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#bool">bool</a></code>, default:
                <code>False</code>
)
        –
        <div class="doc-md-description">
<p>Whether to include microseconds. Defaults to False.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>str</code></b>        –
        <div class="doc-md-description">
<p>A string representation of the date and time, formatted as YYYYMMDD_HHMM_SS or YYYYMMDD_HHMM_SSFFFFFF if microseconds are included.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">make_date()</span>
<span style="color: #8b949e">"20220707_1325_50"</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">make_date(microseconds</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">"20220707_1330_35167617"</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1536</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1537</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1538</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1539</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1540</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1541</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1542</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1543</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1544</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1545</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1546</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1547</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1548</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1549</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1550</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1551</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1552</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1553</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1554</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1555</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1556</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1557</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1558</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">make_date</span><span style="color: #e6edf3">(d</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">microseconds</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Generates a string representation of the current date and time, with optional microsecond precision.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        d (datetime, optional): A datetime object to convert. Defaults to the current date and time.</span>
<span style="color: #a5d6ff">        microseconds (bool, optional): Whether to include microseconds. Defaults to False.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        str: A string representation of the date and time, formatted as YYYYMMDD_HHMM_SS or YYYYMMDD_HHMM_SSFFFFFF if microseconds are included.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; make_date()</span>
<span style="color: #a5d6ff">        "20220707_1325_50"</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; make_date(microseconds=True)</span>
<span style="color: #a5d6ff">        "20220707_1330_35167617"</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">f</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">"%Y%m%d_%H%M_%S"</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">microseconds:</span>
        <span style="color: #e6edf3">f</span> <span style="color: #ff7b72; font-weight: bold">+=</span> <span style="color: #a5d6ff">"%f"</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">d</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">d</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">datetime</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">now()</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">d</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">strftime(f)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.make_ip_type">
<span class="doc doc-object-name doc-function-name">make_ip_type</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">make_ip_type(s)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Convert a string to its corresponding IP address or network type.</p>
<p>This function attempts to convert the input string <code>s</code> into either an IPv4 or IPv6 address object,
or an IPv4 or IPv6 network object. If none of these conversions are possible, the original string is returned.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>s</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>The input string to be converted.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
        –
        <div class="doc-md-description">
<p>Union[IPv4Address, IPv6Address, IPv4Network, IPv6Network, str]: The converted object or original string.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">make_ip_type(</span><span style="color: #a5d6ff">"dead::beef"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">IPv6Address('dead::beef')</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">make_ip_type(</span><span style="color: #a5d6ff">"192.168.1.0/24"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">IPv4Network('192.168.1.0/24')</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">make_ip_type(</span><span style="color: #a5d6ff">"evilcorp.com"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">'evilcorp.com'</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">589</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">590</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">591</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">592</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">593</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">594</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">595</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">596</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">597</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">598</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">599</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">600</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">601</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">602</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">603</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">604</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">605</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">606</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">607</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">608</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">609</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">610</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">611</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">612</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">613</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">614</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">615</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">616</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">617</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">618</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">make_ip_type</span><span style="color: #e6edf3">(s):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Convert a string to its corresponding IP address or network type.</span>

<span style="color: #a5d6ff">    This function attempts to convert the input string `s` into either an IPv4 or IPv6 address object,</span>
<span style="color: #a5d6ff">    or an IPv4 or IPv6 network object. If none of these conversions are possible, the original string is returned.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        s (str): The input string to be converted.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        Union[IPv4Address, IPv6Address, IPv4Network, IPv6Network, str]: The converted object or original string.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; make_ip_type("dead::beef")</span>
<span style="color: #a5d6ff">        IPv6Address('dead::beef')</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; make_ip_type("192.168.1.0/24")</span>
<span style="color: #a5d6ff">        IPv4Network('192.168.1.0/24')</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; make_ip_type("evilcorp.com")</span>
<span style="color: #a5d6ff">        'evilcorp.com'</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #8b949e; font-style: italic"># IP address</span>
    <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">suppress(</span><span style="color: #f0883e; font-weight: bold">Exception</span><span style="color: #e6edf3">):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">ipaddress</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">ip_address(str(s)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">strip())</span>
    <span style="color: #8b949e; font-style: italic"># IP network</span>
    <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">suppress(</span><span style="color: #f0883e; font-weight: bold">Exception</span><span style="color: #e6edf3">):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">ipaddress</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">ip_network(str(s)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">strip(),</span> <span style="color: #e6edf3">strict</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">)</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">s</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.make_netloc">
<span class="doc doc-object-name doc-function-name">make_netloc</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">make_netloc(host,</span> <span style="color: #e6edf3">port)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Constructs a network location string from a given host and port.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>host</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>The hostname or IP address.</p>
</div>
</li>
<li class="field-body">
<b><code>port</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a></code>)
        –
        <div class="doc-md-description">
<p>The port number. If None, the port is omitted.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>str</code></b>        –
        <div class="doc-md-description">
<p>A network location string in the form 'host' or 'host:port'.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">make_netloc(</span><span style="color: #a5d6ff">"192.168.1.1"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">"192.168.1.1"</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">make_netloc(</span><span style="color: #a5d6ff">"192.168.1.1"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">443</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">"192.168.1.1:443"</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">make_netloc(</span><span style="color: #a5d6ff">"evilcorp.com"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">80</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">"evilcorp.com:80"</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">make_netloc(</span><span style="color: #a5d6ff">"dead::beef"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">"[dead::beef]"</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">make_netloc(</span><span style="color: #a5d6ff">"dead::beef"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">443</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">"[dead::beef]:443"</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1249</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1250</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1251</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1252</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1253</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1254</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1255</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1256</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1257</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1258</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1259</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1260</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1261</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1262</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1263</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1264</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1265</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1266</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1267</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1268</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1269</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1270</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1271</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1272</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1273</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1274</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1275</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1276</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1277</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1278</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1279</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">make_netloc</span><span style="color: #e6edf3">(host,</span> <span style="color: #e6edf3">port):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Constructs a network location string from a given host and port.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        host (str): The hostname or IP address.</span>
<span style="color: #a5d6ff">        port (int, optional): The port number. If None, the port is omitted.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        str: A network location string in the form 'host' or 'host:port'.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; make_netloc("192.168.1.1", None)</span>
<span style="color: #a5d6ff">        "192.168.1.1"</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; make_netloc("192.168.1.1", 443)</span>
<span style="color: #a5d6ff">        "192.168.1.1:443"</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; make_netloc("evilcorp.com", 80)</span>
<span style="color: #a5d6ff">        "evilcorp.com:80"</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; make_netloc("dead::beef", None)</span>
<span style="color: #a5d6ff">        "[dead::beef]"</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; make_netloc("dead::beef", 443)</span>
<span style="color: #a5d6ff">        "[dead::beef]:443"</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">is_ip(host,</span> <span style="color: #e6edf3">version</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">6</span><span style="color: #e6edf3">):</span>
        <span style="color: #e6edf3">host</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"[{</span><span style="color: #e6edf3">host</span><span style="color: #a5d6ff">}]"</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">port</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">host</span>
    <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">host</span><span style="color: #a5d6ff">}:{</span><span style="color: #e6edf3">port</span><span style="color: #a5d6ff">}"</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.make_table">
<span class="doc doc-object-name doc-function-name">make_table</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">make_table(</span><span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Generate a formatted table from the given rows and headers.</p>
<p>This function uses the <code>tabulate</code> package to generate a table with formatting options.
It can accept various input formats and table styles, which can be customized using optional arguments.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>*args</code></b>
        –
        <div class="doc-md-description">
<p>Positional arguments to be passed to <code>tabulate.tabulate</code>.</p>
</div>
</li>
<li class="field-body">
<b><code>**kwargs</code></b>
        –
        <div class="doc-md-description">
<p>Keyword arguments to customize table formatting.
- tablefmt (str, optional): Table format. Default is 'grid'.
- disable_numparse (bool, optional): Disable automatic number parsing. Default is True.
- maxcolwidths (int, optional): Maximum column width. Default is 40.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>str</code></b>        –
        <div class="doc-md-description">
<p>A string representing the formatted table.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">print(make_table([[</span><span style="color: #a5d6ff">"row1"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"row1"</span><span style="color: #e6edf3">],</span> <span style="color: #e6edf3">[</span><span style="color: #a5d6ff">"row2"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"row2"</span><span style="color: #e6edf3">]],</span> <span style="color: #e6edf3">[</span><span style="color: #a5d6ff">"header1"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"header2"</span><span style="color: #e6edf3">]))</span>
<span style="color: #8b949e">+-----------+-----------+</span>
<span style="color: #8b949e">| header1   | header2   |</span>
<span style="color: #8b949e">+===========+===========+</span>
<span style="color: #8b949e">| row1      | row1      |</span>
<span style="color: #8b949e">+-----------+-----------+</span>
<span style="color: #8b949e">| row2      | row2      |</span>
<span style="color: #8b949e">+-----------+-----------+</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1874</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1875</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1876</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1877</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1878</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1879</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1880</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1881</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1882</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1883</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1884</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1885</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1886</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1887</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1888</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1889</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1890</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1891</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1892</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1893</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1894</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1895</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1896</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1897</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1898</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1899</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1900</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1901</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1902</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1903</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1904</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1905</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1906</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1907</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1908</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1909</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1910</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1911</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1912</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1913</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1914</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1915</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">make_table</span><span style="color: #e6edf3">(</span><span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Generate a formatted table from the given rows and headers.</span>

<span style="color: #a5d6ff">    This function uses the `tabulate` package to generate a table with formatting options.</span>
<span style="color: #a5d6ff">    It can accept various input formats and table styles, which can be customized using optional arguments.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        *args: Positional arguments to be passed to `tabulate.tabulate`.</span>
<span style="color: #a5d6ff">        **kwargs: Keyword arguments to customize table formatting.</span>
<span style="color: #a5d6ff">            - tablefmt (str, optional): Table format. Default is 'grid'.</span>
<span style="color: #a5d6ff">            - disable_numparse (bool, optional): Disable automatic number parsing. Default is True.</span>
<span style="color: #a5d6ff">            - maxcolwidths (int, optional): Maximum column width. Default is 40.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        str: A string representing the formatted table.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; print(make_table([["row1", "row1"], ["row2", "row2"]], ["header1", "header2"]))</span>
<span style="color: #a5d6ff">        +-----------+-----------+</span>
<span style="color: #a5d6ff">        | header1   | header2   |</span>
<span style="color: #a5d6ff">        +===========+===========+</span>
<span style="color: #a5d6ff">        | row1      | row1      |</span>
<span style="color: #a5d6ff">        +-----------+-----------+</span>
<span style="color: #a5d6ff">        | row2      | row2      |</span>
<span style="color: #a5d6ff">        +-----------+-----------+</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #8b949e; font-style: italic"># fix IndexError: list index out of range</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">args</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">args[</span><span style="color: #a5d6ff">0</span><span style="color: #e6edf3">]:</span>
        <span style="color: #e6edf3">args</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">([[]],)</span> <span style="color: #ff7b72; font-weight: bold">+</span> <span style="color: #e6edf3">args[</span><span style="color: #a5d6ff">1</span><span style="color: #e6edf3">:]</span>
    <span style="color: #e6edf3">tablefmt</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">os</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">environ</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"BBOT_TABLE_FORMAT"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
    <span style="color: #e6edf3">defaults</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{</span><span style="color: #a5d6ff">"tablefmt"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">"grid"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"disable_numparse"</span><span style="color: #e6edf3">:</span> <span style="color: #79c0ff">True</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"maxcolwidths"</span><span style="color: #e6edf3">:</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">}</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">tablefmt</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">defaults</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">update({</span><span style="color: #a5d6ff">"maxcolwidths"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">40</span><span style="color: #e6edf3">})</span>
    <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">defaults</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">update({</span><span style="color: #a5d6ff">"tablefmt"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">tablefmt})</span>
    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">k,</span> <span style="color: #e6edf3">v</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">defaults</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items():</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">k</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">kwargs:</span>
            <span style="color: #e6edf3">kwargs[k]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">v</span>
    <span style="color: #8b949e; font-style: italic"># don't wrap columns in markdown</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">tablefmt</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">(</span><span style="color: #a5d6ff">"github"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"markdown"</span><span style="color: #e6edf3">):</span>
        <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">pop(</span><span style="color: #a5d6ff">"maxcolwidths"</span><span style="color: #e6edf3">)</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">tabulate(</span><span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.match_and_exit">
<span class="doc doc-object-name doc-function-name">match_and_exit</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">match_and_exit(s,</span> <span style="color: #e6edf3">choices,</span> <span style="color: #e6edf3">msg</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">loglevel</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">'HUGEWARNING'</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">exitcode</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">2</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Finds the closest match from a list of choices for a given string, logs a warning, and exits the program.</p>
<p>This function is particularly useful for CLI applications where you want to validate flags or modules.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>s</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>The string for which to find the closest match.</p>
</div>
</li>
<li class="field-body">
<b><code>choices</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#list">list</a></code>)
        –
        <div class="doc-md-description">
<p>A list of strings to compare against.</p>
</div>
</li>
<li class="field-body">
<b><code>msg</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
<p>Additional message to prepend in the warning message. Defaults to None.</p>
</div>
</li>
<li class="field-body">
<b><code>loglevel</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>, default:
                <code>'HUGEWARNING'</code>
)
        –
        <div class="doc-md-description">
<p>The log level to use for the warning message. Defaults to "HUGEWARNING".</p>
</div>
</li>
<li class="field-body">
<b><code>exitcode</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a></code>, default:
                <code>2</code>
)
        –
        <div class="doc-md-description">
<p>The exit code to use when exiting the program. Defaults to 2.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">match_and_exit(</span><span style="color: #a5d6ff">"some_module"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">[</span><span style="color: #a5d6ff">"some_mod"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"some_other_mod"</span><span style="color: #e6edf3">],</span> <span style="color: #e6edf3">msg</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"module"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e"># Output: Could not find module "some_module". Did you mean "some_mod"?</span>
<span style="color: #8b949e"># Exits with code 2</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1034</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1035</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1036</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1037</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1038</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1039</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1040</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1041</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1042</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1043</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1044</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1045</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1046</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1047</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1048</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1049</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1050</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1051</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1052</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1053</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1054</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1055</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1056</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1057</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">match_and_exit</span><span style="color: #e6edf3">(s,</span> <span style="color: #e6edf3">choices,</span> <span style="color: #e6edf3">msg</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">loglevel</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"HUGEWARNING"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">exitcode</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">2</span><span style="color: #e6edf3">):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Finds the closest match from a list of choices for a given string, logs a warning, and exits the program.</span>

<span style="color: #a5d6ff">    This function is particularly useful for CLI applications where you want to validate flags or modules.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        s (str): The string for which to find the closest match.</span>
<span style="color: #a5d6ff">        choices (list): A list of strings to compare against.</span>
<span style="color: #a5d6ff">        msg (str, optional): Additional message to prepend in the warning message. Defaults to None.</span>
<span style="color: #a5d6ff">        loglevel (str, optional): The log level to use for the warning message. Defaults to "HUGEWARNING".</span>
<span style="color: #a5d6ff">        exitcode (int, optional): The exit code to use when exiting the program. Defaults to 2.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; match_and_exit("some_module", ["some_mod", "some_other_mod"], msg="module")</span>
<span style="color: #a5d6ff">        # Output: Could not find module "some_module". Did you mean "some_mod"?</span>
<span style="color: #a5d6ff">        # Exits with code 2</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">msg</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">msg</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">""</span>
    <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">msg</span> <span style="color: #ff7b72; font-weight: bold">+=</span> <span style="color: #a5d6ff">" "</span>
    <span style="color: #e6edf3">closest</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">closest_match(s,</span> <span style="color: #e6edf3">choices)</span>
    <span style="color: #e6edf3">log_to_stderr(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">'Could not find {</span><span style="color: #e6edf3">msg</span><span style="color: #a5d6ff">}"{</span><span style="color: #e6edf3">s</span><span style="color: #a5d6ff">}". Did you mean "{</span><span style="color: #e6edf3">closest</span><span style="color: #a5d6ff">}"?'</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">level</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"HUGEWARNING"</span><span style="color: #e6edf3">)</span>
    <span style="color: #e6edf3">sys</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">exit(</span><span style="color: #a5d6ff">2</span><span style="color: #e6edf3">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.memory_status">
<span class="doc doc-object-name doc-function-name">memory_status</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">memory_status()</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Return statistics on system memory consumption.</p>
<p>The function returns a <code>psutil</code> named tuple that contains statistics on
system virtual memory usage, such as total memory, used memory, available
memory, and more.</p>
<p>Returns:</p>
<ul>
<li class="field-body">
        –
        <div class="doc-md-description">
<p>psutil._pslinux.svmem: A named tuple representing various statistics
about system virtual memory usage.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">mem</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">memory_status()</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">mem</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">available</span>
<span style="color: #8b949e">13195399168</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">mem</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">memory_status()</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">mem</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">percent</span>
<span style="color: #8b949e">79.0</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2112</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2113</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2114</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2115</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2116</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2117</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2118</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2119</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2120</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2121</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2122</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2123</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2124</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2125</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2126</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2127</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2128</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2129</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2130</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2131</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2132</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">memory_status</span><span style="color: #e6edf3">():</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Return statistics on system memory consumption.</span>

<span style="color: #a5d6ff">    The function returns a `psutil` named tuple that contains statistics on</span>
<span style="color: #a5d6ff">    system virtual memory usage, such as total memory, used memory, available</span>
<span style="color: #a5d6ff">    memory, and more.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        psutil._pslinux.svmem: A named tuple representing various statistics</span>
<span style="color: #a5d6ff">            about system virtual memory usage.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; mem = memory_status()</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; mem.available</span>
<span style="color: #a5d6ff">        13195399168</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; mem = memory_status()</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; mem.percent</span>
<span style="color: #a5d6ff">        79.0</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">psutil</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">virtual_memory()</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.mkdir">
<span class="doc doc-object-name doc-function-name">mkdir</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">mkdir(path,</span> <span style="color: #e6edf3">check_writable</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">True</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">raise_error</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">True</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Creates a directory and optionally checks if it's writable.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>path</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a> or <a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3.11/library/pathlib.html#pathlib.Path">Path</a></code>)
        –
        <div class="doc-md-description">
<p>The directory to create.</p>
</div>
</li>
<li class="field-body">
<b><code>check_writable</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#bool">bool</a></code>, default:
                <code>True</code>
)
        –
        <div class="doc-md-description">
<p>Whether to check if the directory is writable. Default is True.</p>
</div>
</li>
<li class="field-body">
<b><code>raise_error</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#bool">bool</a></code>, default:
                <code>True</code>
)
        –
        <div class="doc-md-description">
<p>Whether to raise an error if the directory creation fails. Default is True.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>bool</code></b>        –
        <div class="doc-md-description">
<p>True if the directory is successfully created (and writable, if check_writable=True); otherwise False.</p>
</div>
</li>
</ul>
<p>Raises:</p>
<ul>
<li class="field-body">
<code>DirectoryCreationError</code>
          –
        <div class="doc-md-description">
<p>Raised if the directory cannot be created and <code>raise_error=True</code>.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">mkdir(</span><span style="color: #a5d6ff">"/tmp/new_dir"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">True</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">mkdir(</span><span style="color: #a5d6ff">"/restricted_dir"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">check_writable</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">raise_error</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">False</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1500</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1501</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1502</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1503</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1504</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1505</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1506</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1507</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1508</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1509</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1510</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1511</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1512</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1513</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1514</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1515</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1516</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1517</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1518</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1519</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1520</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1521</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1522</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1523</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1524</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1525</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1526</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1527</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1528</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1529</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1530</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1531</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1532</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1533</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">mkdir</span><span style="color: #e6edf3">(path,</span> <span style="color: #e6edf3">check_writable</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">raise_error</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Creates a directory and optionally checks if it's writable.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        path (str or Path): The directory to create.</span>
<span style="color: #a5d6ff">        check_writable (bool, optional): Whether to check if the directory is writable. Default is True.</span>
<span style="color: #a5d6ff">        raise_error (bool, optional): Whether to raise an error if the directory creation fails. Default is True.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        bool: True if the directory is successfully created (and writable, if check_writable=True); otherwise False.</span>

<span style="color: #a5d6ff">    Raises:</span>
<span style="color: #a5d6ff">        DirectoryCreationError: Raised if the directory cannot be created and `raise_error=True`.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; mkdir("/tmp/new_dir")</span>
<span style="color: #a5d6ff">        True</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; mkdir("/restricted_dir", check_writable=False, raise_error=False)</span>
<span style="color: #a5d6ff">        False</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">path</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">Path(path)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolve()</span>
    <span style="color: #e6edf3">touchfile</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">path</span> <span style="color: #ff7b72; font-weight: bold">/</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">".{</span><span style="color: #e6edf3">rand_string()</span><span style="color: #a5d6ff">}"</span>
    <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">path</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">mkdir(exist_ok</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">parents</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">touchfile</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">touch()</span>
        <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">True</span>
    <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">Exception</span> <span style="color: #ff7b72">as</span> <span style="color: #e6edf3">e:</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">raise_error:</span>
            <span style="color: #ff7b72">raise</span> <span style="color: #e6edf3">errors</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">DirectoryCreationError(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Failed to create directory at {</span><span style="color: #e6edf3">path</span><span style="color: #a5d6ff">}: {</span><span style="color: #e6edf3">e</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
    <span style="color: #ff7b72">finally</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">suppress(</span><span style="color: #f0883e; font-weight: bold">Exception</span><span style="color: #e6edf3">):</span>
            <span style="color: #e6edf3">touchfile</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">unlink()</span>
    <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">False</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.os_platform">
<span class="doc doc-object-name doc-function-name">os_platform</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">os_platform()</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Return the OS platform of the current system.</p>
<p>This function fetches and returns the OS type where the code is being executed.
It converts the platform identifier to lowercase.</p>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>str</code></b>        –
        <div class="doc-md-description">
<p>A string representing the OS platform, such as "linux", "darwin", or "windows".</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">os_platform()</span>
<span style="color: #8b949e">'linux'</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2051</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2052</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2053</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2054</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2055</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2056</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2057</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2058</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2059</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2060</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2061</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2062</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2063</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2064</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">os_platform</span><span style="color: #e6edf3">():</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Return the OS platform of the current system.</span>

<span style="color: #a5d6ff">    This function fetches and returns the OS type where the code is being executed.</span>
<span style="color: #a5d6ff">    It converts the platform identifier to lowercase.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        str: A string representing the OS platform, such as "linux", "darwin", or "windows".</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; os_platform()</span>
<span style="color: #a5d6ff">        'linux'</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">platform</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">system()</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">lower()</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.os_platform_friendly">
<span class="doc doc-object-name doc-function-name">os_platform_friendly</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">os_platform_friendly()</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Return a human-friendly OS platform string, suitable for golang release binaries.</p>
<p>This function fetches the OS platform and modifies it to a more human-readable format if necessary.
Specifically, it changes "darwin" to "macOS".</p>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>str</code></b>        –
        <div class="doc-md-description">
<p>A string representing the human-friendly OS platform, such as "macOS", "linux", or "windows".</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">os_platform_friendly()</span>
<span style="color: #8b949e">'macOS'</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2067</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2068</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2069</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2070</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2071</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2072</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2073</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2074</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2075</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2076</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2077</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2078</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2079</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2080</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2081</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2082</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2083</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">os_platform_friendly</span><span style="color: #e6edf3">():</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Return a human-friendly OS platform string, suitable for golang release binaries.</span>

<span style="color: #a5d6ff">    This function fetches the OS platform and modifies it to a more human-readable format if necessary.</span>
<span style="color: #a5d6ff">    Specifically, it changes "darwin" to "macOS".</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        str: A string representing the human-friendly OS platform, such as "macOS", "linux", or "windows".</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; os_platform_friendly()</span>
<span style="color: #a5d6ff">        'macOS'</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">p</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">os_platform()</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">p</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #a5d6ff">"darwin"</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">return</span> <span style="color: #a5d6ff">"macOS"</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">p</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.parent_domain">
<span class="doc doc-object-name doc-function-name">parent_domain</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">parent_domain(d)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Retrieve the parent domain of a given subdomain string.</p>
<p>This function takes an input string <code>d</code> representing a subdomain and returns its parent domain.
If the input does not represent a subdomain, it returns the input as is.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>d</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>The input string representing a subdomain or domain.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>str</code></b>        –
        <div class="doc-md-description">
<p>The parent domain of the subdomain, or the original input if it is not a subdomain.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">parent_domain(</span><span style="color: #a5d6ff">"www.internal.evilcorp.co.uk"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">"internal.evilcorp.co.uk"</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">parent_domain(</span><span style="color: #a5d6ff">"www.internal.evilcorp.co.uk:8080"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">"internal.evilcorp.co.uk:8080"</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">parent_domain(</span><span style="color: #a5d6ff">"www.evilcorp.co.uk"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">"evilcorp.co.uk"</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">parent_domain(</span><span style="color: #a5d6ff">"evilcorp.co.uk"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">"evilcorp.co.uk"</span>
</code></pre></div>
<details class="notes" open="">
<summary>Notes</summary>
<ul>
<li>Port, if present in input, is preserved in the output.</li>
</ul>
</details>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">260</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">261</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">262</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">263</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">264</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">265</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">266</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">267</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">268</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">269</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">270</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">271</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">272</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">273</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">274</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">275</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">276</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">277</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">278</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">279</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">280</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">281</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">282</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">283</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">284</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">285</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">286</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">287</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">288</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">289</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">290</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">291</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">292</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">parent_domain</span><span style="color: #e6edf3">(d):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Retrieve the parent domain of a given subdomain string.</span>

<span style="color: #a5d6ff">    This function takes an input string `d` representing a subdomain and returns its parent domain.</span>
<span style="color: #a5d6ff">    If the input does not represent a subdomain, it returns the input as is.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        d (str): The input string representing a subdomain or domain.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        str: The parent domain of the subdomain, or the original input if it is not a subdomain.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; parent_domain("www.internal.evilcorp.co.uk")</span>
<span style="color: #a5d6ff">        "internal.evilcorp.co.uk"</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; parent_domain("www.internal.evilcorp.co.uk:8080")</span>
<span style="color: #a5d6ff">        "internal.evilcorp.co.uk:8080"</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; parent_domain("www.evilcorp.co.uk")</span>
<span style="color: #a5d6ff">        "evilcorp.co.uk"</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; parent_domain("evilcorp.co.uk")</span>
<span style="color: #a5d6ff">        "evilcorp.co.uk"</span>

<span style="color: #a5d6ff">    Notes:</span>
<span style="color: #a5d6ff">        - Port, if present in input, is preserved in the output.</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">host,</span> <span style="color: #e6edf3">port</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">split_host_port(d)</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">is_subdomain(d):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">make_netloc(</span><span style="color: #a5d6ff">"."</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join(str(host)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">split(</span><span style="color: #a5d6ff">"."</span><span style="color: #e6edf3">)[</span><span style="color: #a5d6ff">1</span><span style="color: #e6edf3">:]),</span> <span style="color: #e6edf3">port)</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">d</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.parent_url">
<span class="doc doc-object-name doc-function-name">parent_url</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">parent_url(u)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Retrieve the parent URL of a given URL.</p>
<p>This function takes an input string <code>u</code> representing a URL and returns its parent URL.
If the input URL does not have a parent (i.e., it's already the top-level), it returns None.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>u</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>The input string representing a URL.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
        –
        <div class="doc-md-description">
<p>Union[str, None]: The parent URL of the input URL, or None if it has no parent.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">parent_url(</span><span style="color: #a5d6ff">"https://evilcorp.com/sub/path/"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">"https://evilcorp.com/sub/"</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">parent_url(</span><span style="color: #a5d6ff">"https://evilcorp.com/"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">None</span>
</code></pre></div>
<details class="notes" open="">
<summary>Notes</summary>
<ul>
<li>Only the path component of the URL is modified.</li>
<li>All other components like scheme, netloc, query, and fragment are preserved.</li>
</ul>
</details>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">330</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">331</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">332</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">333</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">334</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">335</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">336</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">337</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">338</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">339</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">340</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">341</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">342</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">343</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">344</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">345</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">346</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">347</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">348</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">349</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">350</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">351</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">352</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">353</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">354</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">355</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">356</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">357</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">358</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">359</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">parent_url</span><span style="color: #e6edf3">(u):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Retrieve the parent URL of a given URL.</span>

<span style="color: #a5d6ff">    This function takes an input string `u` representing a URL and returns its parent URL.</span>
<span style="color: #a5d6ff">    If the input URL does not have a parent (i.e., it's already the top-level), it returns None.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        u (str): The input string representing a URL.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        Union[str, None]: The parent URL of the input URL, or None if it has no parent.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; parent_url("https://evilcorp.com/sub/path/")</span>
<span style="color: #a5d6ff">        "https://evilcorp.com/sub/"</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; parent_url("https://evilcorp.com/")</span>
<span style="color: #a5d6ff">        None</span>

<span style="color: #a5d6ff">    Notes:</span>
<span style="color: #a5d6ff">        - Only the path component of the URL is modified.</span>
<span style="color: #a5d6ff">        - All other components like scheme, netloc, query, and fragment are preserved.</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">parsed</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">urlparse(u)</span>
    <span style="color: #e6edf3">path</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">Path(parsed</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">path)</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">path</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #e6edf3">path:</span>
        <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">None</span>
    <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">urlunparse(parsed</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_replace(path</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">str(path</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent)))</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.parse_list_string">
<span class="doc doc-object-name doc-function-name">parse_list_string</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">parse_list_string(list_string)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Parses a comma-separated string into a list, removing invalid characters.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>list_string</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>The string containing elements separated by commas.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>list</code></b>        –
        <div class="doc-md-description">
<p>A list of individual elements parsed from the input string.</p>
</div>
</li>
</ul>
<p>Raises:</p>
<ul>
<li class="field-body">
<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/exceptions.html#ValueError">ValueError</a></code>
          –
        <div class="doc-md-description">
<p>If the input string contains invalid characters.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">parse_list_string(</span><span style="color: #a5d6ff">"html,js,css"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">['html', 'js', 'css']</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">parse_list_string(</span><span style="color: #a5d6ff">"png,jpg,gif"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">['png', 'jpg', 'gif']</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">parse_list_string(</span><span style="color: #a5d6ff">"invalid&lt;&gt;char"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">ValueError: Invalid character in string: invalid&lt;&gt;char</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2513</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2514</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2515</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2516</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2517</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2518</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2519</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2520</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2521</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2522</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2523</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2524</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2525</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2526</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2527</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2528</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2529</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2530</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2531</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2532</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2533</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2534</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2535</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2536</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2537</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2538</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2539</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2540</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2541</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2542</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2543</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">parse_list_string</span><span style="color: #e6edf3">(list_string):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Parses a comma-separated string into a list, removing invalid characters.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        list_string (str): The string containing elements separated by commas.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        list: A list of individual elements parsed from the input string.</span>

<span style="color: #a5d6ff">    Raises:</span>
<span style="color: #a5d6ff">        ValueError: If the input string contains invalid characters.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; parse_list_string("html,js,css")</span>
<span style="color: #a5d6ff">        ['html', 'js', 'css']</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; parse_list_string("png,jpg,gif")</span>
<span style="color: #a5d6ff">        ['png', 'jpg', 'gif']</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; parse_list_string("invalid&lt;&gt;char")</span>
<span style="color: #a5d6ff">        ValueError: Invalid character in string: invalid&lt;&gt;char</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">elements</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">list_string</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">split(</span><span style="color: #a5d6ff">","</span><span style="color: #e6edf3">)</span>
    <span style="color: #e6edf3">result</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>

    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">element</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">elements:</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">any((c</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #a5d6ff">'&lt;&gt;:"/</span><span style="color: #79c0ff">\\</span><span style="color: #a5d6ff">|?*'</span><span style="color: #e6edf3">)</span> <span style="color: #ff7b72; font-weight: bold">or</span> <span style="color: #e6edf3">(ord(c)</span> <span style="color: #ff7b72; font-weight: bold">&lt;</span> <span style="color: #a5d6ff">32</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #e6edf3">c</span> <span style="color: #ff7b72; font-weight: bold">!=</span> <span style="color: #a5d6ff">" "</span><span style="color: #e6edf3">)</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">c</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">element):</span>
            <span style="color: #ff7b72">raise</span> <span style="color: #f0883e; font-weight: bold">ValueError</span><span style="color: #e6edf3">(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Invalid character in string: {</span><span style="color: #e6edf3">element</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">result</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(element)</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">result</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.parse_port_string">
<span class="doc doc-object-name doc-function-name">parse_port_string</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">parse_port_string(port_string)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Parses a string containing ports and port ranges into a list of individual ports.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>port_string</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>The string containing individual ports and port ranges separated by commas.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>list</code></b>        –
        <div class="doc-md-description">
<p>A list of individual ports parsed from the input string.</p>
</div>
</li>
</ul>
<p>Raises:</p>
<ul>
<li class="field-body">
<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/exceptions.html#ValueError">ValueError</a></code>
          –
        <div class="doc-md-description">
<p>If the input string contains invalid ports or port ranges.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">parse_port_string(</span><span style="color: #a5d6ff">"22,80,1000-1002"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">[22, 80, 1000, 1001, 1002]</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">parse_port_string(</span><span style="color: #a5d6ff">"1-2,3-5"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">[1, 2, 3, 4, 5]</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">parse_port_string(</span><span style="color: #a5d6ff">"invalid"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">ValueError: Invalid port or port range: invalid</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2466</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2467</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2468</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2469</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2470</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2471</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2472</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2473</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2474</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2475</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2476</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2477</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2478</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2479</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2480</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2481</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2482</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2483</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2484</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2485</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2486</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2487</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2488</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2489</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2490</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2491</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2492</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2493</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2494</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2495</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2496</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2497</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2498</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2499</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2500</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2501</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2502</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2503</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2504</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2505</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2506</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2507</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2508</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2509</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2510</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">parse_port_string</span><span style="color: #e6edf3">(port_string):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Parses a string containing ports and port ranges into a list of individual ports.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        port_string (str): The string containing individual ports and port ranges separated by commas.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        list: A list of individual ports parsed from the input string.</span>

<span style="color: #a5d6ff">    Raises:</span>
<span style="color: #a5d6ff">        ValueError: If the input string contains invalid ports or port ranges.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; parse_port_string("22,80,1000-1002")</span>
<span style="color: #a5d6ff">        [22, 80, 1000, 1001, 1002]</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; parse_port_string("1-2,3-5")</span>
<span style="color: #a5d6ff">        [1, 2, 3, 4, 5]</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; parse_port_string("invalid")</span>
<span style="color: #a5d6ff">        ValueError: Invalid port or port range: invalid</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">elements</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">port_string</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">split(</span><span style="color: #a5d6ff">","</span><span style="color: #e6edf3">)</span>
    <span style="color: #e6edf3">ports</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>

    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">element</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">elements:</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">element</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">isdigit():</span>
            <span style="color: #e6edf3">port</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">int(element)</span>
            <span style="color: #ff7b72">if</span> <span style="color: #a5d6ff">1</span> <span style="color: #ff7b72; font-weight: bold">&lt;=</span> <span style="color: #e6edf3">port</span> <span style="color: #ff7b72; font-weight: bold">&lt;=</span> <span style="color: #a5d6ff">65535</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">ports</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(port)</span>
            <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
                <span style="color: #ff7b72">raise</span> <span style="color: #f0883e; font-weight: bold">ValueError</span><span style="color: #e6edf3">(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Invalid port: {</span><span style="color: #e6edf3">element</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">elif</span> <span style="color: #a5d6ff">"-"</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">element:</span>
            <span style="color: #e6edf3">range_parts</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">element</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">split(</span><span style="color: #a5d6ff">"-"</span><span style="color: #e6edf3">)</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">len(range_parts)</span> <span style="color: #ff7b72; font-weight: bold">!=</span> <span style="color: #a5d6ff">2</span> <span style="color: #ff7b72; font-weight: bold">or</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">all(part</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">isdigit()</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">part</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">range_parts):</span>
                <span style="color: #ff7b72">raise</span> <span style="color: #f0883e; font-weight: bold">ValueError</span><span style="color: #e6edf3">(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Invalid port or port range: {</span><span style="color: #e6edf3">element</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">start,</span> <span style="color: #e6edf3">end</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">map(int,</span> <span style="color: #e6edf3">range_parts)</span>
            <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">(</span><span style="color: #a5d6ff">1</span> <span style="color: #ff7b72; font-weight: bold">&lt;=</span> <span style="color: #e6edf3">start</span> <span style="color: #ff7b72; font-weight: bold">&lt;</span> <span style="color: #e6edf3">end</span> <span style="color: #ff7b72; font-weight: bold">&lt;=</span> <span style="color: #a5d6ff">65535</span><span style="color: #e6edf3">):</span>
                <span style="color: #ff7b72">raise</span> <span style="color: #f0883e; font-weight: bold">ValueError</span><span style="color: #e6edf3">(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Invalid port range: {</span><span style="color: #e6edf3">element</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">ports</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">extend(range(start,</span> <span style="color: #e6edf3">end</span> <span style="color: #ff7b72; font-weight: bold">+</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">))</span>
        <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">raise</span> <span style="color: #f0883e; font-weight: bold">ValueError</span><span style="color: #e6edf3">(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Invalid port or port range: {</span><span style="color: #e6edf3">element</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>

    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">ports</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.rand_string">
<span class="doc doc-object-name doc-function-name">rand_string</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">rand_string(length</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">10</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">digits</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">True</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Generates a random string of specified length.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>length</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a></code>, default:
                <code>10</code>
)
        –
        <div class="doc-md-description">
<p>The length of the random string. Defaults to 10.</p>
</div>
</li>
<li class="field-body">
<b><code>digits</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#bool">bool</a></code>, default:
                <code>True</code>
)
        –
        <div class="doc-md-description">
<p>Whether to include digits in the string. Defaults to True.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>str</code></b>        –
        <div class="doc-md-description">
<p>A random string of the specified length.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">rand_string()</span>
<span style="color: #8b949e">'c4hp4i9jzx'</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">rand_string(</span><span style="color: #a5d6ff">20</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">'ap4rsdtg5iw7ey7y3oa5'</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">rand_string(</span><span style="color: #a5d6ff">30</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">digits</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">'xdmyxtglqfzqktngkesyulwbfrihva'</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">795</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">796</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">797</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">798</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">799</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">800</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">801</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">802</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">803</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">804</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">805</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">806</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">807</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">808</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">809</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">810</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">811</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">812</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">813</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">814</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">815</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">816</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">817</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">rand_string</span><span style="color: #e6edf3">(length</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">10</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">digits</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Generates a random string of specified length.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        length (int, optional): The length of the random string. Defaults to 10.</span>
<span style="color: #a5d6ff">        digits (bool, optional): Whether to include digits in the string. Defaults to True.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        str: A random string of the specified length.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; rand_string()</span>
<span style="color: #a5d6ff">        'c4hp4i9jzx'</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; rand_string(20)</span>
<span style="color: #a5d6ff">        'ap4rsdtg5iw7ey7y3oa5'</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; rand_string(30, digits=False)</span>
<span style="color: #a5d6ff">        'xdmyxtglqfzqktngkesyulwbfrihva'</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">pool</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">rand_pool</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">digits:</span>
        <span style="color: #e6edf3">pool</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">rand_pool_digits</span>
    <span style="color: #ff7b72">return</span> <span style="color: #a5d6ff">""</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join([random</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">choice(pool)</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">_</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">range(int(length))])</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.read_file">
<span class="doc doc-object-name doc-function-name">read_file</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">read_file(filename)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Reads a file line by line and yields each line without line breaks.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>filename</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a> or <a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3.11/library/pathlib.html#pathlib.Path">Path</a></code>)
        –
        <div class="doc-md-description">
<p>The path to the file to read.</p>
</div>
</li>
</ul>
<p>Yields:</p>
<ul>
<li class="field-body">
<b><code>str</code></b>        –
        <div class="doc-md-description">
<p>A line from the file without the trailing line break.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #ff7b72">for</span> <span style="color: #e6edf3">line</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">read_file(</span><span style="color: #a5d6ff">"/tmp/file.txt"</span><span style="color: #e6edf3">):</span>
<span style="color: #8b949e">... </span>    <span style="color: #e6edf3">print(line)</span>
<span style="color: #8b949e">file_line1</span>
<span style="color: #8b949e">file_line2</span>
<span style="color: #8b949e">file_line3</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1201</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1202</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1203</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1204</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1205</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1206</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1207</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1208</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1209</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1210</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1211</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1212</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1213</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1214</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1215</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1216</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1217</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1218</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1219</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">read_file</span><span style="color: #e6edf3">(filename):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Reads a file line by line and yields each line without line breaks.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        filename (str or Path): The path to the file to read.</span>

<span style="color: #a5d6ff">    Yields:</span>
<span style="color: #a5d6ff">        str: A line from the file without the trailing line break.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; for line in read_file("/tmp/file.txt"):</span>
<span style="color: #a5d6ff">        ...     print(line)</span>
<span style="color: #a5d6ff">        file_line1</span>
<span style="color: #a5d6ff">        file_line2</span>
<span style="color: #a5d6ff">        file_line3</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">open(filename,</span> <span style="color: #e6edf3">errors</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"ignore"</span><span style="color: #e6edf3">)</span> <span style="color: #ff7b72">as</span> <span style="color: #e6edf3">f:</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">line</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">f:</span>
            <span style="color: #ff7b72">yield</span> <span style="color: #e6edf3">line</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">rstrip(</span><span style="color: #a5d6ff">"</span><span style="color: #79c0ff">\r\n</span><span style="color: #a5d6ff">"</span><span style="color: #e6edf3">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.recursive_decode">
<span class="doc doc-object-name doc-function-name">recursive_decode</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">recursive_decode(data,</span> <span style="color: #e6edf3">max_depth</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">5</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Recursively decodes doubly or triply-encoded strings to their original form.</p>
<p>Supports both URL-encoding and backslash-escapes (including unicode)</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>data</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>The data to decode.</p>
</div>
</li>
<li class="field-body">
<b><code>max_depth</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a></code>, default:
                <code>5</code>
)
        –
        <div class="doc-md-description">
<p>Maximum recursion depth for decoding. Defaults to 5.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>str</code></b>        –
        <div class="doc-md-description">
<p>The decoded string.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">recursive_decode(</span><span style="color: #a5d6ff">"Hello%20world%21"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">"Hello world!"</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">recursive_decode(</span><span style="color: #a5d6ff">"Hello%20%5Cu041f%5Cu0440%5Cu0438%5Cu0432%5Cu0435%5Cu0442"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">"Hello Привет"</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">recursive_dcode(</span><span style="color: #a5d6ff">"%5Cu0020%5Cu041f%5Cu0440%5Cu0438%5Cu0432%5Cu0435%5Cu0442%5Cu0021"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">" Привет!"</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">750</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">751</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">752</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">753</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">754</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">755</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">756</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">757</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">758</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">759</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">760</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">761</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">762</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">763</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">764</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">765</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">766</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">767</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">768</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">769</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">770</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">771</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">772</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">773</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">774</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">775</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">776</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">777</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">778</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">779</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">780</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">781</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">782</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">783</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">784</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">785</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">786</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">787</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">788</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">recursive_decode</span><span style="color: #e6edf3">(data,</span> <span style="color: #e6edf3">max_depth</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">5</span><span style="color: #e6edf3">):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Recursively decodes doubly or triply-encoded strings to their original form.</span>

<span style="color: #a5d6ff">    Supports both URL-encoding and backslash-escapes (including unicode)</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        data (str): The data to decode.</span>
<span style="color: #a5d6ff">        max_depth (int, optional): Maximum recursion depth for decoding. Defaults to 5.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        str: The decoded string.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; recursive_decode("Hello%20world%21")</span>
<span style="color: #a5d6ff">        "Hello world!"</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; recursive_decode("Hello%20%5Cu041f%5Cu0440%5Cu0438%5Cu0432%5Cu0435%5Cu0442")</span>
<span style="color: #a5d6ff">        "Hello Привет"</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; recursive_dcode("%5Cu0020%5Cu041f%5Cu0440%5Cu0438%5Cu0432%5Cu0435%5Cu0442%5Cu0021")</span>
<span style="color: #a5d6ff">        " Привет!"</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #8b949e; font-style: italic"># Decode newline and tab escapes</span>
    <span style="color: #e6edf3">data</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">backslash_regex</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">sub(</span>
        <span style="color: #ff7b72">lambda</span> <span style="color: #e6edf3">match:</span> <span style="color: #e6edf3">{</span><span style="color: #a5d6ff">"n"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">"</span><span style="color: #79c0ff">\n</span><span style="color: #a5d6ff">"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"t"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">"</span><span style="color: #79c0ff">\t</span><span style="color: #a5d6ff">"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"r"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">"</span><span style="color: #79c0ff">\r</span><span style="color: #a5d6ff">"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"b"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">"</span><span style="color: #79c0ff">\b</span><span style="color: #a5d6ff">"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"v"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">"</span><span style="color: #79c0ff">\v</span><span style="color: #a5d6ff">"</span><span style="color: #e6edf3">}</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(match</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">group(</span><span style="color: #a5d6ff">"char"</span><span style="color: #e6edf3">)),</span> <span style="color: #e6edf3">data</span>
    <span style="color: #e6edf3">)</span>
    <span style="color: #e6edf3">data</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">smart_decode(data)</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">max_depth</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #a5d6ff">0</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">data</span>
    <span style="color: #8b949e; font-style: italic"># Decode URL encoding</span>
    <span style="color: #e6edf3">data</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">unquote(data,</span> <span style="color: #e6edf3">errors</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"ignore"</span><span style="color: #e6edf3">)</span>
    <span style="color: #8b949e; font-style: italic"># Decode Unicode escapes</span>
    <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">suppress(</span><span style="color: #f0883e; font-weight: bold">UnicodeEncodeError</span><span style="color: #e6edf3">):</span>
        <span style="color: #e6edf3">data</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">codecs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">decode(data,</span> <span style="color: #a5d6ff">"unicode_escape"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">errors</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"ignore"</span><span style="color: #e6edf3">)</span>
    <span style="color: #8b949e; font-style: italic"># Check if there's still URL-encoded or Unicode-escaped content</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">encoded_regex</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">search(data):</span>
        <span style="color: #8b949e; font-style: italic"># If yes, continue decoding</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">recursive_decode(data,</span> <span style="color: #e6edf3">max_depth</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">max_depth</span> <span style="color: #ff7b72; font-weight: bold">-</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">)</span>

    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">data</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.rm_at_exit">
<span class="doc doc-object-name doc-function-name">rm_at_exit</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">rm_at_exit(path)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Registers a file to be automatically deleted when the program exits.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>path</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a> or <a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3.11/library/pathlib.html#pathlib.Path">Path</a></code>)
        –
        <div class="doc-md-description">
<p>The path to the file to be deleted upon program exit.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">rm_at_exit(</span><span style="color: #a5d6ff">"/tmp/test/file1.txt"</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1173</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1174</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1175</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1176</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1177</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1178</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1179</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1180</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1181</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1182</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">rm_at_exit</span><span style="color: #e6edf3">(path):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Registers a file to be automatically deleted when the program exits.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        path (str or Path): The path to the file to be deleted upon program exit.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; rm_at_exit("/tmp/test/file1.txt")</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">atexit</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">register(delete_file,</span> <span style="color: #e6edf3">path)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.search_dict_by_key">
<span class="doc doc-object-name doc-function-name">search_dict_by_key</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">search_dict_by_key(key,</span> <span style="color: #e6edf3">d)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Search a nested dictionary or list of dictionaries by a key and yield all matching values.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>key</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>The key to search for.</p>
</div>
</li>
<li class="field-body">
<b><code>d</code></b>
            (<code>Union[<a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#dict">dict</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#list">list</a>]</code>)
        –
        <div class="doc-md-description">
<p>The dictionary or list of dictionaries to search.</p>
</div>
</li>
</ul>
<p>Yields:</p>
<ul>
<li class="field-body">
<b><code>Any</code></b>        –
        <div class="doc-md-description">
<p>Yields all values that match the provided key.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">d</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{</span><span style="color: #a5d6ff">'a'</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">'b'</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">{</span><span style="color: #a5d6ff">'c'</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">2</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">'a'</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">3</span><span style="color: #e6edf3">},</span> <span style="color: #a5d6ff">'d'</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">[{</span><span style="color: #a5d6ff">'a'</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">4</span><span style="color: #e6edf3">},</span> <span style="color: #e6edf3">{</span><span style="color: #a5d6ff">'e'</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">5</span><span style="color: #e6edf3">}]}</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">list(search_dict_by_key(</span><span style="color: #a5d6ff">'a'</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">d))</span>
<span style="color: #8b949e">[1, 3, 4]</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1301</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1302</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1303</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1304</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1305</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1306</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1307</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1308</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1309</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1310</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1311</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1312</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1313</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1314</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1315</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1316</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1317</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1318</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1319</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1320</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1321</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1322</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1323</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">search_dict_by_key</span><span style="color: #e6edf3">(key,</span> <span style="color: #e6edf3">d):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Search a nested dictionary or list of dictionaries by a key and yield all matching values.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        key (str): The key to search for.</span>
<span style="color: #a5d6ff">        d (Union[dict, list]): The dictionary or list of dictionaries to search.</span>

<span style="color: #a5d6ff">    Yields:</span>
<span style="color: #a5d6ff">        Any: Yields all values that match the provided key.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; d = {'a': 1, 'b': {'c': 2, 'a': 3}, 'd': [{'a': 4}, {'e': 5}]}</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; list(search_dict_by_key('a', d))</span>
<span style="color: #a5d6ff">        [1, 3, 4]</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">isinstance(d,</span> <span style="color: #e6edf3">dict):</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">key</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">d:</span>
            <span style="color: #ff7b72">yield</span> <span style="color: #e6edf3">d[key]</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">k,</span> <span style="color: #e6edf3">v</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">d</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items():</span>
            <span style="color: #ff7b72">yield from</span> <span style="color: #e6edf3">search_dict_by_key(key,</span> <span style="color: #e6edf3">v)</span>
    <span style="color: #ff7b72">elif</span> <span style="color: #e6edf3">isinstance(d,</span> <span style="color: #e6edf3">list):</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">v</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">d:</span>
            <span style="color: #ff7b72">yield from</span> <span style="color: #e6edf3">search_dict_by_key(key,</span> <span style="color: #e6edf3">v)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.search_dict_values">
<span class="doc doc-object-name doc-function-name">search_dict_values</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">search_dict_values(d,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">regexes)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Recursively search a dictionary's values based on provided regex patterns.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>d</code></b>
            (<code>Union[<a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#dict">dict</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#list">list</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a>]</code>)
        –
        <div class="doc-md-description">
<p>The dictionary, list, or string to search.</p>
</div>
</li>
<li class="field-body">
<b><code>*regexes</code></b>
        –
        <div class="doc-md-description">
<p>Arbitrary number of compiled regex patterns.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>Generator</code></b>        –
        <div class="doc-md-description">
<p>Yields matching values based on the provided regex patterns.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">dict_to_search</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{</span>
<span style="color: #8b949e">... </span>    <span style="color: #a5d6ff">"key1"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">{</span>
<span style="color: #8b949e">... </span>        <span style="color: #a5d6ff">"key2"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">[</span>
<span style="color: #8b949e">... </span>            <span style="color: #e6edf3">{</span>
<span style="color: #8b949e">... </span>                <span style="color: #a5d6ff">"key3"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">"A URL: https://www.evilcorp.com"</span>
<span style="color: #8b949e">... </span>            <span style="color: #e6edf3">}</span>
<span style="color: #8b949e">... </span>        <span style="color: #e6edf3">]</span>
<span style="color: #8b949e">... </span>    <span style="color: #e6edf3">}</span>
<span style="color: #8b949e">... </span><span style="color: #e6edf3">}</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">url_regexes</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">re</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">compile(</span><span style="color: #79c0ff">r</span><span style="color: #a5d6ff">'https?://[^\s&lt;&gt;"]+|www\.[^\s&lt;&gt;"]+'</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">list(search_dict_values(dict_to_search,</span> <span style="color: #e6edf3">url_regexes))</span>
<span style="color: #8b949e">["https://www.evilcorp.com"]</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1351</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1352</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1353</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1354</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1355</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1356</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1357</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1358</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1359</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1360</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1361</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1362</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1363</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1364</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1365</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1366</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1367</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1368</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1369</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1370</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1371</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1372</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1373</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1374</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1375</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1376</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1377</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1378</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1379</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1380</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1381</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1382</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1383</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1384</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1385</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1386</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1387</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1388</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1389</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1390</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">search_dict_values</span><span style="color: #e6edf3">(d,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">regexes):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Recursively search a dictionary's values based on provided regex patterns.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        d (Union[dict, list, str]): The dictionary, list, or string to search.</span>
<span style="color: #a5d6ff">        *regexes: Arbitrary number of compiled regex patterns.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        Generator: Yields matching values based on the provided regex patterns.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; dict_to_search = {</span>
<span style="color: #a5d6ff">        ...     "key1": {</span>
<span style="color: #a5d6ff">        ...         "key2": [</span>
<span style="color: #a5d6ff">        ...             {</span>
<span style="color: #a5d6ff">        ...                 "key3": "A URL: https://www.evilcorp.com"</span>
<span style="color: #a5d6ff">        ...             }</span>
<span style="color: #a5d6ff">        ...         ]</span>
<span style="color: #a5d6ff">        ...     }</span>
<span style="color: #a5d6ff">        ... }</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; url_regexes = re.compile(r'https?://[^\s&lt;&gt;"]+|www\.[^\s&lt;&gt;"]+')</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; list(search_dict_values(dict_to_search, url_regexes))</span>
<span style="color: #a5d6ff">        ["https://www.evilcorp.com"]</span>
<span style="color: #a5d6ff">    """</span>

    <span style="color: #e6edf3">results</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">set()</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">isinstance(d,</span> <span style="color: #e6edf3">str):</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">r</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">regexes:</span>
            <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">match</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">r</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">finditer(d):</span>
                <span style="color: #e6edf3">result</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">match</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">group()</span>
                <span style="color: #e6edf3">h</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">hash(result)</span>
                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">h</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">results:</span>
                    <span style="color: #e6edf3">results</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">add(h)</span>
                    <span style="color: #ff7b72">yield</span> <span style="color: #e6edf3">result</span>
    <span style="color: #ff7b72">elif</span> <span style="color: #e6edf3">isinstance(d,</span> <span style="color: #e6edf3">dict):</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">_,</span> <span style="color: #e6edf3">v</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">d</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items():</span>
            <span style="color: #ff7b72">yield from</span> <span style="color: #e6edf3">search_dict_values(v,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">regexes)</span>
    <span style="color: #ff7b72">elif</span> <span style="color: #e6edf3">isinstance(d,</span> <span style="color: #e6edf3">list):</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">v</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">d:</span>
            <span style="color: #ff7b72">yield from</span> <span style="color: #e6edf3">search_dict_values(v,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">regexes)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.search_format_dict">
<span class="doc doc-object-name doc-function-name">search_format_dict</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">search_format_dict(d,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Recursively format string values in a dictionary or list using the provided keyword arguments.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>d</code></b>
            (<code>Union[<a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#dict">dict</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#list">list</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a>]</code>)
        –
        <div class="doc-md-description">
<p>The dictionary, list, or string to format.</p>
</div>
</li>
<li class="field-body">
<b><code>**kwargs</code></b>
        –
        <div class="doc-md-description">
<p>Arbitrary keyword arguments used for string formatting.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
        –
        <div class="doc-md-description">
<p>Union[dict, list, str]: The formatted dictionary, list, or string.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">search_format_dict({</span><span style="color: #a5d6ff">"test"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">"#{name} is awesome"</span><span style="color: #e6edf3">},</span> <span style="color: #e6edf3">name</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"keanu"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">{"test": "keanu is awesome"}</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1326</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1327</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1328</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1329</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1330</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1331</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1332</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1333</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1334</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1335</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1336</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1337</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1338</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1339</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1340</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1341</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1342</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1343</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1344</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1345</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1346</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1347</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1348</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">search_format_dict</span><span style="color: #e6edf3">(d,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Recursively format string values in a dictionary or list using the provided keyword arguments.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        d (Union[dict, list, str]): The dictionary, list, or string to format.</span>
<span style="color: #a5d6ff">        **kwargs: Arbitrary keyword arguments used for string formatting.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        Union[dict, list, str]: The formatted dictionary, list, or string.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; search_format_dict({"test": "#{name} is awesome"}, name="keanu")</span>
<span style="color: #a5d6ff">        {"test": "keanu is awesome"}</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">isinstance(d,</span> <span style="color: #e6edf3">dict):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">{k:</span> <span style="color: #e6edf3">search_format_dict(v,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">k,</span> <span style="color: #e6edf3">v</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">d</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items()}</span>
    <span style="color: #ff7b72">elif</span> <span style="color: #e6edf3">isinstance(d,</span> <span style="color: #e6edf3">list):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">[search_format_dict(v,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">v</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">d]</span>
    <span style="color: #ff7b72">elif</span> <span style="color: #e6edf3">isinstance(d,</span> <span style="color: #e6edf3">str):</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">find,</span> <span style="color: #e6edf3">replace</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items():</span>
            <span style="color: #e6edf3">find</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">"#{"</span> <span style="color: #ff7b72; font-weight: bold">+</span> <span style="color: #e6edf3">str(find)</span> <span style="color: #ff7b72; font-weight: bold">+</span> <span style="color: #a5d6ff">"}"</span>
            <span style="color: #e6edf3">d</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">d</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">replace(find,</span> <span style="color: #e6edf3">replace)</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">d</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.sha1">
<span class="doc doc-object-name doc-function-name">sha1</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">sha1(data)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Computes the SHA-1 hash of the given data.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>data</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a> or <a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#dict">dict</a></code>)
        –
        <div class="doc-md-description">
<p>The data to hash. If a dictionary, it is first converted to a JSON string with sorted keys.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
        –
        <div class="doc-md-description">
<p>hashlib.Hash: SHA-1 hash object of the input data.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">sha1(</span><span style="color: #a5d6ff">"asdf"</span><span style="color: #e6edf3">)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">hexdigest()</span>
<span style="color: #8b949e">'3da541559918a808c2402bba5012f6c60b27661c'</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">684</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">685</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">686</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">687</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">688</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">689</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">690</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">691</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">692</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">693</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">694</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">695</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">696</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">697</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">698</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">699</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">700</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">sha1</span><span style="color: #e6edf3">(data):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Computes the SHA-1 hash of the given data.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        data (str or dict): The data to hash. If a dictionary, it is first converted to a JSON string with sorted keys.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        hashlib.Hash: SHA-1 hash object of the input data.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; sha1("asdf").hexdigest()</span>
<span style="color: #a5d6ff">        '3da541559918a808c2402bba5012f6c60b27661c'</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">isinstance(data,</span> <span style="color: #e6edf3">dict):</span>
        <span style="color: #e6edf3">data</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">json</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">dumps(data,</span> <span style="color: #e6edf3">sort_keys</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">)</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">hashlib_sha1(smart_encode(data))</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.smart_decode">
<span class="doc doc-object-name doc-function-name">smart_decode</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">smart_decode(data)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Decodes the input data to a UTF-8 string, silently ignoring errors.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>data</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a> or <a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#bytes">bytes</a></code>)
        –
        <div class="doc-md-description">
<p>The data to decode.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>str</code></b>        –
        <div class="doc-md-description">
<p>The decoded string.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">smart_decode(</span><span style="color: #79c0ff">b</span><span style="color: #a5d6ff">"asdf"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">"asdf"</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">smart_decode(</span><span style="color: #a5d6ff">"asdf"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">"asdf"</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">703</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">704</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">705</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">706</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">707</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">708</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">709</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">710</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">711</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">712</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">713</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">714</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">715</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">716</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">717</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">718</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">719</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">720</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">721</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">722</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">smart_decode</span><span style="color: #e6edf3">(data):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Decodes the input data to a UTF-8 string, silently ignoring errors.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        data (str or bytes): The data to decode.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        str: The decoded string.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; smart_decode(b"asdf")</span>
<span style="color: #a5d6ff">        "asdf"</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; smart_decode("asdf")</span>
<span style="color: #a5d6ff">        "asdf"</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">isinstance(data,</span> <span style="color: #e6edf3">bytes):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">data</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">decode(</span><span style="color: #a5d6ff">"utf-8"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">errors</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"ignore"</span><span style="color: #e6edf3">)</span>
    <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">str(data)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.smart_decode_punycode">
<span class="doc doc-object-name doc-function-name">smart_decode_punycode</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">smart_decode_punycode(text:</span> <span style="color: #e6edf3">str)</span> <span style="color: #ff7b72; font-weight: bold">-&gt;</span> <span style="color: #e6edf3">str</span>
</code></pre></div>
<div class="doc doc-contents">
<p>xn--eckwd4c7c.xn--zckzah --&gt; ドメイン.テスト</p>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1805</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1806</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1807</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1808</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1809</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1810</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1811</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1812</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1813</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1814</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1815</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1816</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1817</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1818</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">smart_decode_punycode</span><span style="color: #e6edf3">(text:</span> <span style="color: #e6edf3">str)</span> <span style="color: #ff7b72; font-weight: bold">-&gt;</span> <span style="color: #e6edf3">str:</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    xn--eckwd4c7c.xn--zckzah --&gt; ドメイン.テスト</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">host,</span> <span style="color: #e6edf3">before,</span> <span style="color: #e6edf3">after</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">extract_host(text)</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">host</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">text</span>

    <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">host</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">idna</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">decode(host)</span>
    <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">UnicodeError</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">pass</span>  <span style="color: #8b949e; font-style: italic"># If decoding fails, leave the host as it is</span>

    <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">before</span><span style="color: #a5d6ff">}{</span><span style="color: #e6edf3">host</span><span style="color: #a5d6ff">}{</span><span style="color: #e6edf3">after</span><span style="color: #a5d6ff">}"</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.smart_encode">
<span class="doc doc-object-name doc-function-name">smart_encode</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">smart_encode(data)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Encodes the input data to bytes using UTF-8 encoding, silently ignoring errors.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>data</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a> or <a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#bytes">bytes</a></code>)
        –
        <div class="doc-md-description">
<p>The data to encode.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>bytes</code></b>        –
        <div class="doc-md-description">
<p>The encoded bytes.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">smart_encode(</span><span style="color: #a5d6ff">"asdf"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">b"asdf"</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">smart_encode(</span><span style="color: #79c0ff">b</span><span style="color: #a5d6ff">"asdf"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">b"asdf"</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">725</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">726</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">727</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">728</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">729</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">730</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">731</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">732</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">733</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">734</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">735</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">736</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">737</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">738</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">739</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">740</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">741</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">742</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">743</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">smart_encode</span><span style="color: #e6edf3">(data):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Encodes the input data to bytes using UTF-8 encoding, silently ignoring errors.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        data (str or bytes): The data to encode.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        bytes: The encoded bytes.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; smart_encode("asdf")</span>
<span style="color: #a5d6ff">        b"asdf"</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; smart_encode(b"asdf")</span>
<span style="color: #a5d6ff">        b"asdf"</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">isinstance(data,</span> <span style="color: #e6edf3">bytes):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">data</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">str(data)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">encode(</span><span style="color: #a5d6ff">"utf-8"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">errors</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"ignore"</span><span style="color: #e6edf3">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.smart_encode_punycode">
<span class="doc doc-object-name doc-function-name">smart_encode_punycode</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">smart_encode_punycode(text:</span> <span style="color: #e6edf3">str)</span> <span style="color: #ff7b72; font-weight: bold">-&gt;</span> <span style="color: #e6edf3">str</span>
</code></pre></div>
<div class="doc doc-contents">
<p>ドメイン.テスト --&gt; xn--eckwd4c7c.xn--zckzah</p>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1789</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1790</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1791</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1792</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1793</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1794</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1795</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1796</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1797</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1798</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1799</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1800</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1801</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1802</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">smart_encode_punycode</span><span style="color: #e6edf3">(text:</span> <span style="color: #e6edf3">str)</span> <span style="color: #ff7b72; font-weight: bold">-&gt;</span> <span style="color: #e6edf3">str:</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    ドメイン.テスト --&gt; xn--eckwd4c7c.xn--zckzah</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">host,</span> <span style="color: #e6edf3">before,</span> <span style="color: #e6edf3">after</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">extract_host(text)</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">host</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">text</span>

    <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">host</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">idna</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">encode(host)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">decode(errors</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"ignore"</span><span style="color: #e6edf3">)</span>
    <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">UnicodeError</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">pass</span>  <span style="color: #8b949e; font-style: italic"># If encoding fails, leave the host as it is</span>

    <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">before</span><span style="color: #a5d6ff">}{</span><span style="color: #e6edf3">host</span><span style="color: #a5d6ff">}{</span><span style="color: #e6edf3">after</span><span style="color: #a5d6ff">}"</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.split_domain">
<span class="doc doc-object-name doc-function-name">split_domain</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">split_domain(hostname)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Splits the hostname into its subdomain and registered domain components.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>hostname</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>The full hostname to be split.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>tuple</code></b>        –
        <div class="doc-md-description">
<p>A tuple containing the subdomain and registered domain.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">split_domain(</span><span style="color: #a5d6ff">"www.internal.evilcorp.co.uk"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">("www.internal", "evilcorp.co.uk")</span>
</code></pre></div>
<details class="notes" open="">
<summary>Notes</summary>
<ul>
<li>Utilizes the <code>tldextract</code> function to first break down the hostname.</li>
</ul>
</details>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">413</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">414</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">415</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">416</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">417</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">418</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">419</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">420</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">421</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">422</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">423</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">424</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">425</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">426</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">427</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">428</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">429</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">430</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">431</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">432</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">433</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">434</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">435</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">436</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">437</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">438</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">439</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">split_domain</span><span style="color: #e6edf3">(hostname):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Splits the hostname into its subdomain and registered domain components.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        hostname (str): The full hostname to be split.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        tuple: A tuple containing the subdomain and registered domain.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; split_domain("www.internal.evilcorp.co.uk")</span>
<span style="color: #a5d6ff">        ("www.internal", "evilcorp.co.uk")</span>

<span style="color: #a5d6ff">    Notes:</span>
<span style="color: #a5d6ff">        - Utilizes the `tldextract` function to first break down the hostname.</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">is_ip(hostname):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">(</span><span style="color: #a5d6ff">""</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">hostname)</span>
    <span style="color: #e6edf3">parsed</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">tldextract(hostname)</span>
    <span style="color: #e6edf3">subdomain</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">parsed</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">subdomain</span>
    <span style="color: #e6edf3">domain</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">parsed</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">registered_domain</span>
    <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">domain:</span>
        <span style="color: #e6edf3">split</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">hostname</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">split(</span><span style="color: #a5d6ff">"."</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">subdomain</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">"."</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join(split[:</span><span style="color: #ff7b72; font-weight: bold">-</span><span style="color: #a5d6ff">2</span><span style="color: #e6edf3">])</span>
        <span style="color: #e6edf3">domain</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">"."</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join(split[</span><span style="color: #ff7b72; font-weight: bold">-</span><span style="color: #a5d6ff">2</span><span style="color: #e6edf3">:])</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">(subdomain,</span> <span style="color: #e6edf3">domain)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.split_host_port">
<span class="doc doc-object-name doc-function-name">split_host_port</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">split_host_port(d)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Parse a string containing a host and port into a tuple.</p>
<p>This function takes an input string <code>d</code> and returns a tuple containing the host and port.
The host is converted to its appropriate IP address type if possible. The port is inferred
based on the scheme if not provided.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>d</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>The input string containing the host and possibly the port.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
        –
        <div class="doc-md-description">
<p>Tuple[Union[IPv4Address, IPv6Address, str], Optional[int]]: Tuple containing the host and port.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">split_host_port(</span><span style="color: #a5d6ff">"evilcorp.com:443"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">("evilcorp.com", 443)</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">split_host_port(</span><span style="color: #a5d6ff">"192.168.1.1:443"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">(IPv4Address('192.168.1.1'), 443)</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">split_host_port(</span><span style="color: #a5d6ff">"[dead::beef]:443"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">(IPv6Address('dead::beef'), 443)</span>
</code></pre></div>
<details class="notes" open="">
<summary>Notes</summary>
<ul>
<li>If port is not provided, it is inferred based on the scheme:<ul>
<li>For "https" and "wss", port 443 is used.</li>
<li>For "http" and "ws", port 80 is used.</li>
</ul>
</li>
</ul>
</details>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">193</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">194</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">195</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">196</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">197</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">198</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">199</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">200</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">201</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">202</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">203</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">204</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">205</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">206</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">207</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">208</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">209</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">210</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">211</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">212</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">213</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">214</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">215</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">216</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">217</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">218</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">219</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">220</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">221</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">222</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">223</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">224</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">225</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">226</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">227</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">228</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">229</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">230</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">231</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">232</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">233</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">234</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">235</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">236</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">237</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">238</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">239</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">240</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">241</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">242</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">243</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">244</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">245</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">246</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">247</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">248</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">249</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">250</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">251</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">252</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">253</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">254</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">255</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">256</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">257</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">split_host_port</span><span style="color: #e6edf3">(d):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Parse a string containing a host and port into a tuple.</span>

<span style="color: #a5d6ff">    This function takes an input string `d` and returns a tuple containing the host and port.</span>
<span style="color: #a5d6ff">    The host is converted to its appropriate IP address type if possible. The port is inferred</span>
<span style="color: #a5d6ff">    based on the scheme if not provided.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        d (str): The input string containing the host and possibly the port.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        Tuple[Union[IPv4Address, IPv6Address, str], Optional[int]]: Tuple containing the host and port.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; split_host_port("evilcorp.com:443")</span>
<span style="color: #a5d6ff">        ("evilcorp.com", 443)</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; split_host_port("192.168.1.1:443")</span>
<span style="color: #a5d6ff">        (IPv4Address('192.168.1.1'), 443)</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; split_host_port("[dead::beef]:443")</span>
<span style="color: #a5d6ff">        (IPv6Address('dead::beef'), 443)</span>

<span style="color: #a5d6ff">    Notes:</span>
<span style="color: #a5d6ff">        - If port is not provided, it is inferred based on the scheme:</span>
<span style="color: #a5d6ff">            - For "https" and "wss", port 443 is used.</span>
<span style="color: #a5d6ff">            - For "http" and "ws", port 80 is used.</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">d</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">str(d)</span>
    <span style="color: #e6edf3">host</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span>
    <span style="color: #e6edf3">port</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span>
    <span style="color: #e6edf3">scheme</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">is_ip(d):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">make_ip_type(d),</span> <span style="color: #e6edf3">port</span>

    <span style="color: #e6edf3">match</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">bbot_regexes</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">split_host_port_regex</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">match(d)</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">match</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">raise</span> <span style="color: #f0883e; font-weight: bold">ValueError</span><span style="color: #e6edf3">(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">'split_port() failed to parse "{</span><span style="color: #e6edf3">d</span><span style="color: #a5d6ff">}"'</span><span style="color: #e6edf3">)</span>
    <span style="color: #e6edf3">scheme</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">match</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">group(</span><span style="color: #a5d6ff">"scheme"</span><span style="color: #e6edf3">)</span>
    <span style="color: #e6edf3">netloc</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">match</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">group(</span><span style="color: #a5d6ff">"netloc"</span><span style="color: #e6edf3">)</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">netloc</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">raise</span> <span style="color: #f0883e; font-weight: bold">ValueError</span><span style="color: #e6edf3">(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">'split_port() failed to parse "{</span><span style="color: #e6edf3">d</span><span style="color: #a5d6ff">}"'</span><span style="color: #e6edf3">)</span>

    <span style="color: #e6edf3">match</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">bbot_regexes</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">extract_open_port_regex</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">match(netloc)</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">match</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">raise</span> <span style="color: #f0883e; font-weight: bold">ValueError</span><span style="color: #e6edf3">(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">'split_port() failed to parse netloc "{</span><span style="color: #e6edf3">netloc</span><span style="color: #a5d6ff">}"'</span><span style="color: #e6edf3">)</span>

    <span style="color: #e6edf3">host</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">match</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">group(</span><span style="color: #a5d6ff">2</span><span style="color: #e6edf3">)</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">host</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">host</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">match</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">group(</span><span style="color: #a5d6ff">1</span><span style="color: #e6edf3">)</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">host</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">raise</span> <span style="color: #f0883e; font-weight: bold">ValueError</span><span style="color: #e6edf3">(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">'split_port() failed to locate host in netloc "{</span><span style="color: #e6edf3">netloc</span><span style="color: #a5d6ff">}"'</span><span style="color: #e6edf3">)</span>

    <span style="color: #e6edf3">port</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">match</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">group(</span><span style="color: #a5d6ff">3</span><span style="color: #e6edf3">)</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">port</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #e6edf3">scheme</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">scheme</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">(</span><span style="color: #a5d6ff">"https"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"wss"</span><span style="color: #e6edf3">):</span>
            <span style="color: #e6edf3">port</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">443</span>
        <span style="color: #ff7b72">elif</span> <span style="color: #e6edf3">scheme</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">(</span><span style="color: #a5d6ff">"http"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"ws"</span><span style="color: #e6edf3">):</span>
            <span style="color: #e6edf3">port</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">80</span>
    <span style="color: #ff7b72">elif</span> <span style="color: #e6edf3">port</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">suppress(</span><span style="color: #f0883e; font-weight: bold">ValueError</span><span style="color: #e6edf3">):</span>
            <span style="color: #e6edf3">port</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">int(port)</span>

    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">make_ip_type(host),</span> <span style="color: #e6edf3">port</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.split_list">
<span class="doc doc-object-name doc-function-name">split_list</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">split_list(alist,</span> <span style="color: #e6edf3">wanted_parts</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">2</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Splits a list into a specified number of approximately equal parts.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>alist</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#list">list</a></code>)
        –
        <div class="doc-md-description">
<p>The list to be split.</p>
</div>
</li>
<li class="field-body">
<b><code>wanted_parts</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a></code>, default:
                <code>2</code>
)
        –
        <div class="doc-md-description">
<p>The number of parts to split the list into.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>list</code></b>        –
        <div class="doc-md-description">
<p>A list of lists, each containing a portion of the original list.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">split_list([</span><span style="color: #a5d6ff">1</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">2</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">3</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">4</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">5</span><span style="color: #e6edf3">])</span>
<span style="color: #8b949e">[[1, 2], [3, 4, 5]]</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1481</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1482</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1483</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1484</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1485</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1486</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1487</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1488</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1489</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1490</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1491</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1492</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1493</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1494</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1495</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1496</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1497</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">split_list</span><span style="color: #e6edf3">(alist,</span> <span style="color: #e6edf3">wanted_parts</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">2</span><span style="color: #e6edf3">):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Splits a list into a specified number of approximately equal parts.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        alist (list): The list to be split.</span>
<span style="color: #a5d6ff">        wanted_parts (int): The number of parts to split the list into.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        list: A list of lists, each containing a portion of the original list.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; split_list([1, 2, 3, 4, 5])</span>
<span style="color: #a5d6ff">        [[1, 2], [3, 4, 5]]</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">length</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">len(alist)</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">[alist[i</span> <span style="color: #ff7b72; font-weight: bold">*</span> <span style="color: #e6edf3">length</span> <span style="color: #ff7b72; font-weight: bold">//</span> <span style="color: #e6edf3">wanted_parts</span> <span style="color: #e6edf3">:</span> <span style="color: #e6edf3">(i</span> <span style="color: #ff7b72; font-weight: bold">+</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">)</span> <span style="color: #ff7b72; font-weight: bold">*</span> <span style="color: #e6edf3">length</span> <span style="color: #ff7b72; font-weight: bold">//</span> <span style="color: #e6edf3">wanted_parts]</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">i</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">range(wanted_parts)]</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.str_or_file">
<span class="doc doc-object-name doc-function-name">str_or_file</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">str_or_file(s)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Reads a string or file and yields its content line-by-line.</p>
<p>This function tries to open the given string <code>s</code> as a file and yields its lines.
If it fails to open <code>s</code> as a file, it treats <code>s</code> as a regular string and yields it as is.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>s</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>The string or file path to read.</p>
</div>
</li>
</ul>
<p>Yields:</p>
<ul>
<li class="field-body">
<b><code>str</code></b>        –
        <div class="doc-md-description">
<p>Either lines from the file or the original string.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">list(str_or_file(</span><span style="color: #a5d6ff">"file.txt"</span><span style="color: #e6edf3">))</span>
<span style="color: #8b949e">['file_line1', 'file_line2', 'file_line3']</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">list(str_or_file(</span><span style="color: #a5d6ff">"not_a_file"</span><span style="color: #e6edf3">))</span>
<span style="color: #8b949e">['not_a_file']</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1081</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1082</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1083</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1084</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1085</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1086</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1087</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1088</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1089</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1090</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1091</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1092</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1093</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1094</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1095</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1096</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1097</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1098</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1099</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1100</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1101</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1102</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1103</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1104</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">str_or_file</span><span style="color: #e6edf3">(s):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Reads a string or file and yields its content line-by-line.</span>

<span style="color: #a5d6ff">    This function tries to open the given string `s` as a file and yields its lines.</span>
<span style="color: #a5d6ff">    If it fails to open `s` as a file, it treats `s` as a regular string and yields it as is.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        s (str): The string or file path to read.</span>

<span style="color: #a5d6ff">    Yields:</span>
<span style="color: #a5d6ff">        str: Either lines from the file or the original string.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; list(str_or_file("file.txt"))</span>
<span style="color: #a5d6ff">        ['file_line1', 'file_line2', 'file_line3']</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; list(str_or_file("not_a_file"))</span>
<span style="color: #a5d6ff">        ['not_a_file']</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">open(s,</span> <span style="color: #e6edf3">errors</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"ignore"</span><span style="color: #e6edf3">)</span> <span style="color: #ff7b72">as</span> <span style="color: #e6edf3">f:</span>
            <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">line</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">f:</span>
                <span style="color: #ff7b72">yield</span> <span style="color: #e6edf3">line</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">rstrip(</span><span style="color: #a5d6ff">"</span><span style="color: #79c0ff">\r\n</span><span style="color: #a5d6ff">"</span><span style="color: #e6edf3">)</span>
    <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">OSError</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">yield</span> <span style="color: #e6edf3">s</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.swap_status">
<span class="doc doc-object-name doc-function-name">swap_status</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">swap_status()</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Return statistics on swap memory consumption.</p>
<p>The function returns a <code>psutil</code> named tuple that contains statistics on
system swap memory usage, such as total swap, used swap, free swap, and more.</p>
<p>Returns:</p>
<ul>
<li class="field-body">
        –
        <div class="doc-md-description">
<p>psutil._common.sswap: A named tuple representing various statistics
about system swap memory usage.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">swap</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">swap_status()</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">swap</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">total</span>
<span style="color: #8b949e">4294967296</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">swap</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">swap_status()</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">swap</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">used</span>
<span style="color: #8b949e">2097152</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2135</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2136</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2137</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2138</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2139</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2140</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2141</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2142</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2143</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2144</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2145</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2146</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2147</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2148</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2149</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2150</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2151</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2152</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2153</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2154</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">swap_status</span><span style="color: #e6edf3">():</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Return statistics on swap memory consumption.</span>

<span style="color: #a5d6ff">    The function returns a `psutil` named tuple that contains statistics on</span>
<span style="color: #a5d6ff">    system swap memory usage, such as total swap, used swap, free swap, and more.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        psutil._common.sswap: A named tuple representing various statistics</span>
<span style="color: #a5d6ff">            about system swap memory usage.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; swap = swap_status()</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; swap.total</span>
<span style="color: #a5d6ff">        4294967296</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; swap = swap_status()</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; swap.used</span>
<span style="color: #a5d6ff">        2097152</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">psutil</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">swap_memory()</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.tagify">
<span class="doc doc-object-name doc-function-name">tagify</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">tagify(s,</span> <span style="color: #e6edf3">maxlen</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Sanitize a string into a tag-friendly format.</p>
<p>Converts a given string to lowercase and replaces all characters not matching
[a-z0-9] with hyphens. Optionally truncates the result to 'maxlen' characters.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>s</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>The input string to sanitize.</p>
</div>
</li>
<li class="field-body">
<b><code>maxlen</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a></code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
<p>The maximum length for the tag. Defaults to None.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>str</code></b>        –
        <div class="doc-md-description">
<p>A sanitized, tag-friendly string.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">tagify(</span><span style="color: #a5d6ff">"HTTP Web Title"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">'http-web-title'</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">tagify(</span><span style="color: #a5d6ff">"HTTP Web Title"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">maxlen</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">8</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">'http-web'</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2089</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2090</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2091</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2092</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2093</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2094</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2095</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2096</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2097</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2098</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2099</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2100</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2101</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2102</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2103</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2104</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2105</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2106</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2107</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2108</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2109</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">tagify</span><span style="color: #e6edf3">(s,</span> <span style="color: #e6edf3">maxlen</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Sanitize a string into a tag-friendly format.</span>

<span style="color: #a5d6ff">    Converts a given string to lowercase and replaces all characters not matching</span>
<span style="color: #a5d6ff">    [a-z0-9] with hyphens. Optionally truncates the result to 'maxlen' characters.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        s (str): The input string to sanitize.</span>
<span style="color: #a5d6ff">        maxlen (int, optional): The maximum length for the tag. Defaults to None.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        str: A sanitized, tag-friendly string.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; tagify("HTTP Web Title")</span>
<span style="color: #a5d6ff">        'http-web-title'</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; tagify("HTTP Web Title", maxlen=8)</span>
<span style="color: #a5d6ff">        'http-web'</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">ret</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">str(s)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">lower()</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">tag_filter_regex</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">sub(</span><span style="color: #a5d6ff">"-"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">ret)[:maxlen]</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">strip(</span><span style="color: #a5d6ff">"-"</span><span style="color: #e6edf3">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.tldextract">
<span class="doc doc-object-name doc-function-name">tldextract</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">tldextract(data)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Extracts the subdomain, domain, and suffix from a URL string.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>data</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>The URL string to be processed.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>ExtractResult</code></b>        –
        <div class="doc-md-description">
<p>A named tuple containing the subdomain, domain, and suffix.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">tldextract(</span><span style="color: #a5d6ff">"www.evilcorp.co.uk"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">ExtractResult(subdomain='www', domain='evilcorp', suffix='co.uk')</span>
</code></pre></div>
<details class="notes" open="">
<summary>Notes</summary>
<ul>
<li>Utilizes <code>smart_decode</code> to preprocess the data.</li>
<li>Makes use of the <code>tldextract</code> library for extraction.</li>
</ul>
</details>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">392</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">393</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">394</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">395</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">396</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">397</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">398</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">399</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">400</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">401</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">402</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">403</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">404</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">405</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">406</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">407</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">408</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">409</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">410</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">tldextract</span><span style="color: #e6edf3">(data):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Extracts the subdomain, domain, and suffix from a URL string.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        data (str): The URL string to be processed.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        ExtractResult: A named tuple containing the subdomain, domain, and suffix.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; tldextract("www.evilcorp.co.uk")</span>
<span style="color: #a5d6ff">        ExtractResult(subdomain='www', domain='evilcorp', suffix='co.uk')</span>

<span style="color: #a5d6ff">    Notes:</span>
<span style="color: #a5d6ff">        - Utilizes `smart_decode` to preprocess the data.</span>
<span style="color: #a5d6ff">        - Makes use of the `tldextract` library for extraction.</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">_tldextract</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">extract(smart_decode(data))</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.url_parents">
<span class="doc doc-object-name doc-function-name">url_parents</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">url_parents(u)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Generate a list of parent URLs for a given URL string.</p>
<p>This function takes an input string <code>u</code> representing a URL and generates a list of its parent URLs in decreasing order of specificity.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>u</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>The input string representing a URL.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
        –
        <div class="doc-md-description">
<p>List[str]: A list of parent URLs of the input URL in decreasing order of specificity.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">url_parents(</span><span style="color: #a5d6ff">"http://www.evilcorp.co.uk/admin/tools/cmd.php"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">["http://www.evilcorp.co.uk/admin/tools/", "http://www.evilcorp.co.uk/admin/", "http://www.evilcorp.co.uk/"]</span>
</code></pre></div>
<details class="notes" open="">
<summary>Notes</summary>
<ul>
<li>The list is generated by continuously calling <code>parent_url</code> until it returns None.</li>
<li>All components of the URL except for the path are preserved.</li>
</ul>
</details>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">362</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">363</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">364</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">365</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">366</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">367</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">368</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">369</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">370</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">371</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">372</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">373</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">374</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">375</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">376</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">377</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">378</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">379</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">380</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">381</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">382</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">383</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">384</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">385</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">386</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">387</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">388</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">389</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">url_parents</span><span style="color: #e6edf3">(u):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Generate a list of parent URLs for a given URL string.</span>

<span style="color: #a5d6ff">    This function takes an input string `u` representing a URL and generates a list of its parent URLs in decreasing order of specificity.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        u (str): The input string representing a URL.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        List[str]: A list of parent URLs of the input URL in decreasing order of specificity.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; url_parents("http://www.evilcorp.co.uk/admin/tools/cmd.php")</span>
<span style="color: #a5d6ff">        ["http://www.evilcorp.co.uk/admin/tools/", "http://www.evilcorp.co.uk/admin/", "http://www.evilcorp.co.uk/"]</span>

<span style="color: #a5d6ff">    Notes:</span>
<span style="color: #a5d6ff">        - The list is generated by continuously calling `parent_url` until it returns None.</span>
<span style="color: #a5d6ff">        - All components of the URL except for the path are preserved.</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">parent_list</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>
    <span style="color: #ff7b72">while</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">parent</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">parent_url(u)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">parent</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">parent_list</span>
        <span style="color: #ff7b72">elif</span> <span style="color: #e6edf3">parent</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">parent_list:</span>
            <span style="color: #e6edf3">parent_list</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(parent)</span>
            <span style="color: #e6edf3">u</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">parent</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.verify_sudo_password">
<span class="doc doc-object-name doc-function-name">verify_sudo_password</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">verify_sudo_password(sudo_pass)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Verify if the given sudo password is correct.</p>
<p>This function checks whether the sudo password provided is valid for the current user.
It runs a command with sudo, feeding in the password via stdin, and checks the return code.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>sudo_pass</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
        –
        <div class="doc-md-description">
<p>The sudo password to verify.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>bool</code></b>        –
        <div class="doc-md-description">
<p>True if the sudo password is correct, False otherwise.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">verify_sudo_password(</span><span style="color: #a5d6ff">"mysecretpassword"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">True</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1845</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1846</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1847</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1848</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1849</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1850</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1851</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1852</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1853</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1854</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1855</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1856</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1857</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1858</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1859</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1860</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1861</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1862</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1863</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1864</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1865</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1866</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1867</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1868</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1869</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1870</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1871</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">verify_sudo_password</span><span style="color: #e6edf3">(sudo_pass):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Verify if the given sudo password is correct.</span>

<span style="color: #a5d6ff">    This function checks whether the sudo password provided is valid for the current user.</span>
<span style="color: #a5d6ff">    It runs a command with sudo, feeding in the password via stdin, and checks the return code.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        sudo_pass (str): The sudo password to verify.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        bool: True if the sudo password is correct, False otherwise.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; verify_sudo_password("mysecretpassword")</span>
<span style="color: #a5d6ff">        True</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">sp</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">run(</span>
            <span style="color: #e6edf3">[</span><span style="color: #a5d6ff">"sudo"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"-S"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"-k"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"true"</span><span style="color: #e6edf3">],</span>
            <span style="color: #e6edf3">input</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">smart_encode(sudo_pass),</span>
            <span style="color: #e6edf3">stderr</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">sp</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">DEVNULL,</span>
            <span style="color: #e6edf3">stdout</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">sp</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">DEVNULL,</span>
            <span style="color: #e6edf3">check</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">,</span>
        <span style="color: #e6edf3">)</span>
    <span style="color: #ff7b72">except</span> <span style="color: #e6edf3">sp</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">CalledProcessError:</span>
        <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">False</span>
    <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">True</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.weighted_shuffle">
<span class="doc doc-object-name doc-function-name">weighted_shuffle</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">weighted_shuffle(items,</span> <span style="color: #e6edf3">weights)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Shuffles a list of items based on their corresponding weights.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>items</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#list">list</a></code>)
        –
        <div class="doc-md-description">
<p>The list of items to shuffle.</p>
</div>
</li>
<li class="field-body">
<b><code>weights</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#list">list</a></code>)
        –
        <div class="doc-md-description">
<p>The list of weights corresponding to each item.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>list</code></b>        –
        <div class="doc-md-description">
<p>A new list containing the shuffled items.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">items</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[</span><span style="color: #a5d6ff">'apple'</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">'banana'</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">'cherry'</span><span style="color: #e6edf3">]</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">weights</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[</span><span style="color: #a5d6ff">0.4</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">0.5</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">0.1</span><span style="color: #e6edf3">]</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">weighted_shuffle(items,</span> <span style="color: #e6edf3">weights)</span>
<span style="color: #8b949e">['banana', 'apple', 'cherry']</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">weighted_shuffle(items,</span> <span style="color: #e6edf3">weights)</span>
<span style="color: #8b949e">['apple', 'banana', 'cherry']</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">weighted_shuffle(items,</span> <span style="color: #e6edf3">weights)</span>
<span style="color: #8b949e">['apple', 'banana', 'cherry']</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">weighted_shuffle(items,</span> <span style="color: #e6edf3">weights)</span>
<span style="color: #8b949e">['banana', 'apple', 'cherry']</span>
</code></pre></div>
<details class="note" open="">
<summary>Note</summary>
<p>The sum of all weights does not have to be 1. They will be normalized internally.</p>
</details>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2419</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2420</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2421</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2422</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2423</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2424</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2425</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2426</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2427</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2428</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2429</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2430</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2431</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2432</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2433</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2434</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2435</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2436</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2437</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2438</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2439</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2440</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2441</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2442</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2443</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2444</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2445</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2446</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2447</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2448</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2449</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2450</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2451</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2452</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2453</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2454</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2455</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2456</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2457</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2458</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2459</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2460</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2461</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2462</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">2463</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">weighted_shuffle</span><span style="color: #e6edf3">(items,</span> <span style="color: #e6edf3">weights):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Shuffles a list of items based on their corresponding weights.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        items (list): The list of items to shuffle.</span>
<span style="color: #a5d6ff">        weights (list): The list of weights corresponding to each item.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        list: A new list containing the shuffled items.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; items = ['apple', 'banana', 'cherry']</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; weights = [0.4, 0.5, 0.1]</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; weighted_shuffle(items, weights)</span>
<span style="color: #a5d6ff">        ['banana', 'apple', 'cherry']</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; weighted_shuffle(items, weights)</span>
<span style="color: #a5d6ff">        ['apple', 'banana', 'cherry']</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; weighted_shuffle(items, weights)</span>
<span style="color: #a5d6ff">        ['apple', 'banana', 'cherry']</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; weighted_shuffle(items, weights)</span>
<span style="color: #a5d6ff">        ['banana', 'apple', 'cherry']</span>

<span style="color: #a5d6ff">    Note:</span>
<span style="color: #a5d6ff">        The sum of all weights does not have to be 1. They will be normalized internally.</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #8b949e; font-style: italic"># Create a list of tuples where each tuple is (item, weight)</span>
    <span style="color: #e6edf3">pool</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">list(zip(items,</span> <span style="color: #e6edf3">weights))</span>

    <span style="color: #e6edf3">shuffled_items</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>

    <span style="color: #8b949e; font-style: italic"># While there are still items to be chosen...</span>
    <span style="color: #ff7b72">while</span> <span style="color: #e6edf3">pool:</span>
        <span style="color: #8b949e; font-style: italic"># Normalize weights</span>
        <span style="color: #e6edf3">total</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">sum(weight</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">item,</span> <span style="color: #e6edf3">weight</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">pool)</span>
        <span style="color: #e6edf3">weights</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[weight</span> <span style="color: #ff7b72; font-weight: bold">/</span> <span style="color: #e6edf3">total</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">item,</span> <span style="color: #e6edf3">weight</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">pool]</span>

        <span style="color: #8b949e; font-style: italic"># Choose an index based on weight</span>
        <span style="color: #e6edf3">chosen_index</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">random</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">choices(range(len(pool)),</span> <span style="color: #e6edf3">weights</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">weights,</span> <span style="color: #e6edf3">k</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">1</span><span style="color: #e6edf3">)[</span><span style="color: #a5d6ff">0</span><span style="color: #e6edf3">]</span>

        <span style="color: #8b949e; font-style: italic"># Add the chosen item to the shuffled list</span>
        <span style="color: #e6edf3">chosen_item,</span> <span style="color: #e6edf3">chosen_weight</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">pool</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">pop(chosen_index)</span>
        <span style="color: #e6edf3">shuffled_items</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(chosen_item)</span>

    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">shuffled_items</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h1 class="doc doc-heading" id="bbot.core.helpers.misc.which">
<span class="doc doc-object-name doc-function-name">which</span>
</h1>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">which(</span><span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">executables)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Finds the full path of the first available executable from a list of executables.</p>
<p>Parameters:</p>
<ul>
<li class="field-body">
<b><code>*executables</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>, default:
                <code>()</code>
)
        –
        <div class="doc-md-description">
<p>One or more executable names to search for.</p>
</div>
</li>
</ul>
<p>Returns:</p>
<ul>
<li class="field-body">
<b><code>str</code></b>        –
        <div class="doc-md-description">
<p>The full path of the first available executable, or None if none are found.</p>
</div>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">which(</span><span style="color: #a5d6ff">"python"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"python3"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">"/usr/bin/python"</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/misc.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1282</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1283</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1284</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1285</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1286</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1287</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1288</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1289</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1290</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1291</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1292</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1293</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1294</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1295</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1296</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1297</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1298</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">which</span><span style="color: #e6edf3">(</span><span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">executables):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Finds the full path of the first available executable from a list of executables.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        *executables (str): One or more executable names to search for.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        str: The full path of the first available executable, or None if none are found.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; which("python", "python3")</span>
<span style="color: #a5d6ff">        "/usr/bin/python"</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">e</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">executables:</span>
        <span style="color: #e6edf3">location</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">shutil</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">which(e)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">location:</span>
            <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">location</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "navigation.sections", "navigation.expand", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../../assets/javascripts/bundle.dff1b7c8.min.js"></script>
<script src="https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js"></script>
<script src="../../../javascripts/tablesort.js"></script>
</body>
</html>